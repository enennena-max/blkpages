<!doctype html><html lang="en"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>BlkPages Admin — Businesses</title>
<link rel="stylesheet" href="./admin.css"/>
<script defer src="./admin.js"></script>
<script>
async function loadBusinesses(){
  const data = await api("/businesses");
  const tb = document.querySelector("tbody"); tb.innerHTML="";
  if(!data.length){ tb.innerHTML = `<tr><td colspan="5">No pending business approvals 🎉</td></tr>`; return; }
  for(const b of data){
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${b.id}</td>
      <td>${b.name}</td>
      <td>${b.owner_user_id}</td>
      <td>${b.created_at ? new Date(b.created_at).toLocaleDateString() : "—"}</td>
      <td><button class="btn gold" onclick="approveBiz('${b.id}')">Approve</button></td>
    `;
    tb.appendChild(tr);
  }
}
async function approveBiz(id){
  if(!confirm("Approve this business listing?")) return;
  await api(`/businesses/${id}/approve`, { method:"POST" });
  await loadBusinesses();
}
document.addEventListener("DOMContentLoaded", ()=>{ setActive("nav-businesses"); loadBusinesses(); });
</script>
</head><body>
<div class="wrap">
  <aside class="side">
    <div class="brand">🛡️ <span>BlkPages Admin</span></div>
    <nav class="nav">
      <a id="nav-overview" href="./overview.html">📊 Overview</a>
      <a id="nav-reviews" href="./reviews.html">🧾 Reviews</a>
      <a id="nav-businesses" href="./businesses.html" class="active">🏢 Businesses</a>
      <a id="nav-referrals" href="./referrals.html">🎁 Referrals</a>
      <a id="nav-disputes" href="./disputes.html">⚖️ Disputes</a>
      <a id="nav-adjustments" href="./adjustments.html">💎 Adjust Points</a>
    </nav>
  </aside>
  <div>
    <header><h2>Approve Businesses</h2></header>
    <main>
      <div class="toolbar"><span class="badge warn">New signups require approval</span></div>
      <table>
        <thead><tr><th>ID</th><th>Name</th><th>Owner</th><th>Requested</th><th>Action</th></tr></thead>
        <tbody></tbody>
      </table>
    </main>
  </div>
</div>
</body></html>
