<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enquiries Received Analytics - BLKPAGES</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .enquiries-analytics {
            padding: 24px;
            color: #fff;
            font-family: system-ui, -apple-system, Inter, Arial, sans-serif;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }
        
        .metric-box {
            background: #1f1f1f;
            border-radius: 10px;
            text-align: center;
            padding: 14px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25);
        }
        
        .metric-box h4 {
            color: #aaa;
            font-size: 0.95rem;
            margin-bottom: 6px;
        }
        
        .metric-box p {
            font-size: 1.25rem;
            font-weight: 700;
        }
        
        .positive {
            color: #2ecc71;
        }
        
        .negative {
            color: #e74c3c;
        }
        
        .card {
            background: #222;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }
        
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 16px;
        }
        
        .demo-controls {
            margin: 20px 0;
            text-align: center;
        }
        
        .btn {
            background: #36A2EB;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-weight: 600;
        }
        
        .btn:hover {
            background: #2E8BCC;
        }
        
        .btn-success {
            background: #2ecc71;
        }
        
        .btn-success:hover {
            background: #27ae60;
        }
        
        .btn-warning {
            background: #f39c12;
        }
        
        .btn-warning:hover {
            background: #e67e22;
        }
        
        .btn-danger {
            background: #e74c3c;
        }
        
        .btn-danger:hover {
            background: #c0392b;
        }
        
        .btn-info {
            background: #4BC0C0;
        }
        
        .btn-info:hover {
            background: #3BA8A8;
        }
        
        .btn-purple {
            background: #9966FF;
        }
        
        .btn-purple:hover {
            background: #8A5CF6;
        }
    </style>
</head>
<body>
    <div class="enquiries-analytics">
        <h2>Enquiries Received Analytics</h2>

        <div class="stats-grid">
            <div class="metric-box">
                <h4>Total Enquiries</h4>
                <p id="totalEnquiries">0</p>
            </div>
            <div class="metric-box">
                <h4>Last 24 Hours</h4>
                <p id="enquiriesLast24h">0</p>
            </div>
            <div class="metric-box">
                <h4>Growth Rate</h4>
                <p id="growthRate" class="positive">+0.0%</p>
            </div>
            <div class="metric-box">
                <h4>Avg Response Time</h4>
                <p id="averageResponseTime">—</p>
            </div>
        </div>

        <div class="card">
            <h3>Enquiry Volume (Last 30 Days)</h3>
            <canvas id="trendChart" width="400" height="200"></canvas>
        </div>

        <div class="grid-2">
            <div class="card">
                <h3>Enquiry Type Breakdown</h3>
                <canvas id="typesChart" width="300" height="300"></canvas>
            </div>
            <div class="card">
                <h3>Response Time Performance</h3>
                <canvas id="performanceChart" width="300" height="200"></canvas>
            </div>
        </div>
        
        <div class="demo-controls">
            <button class="btn" onclick="simulateEnquiry('booking')">Simulate Booking Enquiry</button>
            <button class="btn btn-success" onclick="simulateEnquiry('question')">Simulate Question</button>
            <button class="btn btn-warning" onclick="simulateEnquiry('information')">Simulate Information Request</button>
            <button class="btn btn-info" onclick="simulateEnquiry('feedback')">Simulate Feedback</button>
            <button class="btn btn-purple" onclick="simulateResponse()">Simulate Response</button>
            <button class="btn btn-warning" onclick="generateSampleData()">Generate Sample Data</button>
            <button class="btn btn-danger" onclick="clearAllData()">Clear All Data</button>
        </div>
    </div>

    <script>
        let analyticsData = {
            totalEnquiries: 0,
            enquiriesLast24h: 0,
            growthRate: 0,
            averageResponseMinutes: 0,
            trend: [],
            typeBreakdown: {
                booking: 0,
                question: 0,
                information: 0,
                feedback: 0
            },
            responsePerformance: {
                fast: 0,
                moderate: 0,
                slow: 0
            }
        };
        
        let trendChart = null;
        let typesChart = null;
        let performanceChart = null;
        
        // Load analytics data from localStorage
        function loadAnalyticsData() {
            const saved = localStorage.getItem('enquiriesAnalytics');
            if (saved) {
                analyticsData = JSON.parse(saved);
            }
            updateDisplay();
        }
        
        // Save analytics data to localStorage
        function saveAnalyticsData() {
            localStorage.setItem('enquiriesAnalytics', JSON.stringify(analyticsData));
        }
        
        // Format minutes to readable format
        function formatMinutes(mins) {
            if (!mins || mins <= 0) return '—';
            const h = Math.floor(mins / 60);
            const m = Math.round(mins % 60);
            return h > 0 ? `${h}h ${m}m` : `${m}m`;
        }
        
        // Simulate enquiry
        function simulateEnquiry(enquiryType) {
            analyticsData.totalEnquiries += 1;
            analyticsData.enquiriesLast24h += 1;
            
            // Add to type breakdown
            analyticsData.typeBreakdown[enquiryType] += 1;
            
            // Add to trend data
            const today = new Date().toISOString().split('T')[0];
            const existingDay = analyticsData.trend.find(t => t.date === today);
            if (existingDay) {
                existingDay.enquiries += 1;
            } else {
                analyticsData.trend.push({ date: today, enquiries: 1 });
            }
            
            // Sort trend data by date
            analyticsData.trend.sort((a, b) => new Date(a.date) - new Date(b.date));
            
            // Keep only last 30 days
            const thirtyDaysAgo = new Date();
            thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
            analyticsData.trend = analyticsData.trend.filter(t => new Date(t.date) >= thirtyDaysAgo);
            
            // Calculate growth rate (simplified for demo)
            analyticsData.growthRate = Math.random() * 30 - 15; // Random between -15% and +15%
            
            saveAnalyticsData();
            updateDisplay();
        }
        
        // Simulate response
        function simulateResponse() {
            // Generate random response time
            const responseTimeMinutes = Math.random() * 120; // 0-120 minutes
            
            // Categorize response performance
            if (responseTimeMinutes <= 15) {
                analyticsData.responsePerformance.fast += 1;
            } else if (responseTimeMinutes <= 60) {
                analyticsData.responsePerformance.moderate += 1;
            } else {
                analyticsData.responsePerformance.slow += 1;
            }
            
            // Update average response time
            const totalResponses = analyticsData.responsePerformance.fast + 
                                 analyticsData.responsePerformance.moderate + 
                                 analyticsData.responsePerformance.slow;
            
            if (totalResponses > 0) {
                const totalMinutes = (analyticsData.responsePerformance.fast * 7.5) + 
                                   (analyticsData.responsePerformance.moderate * 37.5) + 
                                   (analyticsData.responsePerformance.slow * 90);
                analyticsData.averageResponseMinutes = totalMinutes / totalResponses;
            }
            
            saveAnalyticsData();
            updateDisplay();
        }
        
        // Generate sample data
        function generateSampleData() {
            // Generate random enquiries
            const enquiryTypes = ['booking', 'question', 'information', 'feedback'];
            for (let i = 0; i < 100; i++) {
                const randomType = enquiryTypes[Math.floor(Math.random() * enquiryTypes.length)];
                simulateEnquiry(randomType);
            }
            
            // Generate some responses
            for (let i = 0; i < 50; i++) {
                simulateResponse();
            }
            
            updateDisplay();
        }
        
        // Clear all data
        function clearAllData() {
            analyticsData = {
                totalEnquiries: 0,
                enquiriesLast24h: 0,
                growthRate: 0,
                averageResponseMinutes: 0,
                trend: [],
                typeBreakdown: {
                    booking: 0,
                    question: 0,
                    information: 0,
                    feedback: 0
                },
                responsePerformance: {
                    fast: 0,
                    moderate: 0,
                    slow: 0
                }
            };
            saveAnalyticsData();
            updateDisplay();
        }
        
        // Update display
        function updateDisplay() {
            document.getElementById('totalEnquiries').textContent = analyticsData.totalEnquiries;
            document.getElementById('enquiriesLast24h').textContent = analyticsData.enquiriesLast24h;
            
            const growthRateElement = document.getElementById('growthRate');
            growthRateElement.textContent = `${analyticsData.growthRate >= 0 ? '+' : ''}${analyticsData.growthRate.toFixed(1)}%`;
            growthRateElement.className = analyticsData.growthRate >= 0 ? 'positive' : 'negative';
            
            document.getElementById('averageResponseTime').textContent = formatMinutes(analyticsData.averageResponseMinutes);
            
            updateTrendChart();
            updateTypesChart();
            updatePerformanceChart();
        }
        
        // Update trend chart
        function updateTrendChart() {
            const ctx = document.getElementById('trendChart').getContext('2d');
            
            if (trendChart) {
                trendChart.destroy();
            }
            
            // Prepare chart data
            const labels = analyticsData.trend.map(t => {
                const date = new Date(t.date);
                return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
            });
            
            const data = analyticsData.trend.map(t => t.enquiries);
            
            trendChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Enquiries per Day (30d)',
                        data: data,
                        borderColor: '#36A2EB',
                        backgroundColor: 'rgba(54,162,235,0.25)',
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#ffffff'
                            }
                        },
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#ffffff'
                            }
                        }
                    }
                }
            });
        }
        
        // Update types chart
        function updateTypesChart() {
            const ctx = document.getElementById('typesChart').getContext('2d');
            
            if (typesChart) {
                typesChart.destroy();
            }
            
            typesChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Booking', 'Question', 'Information', 'Feedback'],
                    datasets: [{
                        data: [
                            analyticsData.typeBreakdown.booking,
                            analyticsData.typeBreakdown.question,
                            analyticsData.typeBreakdown.information,
                            analyticsData.typeBreakdown.feedback
                        ],
                        backgroundColor: ['#4BC0C0', '#FF6384', '#FFCE56', '#9966FF']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#ffffff'
                            }
                        }
                    }
                }
            });
        }
        
        // Update performance chart
        function updatePerformanceChart() {
            const ctx = document.getElementById('performanceChart').getContext('2d');
            
            if (performanceChart) {
                performanceChart.destroy();
            }
            
            performanceChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Fast (≤15m)', 'Moderate (16–60m)', 'Slow (>60m)'],
                    datasets: [{
                        label: 'Responses',
                        data: [
                            analyticsData.responsePerformance.fast,
                            analyticsData.responsePerformance.moderate,
                            analyticsData.responsePerformance.slow
                        ],
                        backgroundColor: ['#2ecc71', '#f1c40f', '#e74c3c']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#ffffff'
                            }
                        },
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#ffffff'
                            }
                        }
                    }
                }
            });
        }
        
        // Initialize demo
        document.addEventListener('DOMContentLoaded', function() {
            loadAnalyticsData();
        });
    </script>
</body>
</html>
