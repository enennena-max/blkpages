<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Royal Hair Studio - BlkPages</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Poppins:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif'],
                        'poppins': ['Poppins', 'sans-serif']
                    },
                    colors: {
                        'charcoal': '#121212',
                        'dark-grey': '#1A1A1A',
                        'light-grey': '#CCCCCC',
                        'gold': '#D4AF37',
                        'gold-dark': '#B8860B',
                        'neon-pink': '#FF3CAC',
                        'neon-blue': '#2B86C5',
                        'neon-green': '#4ADE80',
                        'neon-purple': '#784BA0'
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.8s ease-in-out',
                        'slide-up': 'slideUp 0.6s ease-out',
                        'glow': 'glow 2s ease-in-out infinite alternate',
                        'pulse-subtle': 'pulseSubtle 3s ease-in-out infinite',
                        'float': 'float 6s ease-in-out infinite',
                        'shimmer': 'shimmer 2s linear infinite'
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' }
                        },
                        slideUp: {
                            '0%': { opacity: '0', transform: 'translateY(30px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' }
                        },
                        glow: {
                            '0%': { boxShadow: '0 0 20px rgba(212, 175, 55, 0.2)' },
                            '100%': { boxShadow: '0 0 30px rgba(212, 175, 55, 0.4)' }
                        },
                        pulseSubtle: {
                            '0%, 100%': { opacity: '1' },
                            '50%': { opacity: '0.8' }
                        },
                        float: {
                            '0%, 100%': { transform: 'translateY(0px)' },
                            '50%': { transform: 'translateY(-10px)' }
                        },
                        shimmer: {
                            '0%': { transform: 'translateX(-100%)' },
                            '100%': { transform: 'translateX(100%)' }
                        }
                    }
                }
            }
        }
    </script>
    
    <style>
        /* Custom gradient backgrounds */
        .gradient-bg {
            background: linear-gradient(135deg, #000000 0%, #1a1a1a 25%, #2a2a2a 50%, #1a1a1a 75%, #000000 100%);
        }
        
        .hero-gradient {
            background: linear-gradient(135deg, 
                rgba(0,0,0,0.9) 0%, 
                rgba(26,26,26,0.8) 25%, 
                rgba(42,42,42,0.7) 50%, 
                rgba(26,26,26,0.8) 75%, 
                rgba(0,0,0,0.9) 100%);
        }
        
        .card-gradient {
            background: linear-gradient(145deg, 
                rgba(26,26,26,0.95) 0%, 
                rgba(42,42,42,0.9) 50%, 
                rgba(26,26,26,0.95) 100%);
        }
        
        .gold-gradient {
            background: linear-gradient(135deg, #D4AF37 0%, #B8860B 100%);
        }
        
        .border-glow {
            border: 1px solid rgba(212, 175, 55, 0.3);
        }
        
        .text-glow {
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
        }
        
        .hover-glow:hover {
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.3);
        }
        
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .line-clamp-3 {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #1a1a1a;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #D4AF37;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #B8860B;
        }

        /* Modal animations */
        .modal-overlay {
            transition: all 0.3s ease;
        }
        
        .modal-overlay.show {
            opacity: 1;
        }
        
        .modal-content {
            transition: all 0.3s ease;
            transform: scale(0.9) translateY(20px);
        }
        
        .modal-content.show {
            transform: scale(1) translateY(0);
        }
    </style>
</head>
<body class="gradient-bg min-h-screen text-white font-inter">
    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 bg-charcoal/95 backdrop-blur-md border-b border-white/10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <!-- Logo -->
                <div class="flex items-center">
                    <a href="index.html" class="text-2xl font-bold text-white hover:text-gold transition-colors duration-300">BlkPages</a>
                </div>
                
                <!-- Navigation Links -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="index.html" class="text-light-grey hover:text-gold transition-colors duration-300 font-medium">Home</a>
                    <a href="search-results-new.html" class="text-light-grey hover:text-gold transition-colors duration-300 font-medium">Browse</a>
                    <a href="business-router.html" class="text-gold font-medium" style="background: linear-gradient(135deg, #D4AF37, #B8860B); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-weight: 600;">
                        <i class="fas fa-building mr-1"></i>Business Profile 2
                    </a>
                </div>
                
                <!-- Mobile Menu Button -->
                <div class="md:hidden">
                    <button onclick="toggleMobileMenu()" class="text-white hover:text-gold transition-colors duration-300">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Mobile Menu -->
        <div id="mobileMenu" class="md:hidden hidden bg-charcoal/95 backdrop-blur-md border-t border-white/10">
            <div class="px-4 py-4 space-y-4">
                <a href="index.html" class="block text-light-grey hover:text-gold transition-colors duration-300 font-medium">Home</a>
                <a href="search-results-new.html" class="block text-light-grey hover:text-gold transition-colors duration-300 font-medium">Browse</a>
                <a href="business-router.html" class="block text-gold font-medium" style="background: linear-gradient(135deg, #D4AF37, #B8860B); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-weight: 600;">
                    <i class="fas fa-building mr-2"></i>Business Profile 2
                </a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="pt-16">
        <!-- Hero Section -->
        <section class="relative h-96 overflow-hidden">
            <div class="absolute inset-0">
                <img src="https://images.unsplash.com/photo-1560066984-138dadb4c035?w=1920&h=600&fit=crop&crop=center" 
                     alt="Royal Hair Studio" 
                     class="w-full h-full object-cover">
                <div class="absolute inset-0 hero-gradient"></div>
            </div>
            
            <div class="relative z-10 h-full flex items-end">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 w-full pb-8">
                    <div class="flex flex-col md:flex-row items-start md:items-end justify-between">
                        <div class="mb-6 md:mb-0">
                            <div class="flex items-center space-x-3 mb-4">
                                <span class="px-4 py-2 rounded-full text-sm font-bold gold-gradient text-black">
                                    <i class="fas fa-crown mr-1"></i>Professional
                                </span>
                                <span class="px-3 py-1 rounded-full text-xs font-medium bg-gold/20 text-gold border border-gold/40">
                                    <i class="fas fa-tag mr-1"></i>Special Offer
                                </span>
                            </div>
                            <h1 class="text-4xl md:text-5xl font-bold text-white mb-2">Royal Hair Studio</h1>
                            <p class="text-xl text-light-grey mb-4">Professional hair care services for all hair types</p>
                            
                            <!-- Rating & Reviews -->
                            <div class="flex items-center space-x-4 mb-4">
                                <div class="flex text-gold">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                </div>
                                <span class="text-light-grey">4.9 (127 reviews)</span>
                            </div>
                            
                            <!-- Location -->
                            <div class="flex items-center text-light-grey">
                                <i class="fas fa-map-marker-alt mr-2 text-gold"></i>
                                <span>123 Hair Street, London, SW1A 1AA</span>
                            </div>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-4" id="actionButtons">
                            <button onclick="openBookingModal()" 
                                    class="px-8 py-4 rounded-2xl gold-gradient text-black font-bold hover:shadow-lg hover:shadow-gold/30 transition-all duration-300 transform hover:scale-105">
                                <i class="fas fa-calendar-plus mr-2"></i>Book Now
                            </button>
                            <!-- Call and Email buttons will be populated by JavaScript based on business settings -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Content Section -->
        <section class="py-12">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <!-- Main Content -->
                    <div class="lg:col-span-2 space-y-8">
                        <!-- About Section -->
                        <div class="card-gradient rounded-3xl p-8 border-glow">
                            <h2 class="text-2xl font-bold text-white mb-6 flex items-center">
                                <i class="fas fa-info-circle mr-3 text-gold"></i>
                                About Royal Hair Studio
                            </h2>
                            <p class="text-light-grey leading-relaxed mb-6">
                                Welcome to Royal Hair Studio, where we specialize in professional hair care services for all hair types. 
                                Our experienced stylists are dedicated to providing exceptional service in a luxurious and comfortable environment.
                            </p>
                            <p class="text-light-grey leading-relaxed">
                                We offer a full range of services including cuts, coloring, styling, and treatments. Our team stays 
                                up-to-date with the latest trends and techniques to ensure you leave looking and feeling your best.
                            </p>
                        </div>

                        <!-- Services Section -->
                        <div class="card-gradient rounded-3xl p-8 border-glow">
                            <h2 class="text-2xl font-bold text-white mb-6 flex items-center">
                                <i class="fas fa-cut mr-3 text-gold"></i>
                                Our Services
                            </h2>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="servicesGrid">
                                <!-- Services will be populated by JavaScript based on payment settings -->
                            </div>
                        </div>

                        <!-- Gallery Section -->
                        <div class="card-gradient rounded-3xl p-8 border-glow">
                            <h2 class="text-2xl font-bold text-white mb-6 flex items-center">
                                <i class="fas fa-images mr-3 text-gold"></i>
                                Our Work
                            </h2>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                                <div class="aspect-square rounded-2xl overflow-hidden">
                                    <img src="https://images.unsplash.com/photo-1522337360788-8b13dee7a37e?w=400&h=400&fit=crop" 
                                         alt="Hair styling work" 
                                         class="w-full h-full object-cover hover:scale-110 transition-transform duration-300">
                                </div>
                                <div class="aspect-square rounded-2xl overflow-hidden">
                                    <img src="https://images.unsplash.com/photo-1562322140-8baeececf3df?w=400&h=400&fit=crop" 
                                         alt="Hair coloring work" 
                                         class="w-full h-full object-cover hover:scale-110 transition-transform duration-300">
                                </div>
                                <div class="aspect-square rounded-2xl overflow-hidden">
                                    <img src="https://images.unsplash.com/photo-1595476108010-b4d1f102b1b1?w=400&h=400&fit=crop" 
                                         alt="Hair cut work" 
                                         class="w-full h-full object-cover hover:scale-110 transition-transform duration-300">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Sidebar -->
                    <div class="space-y-6">
                        <!-- Contact Info -->
                        <div class="card-gradient rounded-3xl p-6 border-glow">
                            <h3 class="text-xl font-bold text-white mb-4 flex items-center">
                                <i class="fas fa-phone mr-3 text-gold"></i>
                                Contact Info
                            </h3>
                            <div class="space-y-4" id="contactInfo">
                                <!-- Contact info will be populated by JavaScript based on business settings -->
                            </div>
                        </div>

                        <!-- Payment Methods -->
                        <div class="card-gradient rounded-3xl p-6 border-glow">
                            <h3 class="text-xl font-bold text-white mb-4 flex items-center">
                                <i class="fas fa-credit-card mr-3 text-gold"></i>
                                Payment Options
                            </h3>
                            <div class="space-y-4" id="paymentOptions">
                                <!-- Payment options will be populated by JavaScript based on business settings -->
                            </div>
                        </div>

                        <!-- Opening Hours -->
                        <div class="card-gradient rounded-3xl p-6 border-glow">
                            <h3 class="text-xl font-bold text-white mb-4 flex items-center">
                                <i class="fas fa-clock mr-3 text-gold"></i>
                                Opening Hours
                            </h3>
                            <div class="space-y-2">
                                <div class="flex justify-between text-light-grey">
                                    <span>Monday - Friday</span>
                                    <span>9:00 AM - 7:00 PM</span>
                                </div>
                                <div class="flex justify-between text-light-grey">
                                    <span>Saturday</span>
                                    <span>9:00 AM - 6:00 PM</span>
                                </div>
                                <div class="flex justify-between text-light-grey">
                                    <span>Sunday</span>
                                    <span>10:00 AM - 4:00 PM</span>
                                </div>
                            </div>
                        </div>

                        <!-- Special Offer -->
                        <div class="card-gradient rounded-3xl p-6 border-glow bg-gold/5">
                            <h3 class="text-xl font-bold text-white mb-4 flex items-center">
                                <i class="fas fa-gift mr-3 text-gold"></i>
                                Special Offer
                            </h3>
                            <p class="text-light-grey mb-4">
                                Get 20% off your first visit when you book online!
                            </p>
                            <button onclick="startBooking()" 
                                    class="w-full py-3 rounded-xl gold-gradient text-black font-bold hover:shadow-lg hover:shadow-gold/30 transition-all duration-300">
                                Claim Offer
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-charcoal border-t border-white/10 py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center text-light-grey">
                <p>&copy; 2024 BlkPages. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Booking Modal -->
    <div id="bookingModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden modal-overlay">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-2xl p-8 max-w-md w-full border border-gold shadow-[0_0_20px_rgba(212,175,55,0.25)] modal-content relative">
                <!-- Modal Header -->
                <div class="text-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">How would you like to continue?</h2>
                </div>
                
                <!-- Modal Buttons -->
                <div class="space-y-3 mb-6">
                    <button onclick="handleSignIn()" 
                            class="w-full py-3 px-6 rounded-xl bg-gray-900 text-white font-semibold hover:bg-gray-800 transition-all duration-300 transform hover:scale-105">
                        Sign In
                    </button>
                    
                    <button onclick="handleContinueAsGuest()" 
                            class="w-full py-3 px-6 rounded-xl border-2 border-gold text-gray-900 font-semibold hover:bg-gold/10 transition-all duration-300 transform hover:scale-105">
                        Continue as Guest
                    </button>
                    
                    <button onclick="handleSignUp()" 
                            class="w-full py-3 px-6 rounded-xl gold-gradient text-black font-semibold hover:shadow-lg hover:shadow-gold/30 transition-all duration-300 transform hover:scale-105">
                        Sign Up
                    </button>
                </div>
                
                <!-- Modal Footer -->
                <div class="text-center">
                    <p class="text-gray-500 text-sm">Please note: to join a waiting list you must have an account.</p>
                </div>
                
                <!-- Close Button -->
                <button onclick="closeBookingModal()" 
                        class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors duration-300">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
        </div>
    </div>

    <script>
        // Mobile menu toggle
        function toggleMobileMenu() {
            const menu = document.getElementById('mobileMenu');
            menu.classList.toggle('hidden');
        }

        // Business data with conditional settings
        const businessData = {
            id: 'royal-hair-studio',
            name: 'Royal Hair Studio',
            slug: 'royal-hair-studio',
            category: 'Hair & Beauty',
            rating: 4.9,
            reviews: 127,
            location: '123 Hair Street, London, SW1A 1AA',
            phone: '+44 20 7123 4567',
            email: 'info@royalhairstudio.com',
            hasOffer: true,
            offerDiscount: 20,
            // Conditional CTA settings
            allowCall: true,
            allowEmail: true
        };

        // Demo function to test different CTA scenarios
        function testCTAScenarios() {
            const scenarios = [
                {
                    name: 'Both Call & Email Allowed',
                    allowCall: true,
                    allowEmail: true,
                    phone: '+44 20 7123 4567',
                    email: 'info@royalhairstudio.com'
                },
                {
                    name: 'Call Only',
                    allowCall: true,
                    allowEmail: false,
                    phone: '+44 20 7123 4567',
                    email: 'info@royalhairstudio.com'
                },
                {
                    name: 'Email Only',
                    allowCall: false,
                    allowEmail: true,
                    phone: '+44 20 7123 4567',
                    email: 'info@royalhairstudio.com'
                },
                {
                    name: 'No Contact Allowed',
                    allowCall: false,
                    allowEmail: false,
                    phone: '+44 20 7123 4567',
                    email: 'info@royalhairstudio.com'
                },
                {
                    name: 'No Phone Available',
                    allowCall: true,
                    allowEmail: true,
                    phone: null,
                    email: 'info@royalhairstudio.com'
                },
                {
                    name: 'No Email Available',
                    allowCall: true,
                    allowEmail: true,
                    phone: '+44 20 7123 4567',
                    email: null
                }
            ];

            console.log('CTA Scenarios Test:');
            scenarios.forEach((scenario, index) => {
                console.log(`\n${index + 1}. ${scenario.name}:`);
                console.log(`   Call Button: ${scenario.allowCall && scenario.phone ? 'SHOWN' : 'HIDDEN'}`);
                console.log(`   Email Button: ${scenario.allowEmail && scenario.email ? 'SHOWN' : 'HIDDEN'}`);
            });
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            setupConditionalCTAs();
            setupPaymentOptions();
            setupModalEventListeners();
            updateBasketCount();
            setupServicesGrid();
        });

        // Update basket count in header
        function updateBasketCount() {
            const basketItems = JSON.parse(localStorage.getItem('basketItems') || '[]');
            const basketCount = basketItems.length;
            const basketCountElements = document.querySelectorAll('.basket-count');
            basketCountElements.forEach(element => {
                element.textContent = basketCount;
            });
        }

        // Setup modal event listeners
        function setupModalEventListeners() {
            // ESC key to close modal
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape') {
                    const modal = document.getElementById('bookingModal');
                    if (!modal.classList.contains('hidden')) {
                        closeBookingModal();
                    }
                }
            });

            // Background click to close modal
            document.getElementById('bookingModal').addEventListener('click', function(event) {
                if (event.target === this) {
                    closeBookingModal();
                }
            });
        }

        // Setup conditional CTAs based on business settings
        function setupConditionalCTAs() {
            const actionButtonsContainer = document.getElementById('actionButtons');
            const contactInfoContainer = document.getElementById('contactInfo');
            let ctaButtons = '';
            let contactInfo = '';

            // Call button - only show if allowCall && phone
            if (businessData.allowCall && businessData.phone) {
                ctaButtons += `
                    <button onclick="callBusiness('${businessData.phone}')" 
                            class="px-6 py-4 rounded-2xl border border-white/20 text-white hover:bg-white/10 hover:border-gold/50 transition-all duration-300">
                        <i class="fas fa-phone mr-2"></i>Call
                    </button>
                `;
                
                // Add phone to contact info
                contactInfo += `
                    <div class="flex items-center text-light-grey">
                        <i class="fas fa-phone mr-3 text-gold w-5"></i>
                        <span>${businessData.phone}</span>
                    </div>
                `;
            }

            // Email button - only show if allowEmail && email
            if (businessData.allowEmail && businessData.email) {
                ctaButtons += `
                    <button onclick="emailBusiness('${businessData.email}')" 
                            class="px-6 py-4 rounded-2xl border border-white/20 text-white hover:bg-white/10 hover:border-gold/50 transition-all duration-300">
                        <i class="fas fa-envelope mr-2"></i>Email
                    </button>
                `;
                
                // Add email to contact info
                contactInfo += `
                    <div class="flex items-center text-light-grey">
                        <i class="fas fa-envelope mr-3 text-gold w-5"></i>
                        <span>${businessData.email}</span>
                    </div>
                `;
            }

            // Always show address
            contactInfo += `
                <div class="flex items-start text-light-grey">
                    <i class="fas fa-map-marker-alt mr-3 text-gold w-5 mt-1"></i>
                    <span>${businessData.location}</span>
                </div>
            `;

            // Insert the conditional buttons after the Book Now button
            actionButtonsContainer.insertAdjacentHTML('beforeend', ctaButtons);
            
            // Insert the conditional contact info
            contactInfoContainer.insertAdjacentHTML('beforeend', contactInfo);
        }

        // Setup payment options based on business settings
        function setupPaymentOptions() {
            const paymentOptionsContainer = document.getElementById('paymentOptions');
            let paymentOptionsHTML = '';

            // Get payment settings from business data (linked to dashboard)
            // This would normally come from the business dashboard/API
            const paymentSettings = getBusinessPaymentSettings();

            // Business must have at least one payment option
            // Deposit and Full cannot be enabled simultaneously
            // Pay at Venue can be toggled alongside either

            // Pay in Full at Checkout (mutually exclusive with deposit)
            if (paymentSettings.allowFull && !paymentSettings.allowDeposit) {
                paymentOptionsHTML += `
                    <div class="bg-dark-grey/30 rounded-xl p-4 border border-white/10">
                        <div class="flex items-start space-x-3">
                            <span class="text-2xl">💳</span>
                            <div class="flex-1">
                                <h4 class="text-white font-semibold mb-1">Pay in Full at Checkout</h4>
                                <p class="text-light-grey text-sm">Secure your appointment instantly by paying the full amount online. You'll receive an immediate confirmation and receipt.</p>
                            </div>
                        </div>
                    </div>
                `;
            }

            // Pay Deposit (mutually exclusive with full payment)
            if (paymentSettings.allowDeposit && !paymentSettings.allowFull) {
                paymentOptionsHTML += `
                    <div class="bg-dark-grey/30 rounded-xl p-4 border border-white/10">
                        <div class="flex items-start space-x-3">
                            <span class="text-2xl">🪙</span>
                            <div class="flex-1">
                                <h4 class="text-white font-semibold mb-1">Pay a ${paymentSettings.depositPercent}% Deposit</h4>
                                <p class="text-light-grey text-sm">Reserve your slot with a ${paymentSettings.depositPercent}% deposit. The remaining balance is payable at the venue.</p>
                            </div>
                        </div>
                    </div>
                `;
            }

            // Pay at Venue (can be toggled alongside either option)
            if (paymentSettings.allowPayAtVenue) {
                paymentOptionsHTML += `
                    <div class="bg-dark-grey/30 rounded-xl p-4 border border-white/10">
                        <div class="flex items-start space-x-3">
                            <span class="text-2xl">🏠</span>
                            <div class="flex-1">
                                <h4 class="text-white font-semibold mb-1">Pay at the Venue</h4>
                                <p class="text-light-grey text-sm">Book now and pay in person when you arrive. Please note that availability is confirmed upon attendance.</p>
                            </div>
                        </div>
                    </div>
                `;
            }

            // Fallback: If no payment options are configured, show error
            if (!paymentOptionsHTML) {
                paymentOptionsHTML = `
                    <div class="bg-red-500/10 rounded-xl p-4 border border-red-500/20">
                        <div class="flex items-start space-x-3">
                            <span class="text-2xl">⚠️</span>
                            <div class="flex-1">
                                <h4 class="text-red-400 font-semibold mb-1">Payment Options Not Configured</h4>
                                <p class="text-red-300 text-sm">Please configure payment options in your business dashboard.</p>
                            </div>
                        </div>
                    </div>
                `;
            }

            paymentOptionsContainer.innerHTML = paymentOptionsHTML;
        }

        // Get business payment settings (linked to dashboard)
        function getBusinessPaymentSettings() {
            // This would normally fetch from business dashboard/API
            // For demo purposes, using localStorage to simulate dashboard settings
            
            // Check if business has custom payment settings
            const businessId = businessData.id || 'royal-hair-studio';
            const storedSettings = localStorage.getItem(`business_${businessId}_payment_settings`);
            
            if (storedSettings) {
                return JSON.parse(storedSettings);
            }
            
            // Default settings for Royal Hair Studio (can be changed in dashboard)
            return {
                allowFull: false,       // Pay in full disabled by default
                allowDeposit: false,    // Deposit disabled by default
                depositPercent: 20,     // 20% deposit (if enabled) - matches dashboard default
                allowPayAtVenue: true   // Pay at venue enabled by default
            };
        }

        // Create basket item with payment mode logic
        function createBasketItem(service) {
            const business = {
                payments: getBusinessPaymentSettings()
            };

            let basketItem;

            if (business.payments.allowDeposit) {
                const depositPercent = business.payments.depositPercent || 20;
                const depositAmount = service.price * (depositPercent / 100);
                const remaining = service.price - depositAmount;
                basketItem = {
                    ...service,
                    payMode: "deposit",
                    depositPercent,
                    depositAmount,
                    remainingAmount: remaining,
                };
            } else if (business.payments.allowFull) {
                basketItem = { ...service, payMode: "full" };
            } else if (business.payments.allowPayAtVenue) {
                basketItem = { ...service, payMode: "venue" };
            }

            return basketItem;
        }

        // Update business payment settings (called from dashboard)
        function updateBusinessPaymentSettings(settings) {
            const businessId = businessData.id || 'royal-hair-studio';
            localStorage.setItem(`business_${businessId}_payment_settings`, JSON.stringify(settings));
            
            // Refresh payment options display
            setupPaymentOptions();
            setupServicesGrid();
            
            console.log('✅ Business payment settings updated:', settings);
        }

        // Setup services grid with payment information
        function setupServicesGrid() {
            const servicesGrid = document.getElementById('servicesGrid');
            const paymentSettings = getBusinessPaymentSettings();
            
            const services = [
                { name: "Hair Cut & Style", price: 35, duration: "60 mins", description: "Professional cuts and styling for all hair types" },
                { name: "Hair Coloring", price: 80, duration: "120 mins", description: "Full color, highlights, and color correction" },
                { name: "Hair Treatment", price: 45, duration: "90 mins", description: "Deep conditioning and repair treatments" },
                { name: "Special Occasion", price: 120, duration: "180 mins", description: "Wedding and event styling" }
            ];
            
            let servicesHTML = '';
            
            services.forEach(service => {
                let priceDisplay = `From £${service.price}`;
                let paymentInfo = '';
                
                if (paymentSettings.allowDeposit && !paymentSettings.allowFull) {
                    const depositPercent = paymentSettings.depositPercent || 20;
                    const depositAmount = service.price * (depositPercent / 100);
                    const remaining = service.price - depositAmount;
                    paymentInfo = `
                        <div class="mt-2 text-xs text-light-grey">
                            Deposit: ${depositPercent}% due now (£${depositAmount.toFixed(2)}). 
                            Balance £${remaining.toFixed(2)} payable at venue.
                        </div>
                    `;
                } else if (paymentSettings.allowFull && !paymentSettings.allowDeposit) {
                    paymentInfo = `
                        <div class="mt-2 text-xs text-light-grey">
                            Full payment due at checkout.
                        </div>
                    `;
                } else if (paymentSettings.allowPayAtVenue && !paymentSettings.allowFull && !paymentSettings.allowDeposit) {
                    paymentInfo = `
                        <div class="mt-2 text-xs text-light-grey">
                            Payment due at venue.
                        </div>
                    `;
                }
                
                servicesHTML += `
                    <div class="bg-dark-grey/50 rounded-2xl p-6 border border-white/10 hover:border-gold/30 transition-all duration-300">
                        <h3 class="text-lg font-semibold text-white mb-3">${service.name}</h3>
                        <p class="text-light-grey text-sm mb-4">${service.description}</p>
                        <div class="flex items-center justify-between">
                            <span class="text-gold font-bold">${priceDisplay}</span>
                            <span class="text-light-grey text-sm">${service.duration}</span>
                        </div>
                        ${paymentInfo}
                    </div>
                `;
            });
            
            servicesGrid.innerHTML = servicesHTML;
        }

        // Demo functions to test different payment configurations
        function setPaymentFullOnly() {
            updateBusinessPaymentSettings({
                allowFull: true,
                allowDeposit: false,
                depositPercent: 25,
                allowPayAtVenue: false
            });
        }

        // Demo function for Urban Roots Salon (30% deposit only)
        function setUrbanRootsSalon() {
            updateBusinessPaymentSettings({
                allowFull: false,
                allowDeposit: true,
                depositPercent: 30,
                allowPayAtVenue: false
            });
        }

        // Demo function to show dashboard integration
        function demoDashboardIntegration() {
            console.log('=== Dashboard Integration Demo ===');
            console.log('1. Open business-dashboard-payment-options.html');
            console.log('2. Change payment settings in the dashboard');
            console.log('3. Return to this page and refresh to see changes');
            console.log('4. Settings are synced via localStorage key: business_royal-hair-studio_payment_settings');
            
            // Show current settings
            const currentSettings = getBusinessPaymentSettings();
            console.log('Current payment settings:', currentSettings);
            
            // Show how to access dashboard
            console.log('Dashboard URL: business-dashboard-payment-options.html');
        }

        function setPaymentDepositOnly() {
            updateBusinessPaymentSettings({
                allowFull: false,
                allowDeposit: true,
                depositPercent: 30,
                allowPayAtVenue: false
            });
        }

        function setPaymentFullWithVenue() {
            updateBusinessPaymentSettings({
                allowFull: true,
                allowDeposit: false,
                depositPercent: 25,
                allowPayAtVenue: true
            });
        }

        function setPaymentDepositWithVenue() {
            updateBusinessPaymentSettings({
                allowFull: false,
                allowDeposit: true,
                depositPercent: 20,
                allowPayAtVenue: true
            });
        }

        function setPaymentVenueOnly() {
            updateBusinessPaymentSettings({
                allowFull: false,
                allowDeposit: false,
                depositPercent: 25,
                allowPayAtVenue: true
            });
        }

        // Test function to demonstrate payment configurations
        function testPaymentConfigurations() {
            console.log('🧪 Testing Payment Configurations:');
            console.log('1. setPaymentFullOnly() - Only "Pay in Full" option');
            console.log('2. setPaymentDepositOnly() - Only "Pay Deposit" option');
            console.log('3. setPaymentFullWithVenue() - "Pay in Full" + "Pay at Venue"');
            console.log('4. setPaymentDepositWithVenue() - "Pay Deposit" + "Pay at Venue"');
            console.log('5. setPaymentVenueOnly() - Only "Pay at Venue" option');
            console.log('\nTry calling these functions to see different configurations!');
        }

        // Open booking modal
        function openBookingModal() {
            const modal = document.getElementById('bookingModal');
            modal.classList.remove('hidden');
            
            // Add show classes for animation
            setTimeout(() => {
                modal.classList.add('show');
                const modalContent = modal.querySelector('.modal-content');
                modalContent.classList.add('show');
            }, 10);
            
            // Prevent body scroll
            document.body.style.overflow = 'hidden';
        }

        // Close booking modal
        function closeBookingModal() {
            const modal = document.getElementById('bookingModal');
            const modalContent = modal.querySelector('.modal-content');
            
            // Remove show classes for animation
            modal.classList.remove('show');
            modalContent.classList.remove('show');
            
            // Hide modal after animation
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300);
            
            // Restore body scroll
            document.body.style.overflow = '';
        }

        // Handle Sign In
        function handleSignIn() {
            const serviceId = businessData.slug;
            window.location.href = `/auth/signin?redirect=/booking/${serviceId}`;
        }

        // Handle Sign Up
        function handleSignUp() {
            const serviceId = businessData.slug;
            window.location.href = `/auth/signup?redirect=/booking/${serviceId}`;
        }

        // Handle Continue as Guest
        function handleContinueAsGuest() {
            // Store business data with payment settings
            const businessWithPayments = {
                ...businessData,
                payments: getBusinessPaymentSettings()
            };
            localStorage.setItem('selectedBusiness', JSON.stringify(businessWithPayments));
            window.location.href = 'booking-review.html';
        }

        // Direct link to new payment page (for testing)
        function goToNewPaymentPage() {
            // Store business data with payment settings
            const businessWithPayments = {
                ...businessData,
                payments: getBusinessPaymentSettings()
            };
            localStorage.setItem('selectedBusiness', JSON.stringify(businessWithPayments));
            window.location.href = 'payment-new.html';
        }

        // Call business
        function callBusiness(phoneNumber) {
            window.location.href = `tel:${phoneNumber}`;
        }

        // Email business
        function emailBusiness(emailAddress) {
            window.location.href = `mailto:${emailAddress}?subject=BlkPages Enquiry`;
        }

        // Close mobile menu when clicking outside
        document.addEventListener('click', function(event) {
            const menu = document.getElementById('mobileMenu');
            const button = event.target.closest('button');
            
            if (!menu.contains(event.target) && !button) {
                menu.classList.add('hidden');
            }
        });
    </script>
</body>
</html>
