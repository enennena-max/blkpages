<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>List Your Business - BLKPAGES</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; line-height: 1.6; color: #ffffff; background: linear-gradient(135deg, #2A2A2A 0%, #1A1A1A 50%, #0F0F0F 100%); min-height: 100vh; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        
        /* Navigation */
        .navbar { background: rgba(0, 0, 0, 0.95); box-shadow: 0 2px 10px rgba(255,255,255,0.1); position: fixed; top: 0; width: 100%; z-index: 1000; }
        .nav-wrapper { display: flex; justify-content: space-between; align-items: center; padding: 1.5rem 0; }
        .logo { font-size: 1.8rem; font-weight: 700; color: #ffffff; text-decoration: none; }
        .nav-links { display: flex; list-style: none; gap: 2rem; }
        .nav-links a { text-decoration: none; color: #ffffff; font-weight: 500; transition: color 0.3s; }
        .nav-links a:hover, .nav-links a.active { color: #007bff; }
        .btn-nav { background: #007bff; color: white !important; padding: 0.5rem 1.5rem; border-radius: 25px; transition: background 0.3s; text-decoration: none; }
        .btn-nav:hover { background: #0056b3; }
        
        /* Main Content */
        .main-content { padding: 120px 0 80px; }
        .page-title { font-size: 3rem; font-weight: 700; margin-bottom: 1rem; text-align: center; color: #ffffff; }
        .page-subtitle { text-align: center; color: #cccccc; margin-bottom: 3rem; font-size: 1.1rem; }
        
        /* Registration Form */
        .registration-container { display: grid; grid-template-columns: 1fr 1fr; gap: 4rem; }
        .registration-form { background: #1a1a1a; padding: 3rem; border-radius: 15px; border: 1px solid #333; }
        .registration-form h2 { font-size: 2rem; font-weight: 600; margin-bottom: 2rem; color: #ffffff; }
        .form-section { margin-bottom: 2rem; }
        .form-section h3 { font-size: 1.3rem; font-weight: 600; margin-bottom: 1rem; color: #ffffff; }
        .form-group { margin-bottom: 1.5rem; }
        .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 500; color: #ffffff; }
        .form-group input, .form-group select, .form-group textarea { 
            width: 100%; 
            padding: 0.75rem; 
            border: 2px solid #333; 
            border-radius: 8px; 
            font-size: 1rem; 
            background: #2a2a2a; 
            color: #ffffff; 
            font-family: inherit;
        }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #007bff;
        }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        .required { color: #ff6b6b; }
        .form-help { color: #888; font-size: 0.9rem; margin-top: 0.5rem; }
        
        /* Policy Preview Styles */
        .policy-preview {
            background: #1a1a1a;
            border: 1px solid #374151;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }
        
        .policy-preview h4 {
            color: #ffffff;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
        }
        
        .policy-content {
            background: #111111;
            border: 1px solid #374151;
            border-radius: 6px;
            padding: 1rem;
            color: #e5e7eb;
            font-size: 0.9rem;
            line-height: 1.5;
            white-space: pre-line;
        }
        
        .custom-policy-editor {
            margin-top: 1rem;
            padding: 1rem;
            background: #1a1a1a;
            border: 1px solid #374151;
            border-radius: 8px;
        }
        
        .custom-policy-editor label {
            color: #ffffff;
            font-weight: 500;
            margin-bottom: 0.5rem;
            display: block;
        }
        
        .custom-policy-editor textarea {
            background: #111111;
            border: 1px solid #374151;
            color: #e5e7eb;
            font-family: inherit;
        }
        
        /* Payment Model Styles */
        .payment-preview {
            background: #1a1a1a;
            border: 1px solid #374151;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }
        
        .payment-preview h4 {
            color: #FF3CAC;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
        }
        
        .preview-content {
            background: #111111;
            border: 1px solid #374151;
            border-radius: 6px;
            padding: 1rem;
            color: #e5e7eb;
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        /* Subscription Tiers */
        .subscription-section { background: #1a1a1a; padding: 3rem; border-radius: 15px; border: 1px solid #333; height: fit-content; }
        .subscription-section h2 { font-size: 2rem; font-weight: 600; margin-bottom: 2rem; color: #ffffff; }
        .subscription-tiers { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); 
            gap: 1.5rem; 
        }
        .tier-card { 
            background: #2a2a2a; 
            padding: 2rem; 
            border-radius: 10px; 
            border: 2px solid #333; 
            cursor: pointer; 
            transition: all 0.3s;
            position: relative;
        }
        .tier-card:hover { border-color: #007bff; }
        .tier-card.selected { border-color: #007bff; background: #1a3a5c; }
        .tier-card { transition: all 0.3s ease; }
        .subscription-tiers { transition: all 0.3s ease; }
        
        /* Visual indicator for selected plan at top */
        .tier-card.selected::after {
            content: "✓ Selected";
            position: absolute;
            top: 10px;
            right: 10px;
            background: #007bff;
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        .tier-card.popular { border-color: #ff6b35; }
        .tier-card.popular::before {
            content: "Most Popular";
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            background: #ff6b35;
            color: white;
            padding: 0.3rem 1rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        .tier-header { text-align: center; margin-bottom: 1.5rem; }
        .tier-name { font-size: 1.3rem; font-weight: 600; color: #ffffff; margin-bottom: 0.5rem; }
        .tier-price { font-size: 2rem; font-weight: 700; color: #007bff; margin-bottom: 0.5rem; }
        .tier-period { color: #888; font-size: 0.9rem; }
        .tier-features { list-style: none; }
        .tier-features li { 
            padding: 0.5rem 0; 
            color: #cccccc; 
            border-bottom: 1px solid #333; 
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .tier-features li:last-child { border-bottom: none; }
        .tier-features li i { color: #10B981; }
        .tier-features li.unavailable { color: #666; }
        .tier-features li.unavailable i { color: #666; }
        
        /* Add-On Card Styles */
        .addons-section {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid #333;
        }
        
        .addons-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .addon-card {
            background: #2A2A2A;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
        }
        
        .addon-card:hover {
            border-color: #FF3CAC;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(255, 60, 172, 0.1);
        }
        
        .addon-header {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .addon-icon {
            background: linear-gradient(135deg, #FF3CAC, #784BA0);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            flex-shrink: 0;
        }
        
        .addon-info {
            flex: 1;
        }
        
        .addon-info h4 {
            color: #ffffff;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }
        
        .addon-info p {
            color: #cccccc;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .addon-price {
            text-align: right;
        }
        
        .addon-price .price {
            color: #FF3CAC;
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .addon-price .period {
            color: #cccccc;
            font-size: 0.9rem;
            margin-left: 0.25rem;
        }
        
        .addon-features {
            margin-bottom: 1.5rem;
        }
        
        .addon-features ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .addon-features li {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            margin-bottom: 0.5rem;
            color: #cccccc;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .addon-features li i {
            color: #28a745;
            margin-top: 0.1rem;
            flex-shrink: 0;
        }
        
        .addon-actions {
            text-align: center;
        }
        
        .btn-addon {
            background: linear-gradient(135deg, #10B981, #059669);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-addon:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(16, 185, 129, 0.3);
        }
        
        .btn-addon.added {
            background: #28a745;
            cursor: default;
        }
        
        .btn-addon.added:hover {
            transform: none;
            box-shadow: none;
        }
        
        /* Buttons */
        .btn-submit { 
            background: #007bff; 
            color: white; 
            border: none; 
            padding: 1rem 2rem; 
            border-radius: 25px; 
            cursor: pointer; 
            font-weight: 600; 
            font-size: 1.1rem;
            width: 100%;
            margin-top: 2rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
        }
        .btn-submit:hover { 
            background: #0056b3; 
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 123, 255, 0.4);
        }
        .btn-submit:disabled { background: #333; cursor: not-allowed; transform: none; box-shadow: none; }
        
        /* Button validation feedback */
        .btn-submit.validation-feedback {
            animation: buttonPulse 0.6s ease-in-out;
        }
        
        @keyframes buttonPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        /* Form Validation Styles */
        .form-group input.validation-error, 
        .form-group select.validation-error, 
        .form-group textarea.validation-error {
            border: 2px solid #1E90FF !important;
            background-color: #E6F0FF20 !important;
            box-shadow: 0 0 10px rgba(30, 144, 255, 0.3), 0 0 20px rgba(30, 144, 255, 0.1) !important;
            animation: fieldShake 0.5s ease-in-out;
        }
        
        @keyframes fieldShake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-3px); }
            20%, 40%, 60%, 80% { transform: translateX(3px); }
        }
        
        /* Validation Tooltip */
        .validation-tooltip {
            position: absolute;
            bottom: -25px;
            left: 0;
            right: 0;
            background: rgba(30, 144, 255, 0.9);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            text-align: center;
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1000;
            border: 1px solid #1E90FF;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }
        
        .validation-tooltip.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .form-group {
            position: relative;
        }
        
        /* Validation Pop-up Modal */
        .validation-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .validation-modal.show {
            opacity: 1;
            visibility: visible;
        }
        
        .validation-modal-content {
            background: #111;
            color: white;
            padding: 2rem;
            border-radius: 12px;
            border: 2px solid #1E90FF;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            text-align: center;
            max-width: 400px;
            width: 90%;
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }
        
        .validation-modal.show .validation-modal-content {
            transform: scale(1);
        }
        
        .validation-modal h3 {
            color: #1E90FF;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }
        
        .validation-modal p {
            color: #ffffff;
            line-height: 1.5;
        }
        
        /* Payment Section Styles */
        .payment-notice {
            background: #1a3a5c;
            border: 1px solid #1E90FF;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .payment-notice i {
            color: #1E90FF;
            font-size: 1.2rem;
        }
        
        .payment-notice p {
            color: #ffffff;
            margin: 0;
            font-size: 0.9rem;
        }
        
        .card-icons {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        
        .card-icons i {
            font-size: 1.5rem;
            color: #888;
            transition: color 0.3s;
        }
        
        .card-icons i:hover {
            color: #1E90FF;
        }
        
        .payment-summary {
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }
        
        .payment-summary h4 {
            color: #1E90FF;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }
        
        .summary-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid #444;
        }
        
        .summary-item:last-child {
            border-bottom: none;
        }
        
        .summary-item.total {
            font-weight: 600;
            font-size: 1.1rem;
            color: #1E90FF;
            border-top: 2px solid #1E90FF;
            margin-top: 0.5rem;
            padding-top: 1rem;
        }
        
        .summary-item span:first-child {
            color: #cccccc;
        }
        
        .summary-item span:last-child {
            color: #ffffff;
            font-weight: 500;
        }
        
        /* Terms */
        .terms-section { margin-top: 2rem; padding-top: 2rem; border-top: 1px solid #333; }
        .terms-section p { color: #888; font-size: 0.9rem; line-height: 1.5; }
        .terms-section a { color: #007bff; text-decoration: none; }
        .terms-section a:hover { text-decoration: underline; }
        
        /* Footer */
        .footer { background: #222; color: white; padding: 40px 0; text-align: center; }
        
        @media (max-width: 768px) {
            .nav-links { display: none; }
            .page-title { font-size: 2rem; }
            .registration-container { grid-template-columns: 1fr; gap: 2rem; }
            .form-row { grid-template-columns: 1fr; }
            .subscription-tiers { grid-template-columns: 1fr; }
            .tier-card { margin-bottom: 1rem; }
            
            /* Ensure selected plan indicator is visible on mobile */
            .tier-card.selected::after {
                font-size: 0.7rem;
                padding: 0.2rem 0.6rem;
                top: 8px;
                right: 8px;
            }
            
            .addon-header {
                flex-direction: column;
                text-align: center;
                gap: 1rem;
            }
            
            .addon-price {
                text-align: center;
            }
            
            /* Mobile validation styles */
            .validation-modal-content {
                margin: 1rem;
                padding: 1.5rem;
                max-width: calc(100% - 2rem);
            }
            
            .validation-tooltip {
                font-size: 0.75rem;
                padding: 3px 6px;
                bottom: -22px;
            }
            
            .form-group input.validation-error, 
            .form-group select.validation-error, 
            .form-group textarea.validation-error {
                box-shadow: 0 0 8px rgba(30, 144, 255, 0.4), 0 0 15px rgba(30, 144, 255, 0.2) !important;
            }
            
            /* Ensure tooltips don't overflow on mobile */
            .form-group {
                margin-bottom: 2rem;
            }
            
            /* Touch-friendly validation feedback */
            .btn-submit.validation-feedback {
                animation: buttonPulseMobile 0.6s ease-in-out;
            }
            
            @keyframes buttonPulseMobile {
                0% { transform: scale(1); }
                50% { transform: scale(1.02); }
                100% { transform: scale(1); }
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-wrapper">
                <a href="index.html" class="logo">BLKPAGES</a>
                <ul class="nav-links">
                    <li><a href="directory.html">Directory</a></li>
                    <li><a href="search.html">Search</a></li>
                    <li><a href="business-login.html">Business Login</a></li>
                    <li><a href="contact.html">Contact</a></li>
                </ul>
                <a href="business-login.html" class="btn-nav">Business Login</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <h1 class="page-title">List Your Business</h1>
            <p class="page-subtitle">Join the BLKPAGES community and connect with customers in your area</p>
            
            <div class="registration-container">
                <!-- Registration Form -->
                <div class="registration-form">
                    <h2>Business Information</h2>
                    <form id="businessRegistrationForm">
                        <!-- Business Details -->
                        <div class="form-section">
                            <h3>Business Details</h3>
                            <div class="form-group">
                                <label for="businessName">Business Name <span class="required">*</span></label>
                                <input type="text" id="businessName" name="businessName" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="category">Category <span class="required">*</span></label>
                                <select id="category" name="category" required>
                                    <option value="">Select Category</option>
                                    <option value="hairdresser">Hairdresser</option>
                                    <option value="barber">Barber</option>
                                    <option value="beauty">Beauty Services</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="description">Business Description <span class="required">*</span></label>
                                <textarea id="description" name="description" rows="4" required placeholder="Tell customers about your business, services, and what makes you special..."></textarea>
                                <div class="form-help">Describe your services, specialties, and what customers can expect.</div>
                            </div>
                        </div>
                        
                        <!-- Contact Information -->
                        <div class="form-section">
                            <h3>Contact Information</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="phone">Phone Number <span class="required">*</span></label>
                                    <input type="tel" id="phone" name="phone" pattern="(\+44\s?7\d{3}|\(?07\d{3}\)?)\s?\d{3}\s?\d{3}" placeholder="+44 7123 456789 or 07123 456789" required>
                                </div>
                                <div class="form-group">
                                    <label for="email">Email Address <span class="required">*</span></label>
                                    <input type="email" id="email" name="email" required>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="website">Website (Optional)</label>
                                <input type="url" id="website" name="website" placeholder="https://yourwebsite.com">
                            </div>
                        </div>
                        
                        <!-- Location -->
                        <div class="form-section">
                            <h3>Location</h3>
                            <div class="form-group">
                                <label for="address">Street Address <span class="required">*</span></label>
                                <input type="text" id="address" name="address" required>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="city">City <span class="required">*</span></label>
                                    <input type="text" id="city" name="city" required>
                                </div>
                                <div class="form-group">
                                    <label for="state">County <span class="required">*</span></label>
                                    <input type="text" id="state" name="state" required>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="zipCode">Postcode <span class="required">*</span></label>
                                    <input type="text" id="zipCode" name="zipCode" pattern="[A-Za-z]{1,2}[0-9Rr][0-9A-Za-z]? [0-9][ABD-HJLNP-UW-Zabd-hjlnp-uw-z]{2}" placeholder="e.g., SW1A 1AA" required>
                                </div>
                                <div class="form-group">
                                    <label for="serviceArea">Service Area</label>
                                    <input type="text" id="serviceArea" name="serviceArea" placeholder="e.g., 10 miles radius">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Business Hours -->
                        <div class="form-section">
                            <h3>Business Hours</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="hoursStart">Opening Time</label>
                                    <input type="time" id="hoursStart" name="hoursStart">
                                </div>
                                <div class="form-group">
                                    <label for="hoursEnd">Closing Time</label>
                                    <input type="time" id="hoursEnd" name="hoursEnd">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="daysOpen">Days Open</label>
                                <select id="daysOpen" name="daysOpen" multiple>
                                    <option value="monday">Monday</option>
                                    <option value="tuesday">Tuesday</option>
                                    <option value="wednesday">Wednesday</option>
                                    <option value="thursday">Thursday</option>
                                    <option value="friday">Friday</option>
                                    <option value="saturday">Saturday</option>
                                    <option value="sunday">Sunday</option>
                                </select>
                                <div class="form-help">Hold Ctrl/Cmd to select multiple days</div>
                            </div>
                        </div>
                        
                        <!-- Booking Policies -->
                        <div class="form-section">
                            <h3>Booking Policies</h3>
                            
                            <!-- Cancellation Policy -->
                            <div class="form-group">
                                <label for="cancellationPolicy">Cancellation Policy <span class="required">*</span></label>
                                <select id="cancellationPolicy" name="cancellationPolicy" required onchange="updateCancellationPreview()">
                                    <option value="">Select Policy</option>
                                    <option value="flexible">Flexible</option>
                                    <option value="moderate">Moderate</option>
                                    <option value="strict">Strict</option>
                                    <option value="custom" id="customOption" style="display: none;">Custom (Premium Only)</option>
                                </select>
                                <div class="form-help">Choose a cancellation policy that works for your business.</div>
                            </div>
                            
                            <!-- Policy Preview -->
                            <div id="policyPreview" class="policy-preview" style="display: none;">
                                <h4>Policy Preview</h4>
                                <div class="policy-content" id="policyContent"></div>
                            </div>
                            
                            <!-- Custom Policy Editor (Premium Only) -->
                            <div id="customPolicyEditor" class="custom-policy-editor" style="display: none;">
                                <label for="customPolicyText">Custom Policy Text</label>
                                <textarea id="customPolicyText" name="customPolicyText" rows="6" placeholder="Enter your custom cancellation policy..."></textarea>
                                <div class="form-help">You can customize the policy text. Use [Business Name] to insert your business name automatically.</div>
                            </div>
                            
                            <div class="form-group">
                                <label for="bookingNotes">Additional Booking Information</label>
                                <textarea id="bookingNotes" name="bookingNotes" rows="3" placeholder="Any additional information customers should know when booking (e.g., arrival time, what to bring, special requirements)"></textarea>
                                <div class="form-help">Optional: Additional information to help customers prepare for their appointment.</div>
                            </div>
                        </div>
                        
                        <!-- Payment Model -->
                        <div class="form-section">
                            <h3>Payment Model</h3>
                            <div class="form-group">
                                <label for="paymentModel">Payment Model <span class="required">*</span></label>
                                <select id="paymentModel" name="paymentModel" required onchange="updatePaymentModel()">
                                    <option value="">Select Payment Model</option>
                                    <option value="full-online">Full Payment Online</option>
                                    <option value="deposit-balance">Deposit Online + Balance at Venue</option>
                                    <option value="full-venue">Full Payment at Venue</option>
                                </select>
                                <div class="form-help">Choose how customers will pay for your services. This cannot be changed after setup.</div>
                            </div>
                            
                            <!-- Deposit Percentage (only shown for deposit + balance option) -->
                            <div class="form-group" id="depositPercentageGroup" style="display: none;">
                                <label for="depositPercentage">Deposit Percentage <span class="required">*</span></label>
                                <select id="depositPercentage" name="depositPercentage">
                                    <option value="">Select Deposit Percentage</option>
                                    <option value="10">10%</option>
                                    <option value="20">20%</option>
                                    <option value="30">30%</option>
                                    <option value="40">40%</option>
                                    <option value="50">50%</option>
                                </select>
                                <div class="form-help">Choose what percentage customers will pay as a deposit online.</div>
                            </div>
                            
                            <!-- Payment Model Preview -->
                            <div class="payment-preview" id="paymentPreview" style="display: none;">
                                <h4>Payment Model Preview</h4>
                                <div class="preview-content" id="paymentPreviewContent">
                                    <!-- Preview content will be populated by JavaScript -->
                                </div>
                            </div>
                        </div>
                        
                        <!-- Payment Information (for Starter and Professional packages) -->
                        <div class="form-section" id="paymentSection" style="display: none;">
                            <h3>Payment Information</h3>
                            <div class="payment-notice">
                                <i class="fas fa-credit-card"></i>
                                <p>Secure payment processing. Your card details are encrypted and secure.</p>
                            </div>
                            
                            <div id="freePlanAddonNotice" class="payment-notice" style="display: none; background: #2d5016; border-color: #28a745;">
                                <i class="fas fa-info-circle" style="color: #28a745;"></i>
                                <p>You've selected premium add-ons with your free plan. Payment is required for these additional features.</p>
                            </div>
                            
                            <div class="form-group">
                                <label for="cardNumber">Card Number <span class="required">*</span></label>
                                <input type="text" id="cardNumber" name="cardNumber" placeholder="1234 5678 9012 3456" maxlength="19">
                                <div class="card-icons">
                                    <i class="fab fa-cc-visa"></i>
                                    <i class="fab fa-cc-mastercard"></i>
                                    <i class="fab fa-cc-amex"></i>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="expiryDate">Expiry Date <span class="required">*</span></label>
                                    <input type="text" id="expiryDate" name="expiryDate" placeholder="MM/YY" maxlength="5">
                                </div>
                                <div class="form-group">
                                    <label for="cvv">CVV <span class="required">*</span></label>
                                    <input type="text" id="cvv" name="cvv" placeholder="123" maxlength="4">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="cardholderName">Cardholder Name <span class="required">*</span></label>
                                <input type="text" id="cardholderName" name="cardholderName" placeholder="Name as it appears on card">
                            </div>
                            
                            <div class="form-group">
                                <label for="billingAddress">Billing Address <span class="required">*</span></label>
                                <input type="text" id="billingAddress" name="billingAddress" placeholder="Street address">
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="billingCity">City <span class="required">*</span></label>
                                    <input type="text" id="billingCity" name="billingCity" placeholder="City">
                                </div>
                                <div class="form-group">
                                    <label for="billingPostcode">Postcode <span class="required">*</span></label>
                                    <input type="text" id="billingPostcode" name="billingPostcode" placeholder="SW1A 1AA">
                                </div>
                            </div>
                            
                            <div class="payment-summary">
                                <h4>Payment Summary</h4>
                                <div class="summary-item">
                                    <span>Selected Plan:</span>
                                    <span id="selectedPlanName">-</span>
                                </div>
                                <div class="summary-item">
                                    <span>Monthly Cost:</span>
                                    <span id="monthlyCost">-</span>
                                </div>
                                <div id="addonsSection" style="display: none;">
                                    <div class="summary-item">
                                        <span>Premium Add-ons:</span>
                                        <span id="addonsList">-</span>
                                    </div>
                                    <div class="summary-item">
                                        <span>Add-ons Cost:</span>
                                        <span id="addonsCost">-</span>
                                    </div>
                                </div>
                                <div class="summary-item total">
                                    <span>Total Today:</span>
                                    <span id="totalToday">-</span>
                                </div>
                                <div class="summary-item">
                                    <span>Recurring Monthly:</span>
                                    <span id="recurringMonthly">-</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Account Information -->
                        <div class="form-section">
                            <h3>Account Information</h3>
                            <div class="form-group">
                                <label for="ownerName">Owner/Manager Name <span class="required">*</span></label>
                                <input type="text" id="ownerName" name="ownerName" required>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="password">Password <span class="required">*</span></label>
                                    <input type="password" id="password" name="password" required>
                                </div>
                                <div class="form-group">
                                    <label for="confirmPassword">Confirm Password <span class="required">*</span></label>
                                    <input type="password" id="confirmPassword" name="confirmPassword" required>
                                </div>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn-submit" id="submitBtn">Create Business Listing</button>
                    </form>
                </div>
                
                <!-- Subscription Tiers -->
                <div class="subscription-section">
                    <h2>Choose Your Plan</h2>
                    <div class="subscription-tiers">
                        <!-- Free Tier -->
                        <div class="tier-card" data-tier="free" onclick="selectTier('free')">
                            <div class="tier-header">
                                <div class="tier-name">Free Listing</div>
                                <div class="tier-price">£0</div>
                                <div class="tier-period">Forever</div>
                            </div>
                            <ul class="tier-features">
                                <li><i class="fas fa-check"></i> Business listing with category visibility</li>
                                <li><i class="fas fa-check"></i> Basic contact details</li>
                                <li><i class="fas fa-check"></i> Standard search placement</li>
                                <li><i class="fas fa-times unavailable"></i> Business logo and photo gallery</li>
                                <li><i class="fas fa-times unavailable"></i> Enhanced profile visibility</li>
                                <li><i class="fas fa-times unavailable"></i> Customer review highlights</li>
                                <li><i class="fas fa-times unavailable"></i> Basic booking system</li>
                                <li><i class="fas fa-times unavailable"></i> Advanced booking system</li>
                                <li><i class="fas fa-times unavailable"></i> Business insights</li>
                            </ul>
                        </div>
                        
                        <!-- Starter Tier -->
                        <div class="tier-card" data-tier="starter" onclick="selectTier('starter')">
                            <div class="tier-header">
                                <div class="tier-name">Starter</div>
                                <div class="tier-price">£15</div>
                                <div class="tier-period">per month</div>
                            </div>
                            <ul class="tier-features">
                                <li><i class="fas fa-check"></i> Business listing with category visibility</li>
                                <li><i class="fas fa-check"></i> Basic contact details</li>
                                <li><i class="fas fa-check"></i> Standard search placement</li>
                                <li><i class="fas fa-check"></i> Business logo and photo gallery (up to 3 photos)</li>
                                <li><i class="fas fa-check"></i> Enhanced profile visibility</li>
                                <li><i class="fas fa-check"></i> Customer review highlights</li>
                                <li><i class="fas fa-check"></i> Basic booking system</li>
                                <li><i class="fas fa-times unavailable"></i> Advanced booking system</li>
                                <li><i class="fas fa-times unavailable"></i> Business insights</li>
                            </ul>
                        </div>

                        <!-- Professional Tier -->
                        <div class="tier-card popular" data-tier="professional" onclick="selectTier('professional')">
                            <div class="tier-header">
                                <div class="tier-name">Professional</div>
                                <div class="tier-price">£29</div>
                                <div class="tier-period">per month</div>
                            </div>
                            <ul class="tier-features">
                                <li><i class="fas fa-check"></i> Everything in Starter</li>
                                <li><i class="fas fa-check"></i> Photo gallery (up to 10 photos)</li>
                                <li><i class="fas fa-check"></i> Premium profile visibility</li>
                                <li><i class="fas fa-check"></i> Advanced booking system with calendar sync</li>
                                <li><i class="fas fa-check"></i> Stripe integration (Full payment or Deposits 10–50%)</li>
                                <li><i class="fas fa-check"></i> SMS booking confirmations + reminders (X included)</li>
                                <li><i class="fas fa-check"></i> Customer management dashboard (notes, history, analytics)</li>
                                <li><i class="fas fa-check"></i> Business insights (bookings, revenue, busiest times)</li>
                            </ul>
                        </div>

                    </div>
                    
                    <!-- Premium Add-Ons Section -->
                    <div class="addons-section">
                        <h3 style="color: #ffffff; font-size: 1.5rem; font-weight: 600; margin-bottom: 1.5rem; text-align: center;">Premium Add-Ons</h3>
                        <p style="text-align: center; color: #cccccc; margin-bottom: 2rem; font-size: 1rem;">Enhance your business with these premium features</p>
                        
                        <div class="addons-grid">
                            <!-- SMS Credits -->
                            <div class="addon-card">
                                <div class="addon-header">
                                    <div class="addon-icon">
                                        <i class="fas fa-sms"></i>
                                    </div>
                                    <div class="addon-info">
                                        <h4>📲 Extra SMS Credits</h4>
                                        <p>Send appointment reminders and updates to customers</p>
                                    </div>
                                    <div class="addon-price">
                                        <span class="price">£3</span>
                                        <span class="period">per 50 messages</span>
                                    </div>
                                </div>
                                <div class="addon-actions">
                                    <button onclick="selectSMSAddon()" class="btn-addon" id="smsAddonBtn">
                                        <i class="fas fa-plus"></i> Add to Plan
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Featured Listing -->
                            <div class="addon-card">
                                <div class="addon-header">
                                    <div class="addon-icon">
                                        <i class="fas fa-star"></i>
                                    </div>
                                    <div class="addon-info">
                                        <h4>⭐ Featured Listing</h4>
                                        <p>Get priority placement in search results</p>
                                    </div>
                                    <div class="addon-price">
                                        <span class="price">£5</span>
                                        <span class="period">/month</span>
                                    </div>
                                </div>
                                <div class="addon-actions">
                                    <button onclick="selectFeaturedAddon()" class="btn-addon" id="featuredAddonBtn">
                                        <i class="fas fa-plus"></i> Add to Plan
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Social Media Widget -->
                            <div class="addon-card">
                                <div class="addon-header">
                                    <div class="addon-icon">
                                        <i class="fas fa-camera"></i>
                                    </div>
                                    <div class="addon-info">
                                        <h4>📸 Instagram/TikTok Widget</h4>
                                        <p>Social media booking link widget</p>
                                    </div>
                                    <div class="addon-price">
                                        <span class="price">£4</span>
                                        <span class="period">/month</span>
                                    </div>
                                </div>
                                <div class="addon-actions">
                                    <button onclick="selectSocialAddon()" class="btn-addon" id="socialAddonBtn">
                                        <i class="fas fa-plus"></i> Add to Plan
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Loyalty Rewards -->
                            <div class="addon-card">
                                <div class="addon-header">
                                    <div class="addon-icon">
                                        <i class="fas fa-gift"></i>
                                    </div>
                                    <div class="addon-info">
                                        <h4>🎁 Customer Loyalty Rewards</h4>
                                        <p>Digital punch card system for customer retention</p>
                                    </div>
                                    <div class="addon-price">
                                        <span class="price">£5</span>
                                        <span class="period">/month</span>
                                    </div>
                                </div>
                                <div class="addon-actions">
                                    <button onclick="selectLoyaltyAddon()" class="btn-addon" id="loyaltyAddonBtn">
                                        <i class="fas fa-plus"></i> Add to Plan
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Advanced Analytics -->
                            <div class="addon-card">
                                <div class="addon-header">
                                    <div class="addon-icon">
                                        <i class="fas fa-chart-line"></i>
                                    </div>
                                    <div class="addon-info">
                                        <h4>📊 Advanced Analytics</h4>
                                        <p>Performance & trends analysis</p>
                                    </div>
                                    <div class="addon-price">
                                        <span class="price">£5</span>
                                        <span class="period">/month</span>
                                    </div>
                                </div>
                                <div class="addon-actions">
                                    <button onclick="selectAnalyticsAddon()" class="btn-addon" id="analyticsAddonBtn">
                                        <i class="fas fa-plus"></i> Add to Plan
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Multi-Staff Scheduling -->
                            <div class="addon-card">
                                <div class="addon-header">
                                    <div class="addon-icon">
                                        <i class="fas fa-users"></i>
                                    </div>
                                    <div class="addon-info">
                                        <h4>👥 Multi-Staff Scheduling</h4>
                                        <p>Per extra staff member scheduling</p>
                                    </div>
                                    <div class="addon-price">
                                        <span class="price">£2</span>
                                        <span class="period">/month per staff</span>
                                    </div>
                                </div>
                                <div class="addon-actions">
                                    <button onclick="selectStaffAddon()" class="btn-addon" id="staffAddonBtn">
                                        <i class="fas fa-plus"></i> Add to Plan
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="terms-section">
                        <p>By creating a listing, you agree to our <a href="terms.html">Terms of Service</a> and <a href="privacy.html">Privacy Policy</a>.</p>
                        <p>You can upgrade or downgrade your plan at any time from your business dashboard.</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Validation Modal -->
    <div id="validationModal" class="validation-modal">
        <div class="validation-modal-content">
            <h3>⚠️ Required Fields Missing</h3>
            <p>Please complete all required fields before submitting your listing.</p>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 2rem;">
                <div>
                    <p>&copy; 2024 BLKPAGES. All rights reserved.</p>
                </div>
                <div style="display: flex; gap: 2rem; flex-wrap: wrap;">
                    <a href="about.html" style="color: #ffffff; text-decoration: none;">About Us</a>
                    <a href="contact.html" style="color: #ffffff; text-decoration: none;">Contact Us</a>
                    <a href="privacy.html" style="color: #ffffff; text-decoration: none;">Privacy Policy</a>
                    <a href="terms.html" style="color: #ffffff; text-decoration: none;">Terms & Conditions</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Business Manager Script -->
    <script src="business-manager.js"></script>
    
    <script>
        let selectedTier = 'free';
        
        function selectTier(tier) {
            selectedTier = tier;
            document.querySelectorAll('.tier-card').forEach(card => card.classList.remove('selected'));
            document.querySelector(`[data-tier="${tier}"]`).classList.add('selected');
            
            // Store selection in session storage
            sessionStorage.setItem('selectedPlan', tier);
            
            // Reorder plans to put selected plan at the top
            reorderPlans(tier);
            
            // Show/hide payment section based on tier
            togglePaymentSection(tier);
            
            // Update payment summary
            updatePaymentSummary(tier);
        }
        
        function reorderPlans(selectedTier) {
            const subscriptionTiers = document.querySelector('.subscription-tiers');
            const selectedCard = document.querySelector(`[data-tier="${selectedTier}"]`);
            const allCards = Array.from(document.querySelectorAll('.tier-card'));
            
            // Remove the selected card from its current position
            selectedCard.remove();
            
            // Insert the selected card at the top
            subscriptionTiers.insertBefore(selectedCard, subscriptionTiers.firstChild);
            
            // Add smooth transition
            selectedCard.style.transition = 'all 0.3s ease';
        }
        
        // Cancellation Policy Templates
        const cancellationTemplates = {
            flexible: `[Business Name] – Cancellation Policy:
You may cancel your booking up to 24 hours before your appointment for a full refund.
Cancellations made within 24 hours and no-shows will be charged 100% of the service price.
Refunds are returned to your original payment method within 5–10 business days.`,
            
            moderate: `[Business Name] – Cancellation Policy:
You may cancel your booking up to 48 hours before your appointment for a full refund.
Cancellations made within 48 hours will be charged 50% of the service price.
No-shows will be charged 100% of the service price.
Refunds are returned to your original payment method within 5–10 business days.`,
            
            strict: `[Business Name] – Cancellation Policy:
This booking is non-refundable once confirmed.
No-shows will be charged 100% of the service price.
Refunds are returned to your original payment method within 5–10 business days.`,
            
            custom: `[Business Name] – Cancellation Policy:
Cancellations: You may cancel your appointment up to [X hours/days] before the scheduled time for a full refund.
Late Cancellations: Cancellations made within [X hours/days] will be charged [X%] of the service price.
No-Shows: If you do not attend your appointment without notice, you will be charged [100%] of the service price.
Refunds: Refunds (where applicable) will be processed back to your original payment method within [X working days].`
        };
        
        // Update cancellation policy preview
        function updateCancellationPreview() {
            const policySelect = document.getElementById('cancellationPolicy');
            const policyPreview = document.getElementById('policyPreview');
            const policyContent = document.getElementById('policyContent');
            const customEditor = document.getElementById('customPolicyEditor');
            const customOption = document.getElementById('customOption');
            const businessName = document.getElementById('businessName').value || '[Business Name]';
            
            if (policySelect.value === '') {
                policyPreview.style.display = 'none';
                customEditor.style.display = 'none';
                return;
            }
            
            // Show custom option for premium tiers
            const selectedTier = document.querySelector('.tier-card.selected')?.getAttribute('data-tier');
            if (selectedTier === 'professional') {
                customOption.style.display = 'block';
            } else {
                customOption.style.display = 'none';
                if (policySelect.value === 'custom') {
                    policySelect.value = '';
                    return;
                }
            }
            
            if (policySelect.value === 'custom') {
                policyPreview.style.display = 'none';
                customEditor.style.display = 'block';
                
                // Pre-fill custom template
                const customText = document.getElementById('customPolicyText');
                if (!customText.value) {
                    customText.value = cancellationTemplates.custom.replace('[Business Name]', businessName);
                }
            } else {
                customEditor.style.display = 'none';
                policyPreview.style.display = 'block';
                
                // Show preview with business name
                const template = cancellationTemplates[policySelect.value];
                policyContent.textContent = template.replace('[Business Name]', businessName);
            }
        }
        
        // Update preview when business name changes
        document.getElementById('businessName').addEventListener('input', function() {
            if (document.getElementById('policyPreview').style.display !== 'none') {
                updateCancellationPreview();
            }
        });
        
        // Payment Model Functions
        function updatePaymentModel() {
            const paymentModel = document.getElementById('paymentModel').value;
            const depositGroup = document.getElementById('depositPercentageGroup');
            const paymentPreview = document.getElementById('paymentPreview');
            const previewContent = document.getElementById('paymentPreviewContent');
            
            if (paymentModel === '') {
                depositGroup.style.display = 'none';
                paymentPreview.style.display = 'none';
                return;
            }
            
            if (paymentModel === 'deposit-balance') {
                depositGroup.style.display = 'block';
                document.getElementById('depositPercentage').required = true;
            } else {
                depositGroup.style.display = 'none';
                document.getElementById('depositPercentage').required = false;
            }
            
            // Show preview
            paymentPreview.style.display = 'block';
            
            // Update preview content based on selected model
            const businessName = document.getElementById('businessName').value || '[Business Name]';
            const depositPercentage = document.getElementById('depositPercentage').value;
            
            let previewText = '';
            
            switch (paymentModel) {
                case 'full-online':
                    previewText = `Full Payment Online:
• Customers pay the full service price online at booking
• No additional payment required at the venue
• Example: "Full payment of £70 due now."`;
                    break;
                    
                case 'deposit-balance':
                    if (depositPercentage) {
                        const depositAmount = Math.round(70 * (depositPercentage / 100)); // Using £70 as example
                        const balanceAmount = 70 - depositAmount;
                        previewText = `Deposit Online + Balance at Venue:
• Customers pay ${depositPercentage}% deposit online (£${depositAmount})
• Remaining balance (£${balanceAmount}) paid at the venue
• Example: "Pay £${depositAmount} now (${depositPercentage}%), balance £${balanceAmount} at the venue."`;
                    } else {
                        previewText = `Deposit Online + Balance at Venue:
• Customers pay a percentage deposit online
• Remaining balance paid at the venue
• Select deposit percentage above to see example`;
                    }
                    break;
                    
                case 'full-venue':
                    previewText = `Full Payment at Venue:
• No payment required online at booking
• Full service price paid directly at the venue
• Example: "No payment due now. Full balance of £70 payable at the venue."`;
                    break;
            }
            
            previewContent.textContent = previewText;
        }
        
        // Update preview when deposit percentage changes
        document.getElementById('depositPercentage').addEventListener('change', function() {
            if (document.getElementById('paymentModel').value === 'deposit-balance') {
                updatePaymentModel();
            }
        });
        
        // Form Validation System
        class FormValidator {
            constructor() {
                this.baseRequiredFields = [
                    'businessName', 'category', 'description', 'phone', 'email', 
                    'address', 'city', 'state', 'zipCode', 'cancellationPolicy', 
                    'paymentModel', 'ownerName', 'password', 'confirmPassword'
                ];
                this.paymentFields = [
                    'cardNumber', 'expiryDate', 'cvv', 'cardholderName', 
                    'billingAddress', 'billingCity', 'billingPostcode'
                ];
                this.requiredFields = [...this.baseRequiredFields];
                this.firstEmptyField = null;
                this.init();
            }
            
            init() {
                // Add event listeners to all form fields
                this.requiredFields.forEach(fieldId => {
                    const field = document.getElementById(fieldId);
                    if (field) {
                        // Clear validation effects when user starts typing
                        field.addEventListener('input', () => this.clearFieldValidation(field));
                        field.addEventListener('focus', () => this.clearFieldValidation(field));
                    }
                });
                
                // Form submission handler
                document.getElementById('businessRegistrationForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.validateForm();
                });
            }
            
            validateForm() {
                // Clear previous validation states
                this.clearAllValidation();
                
                // Check for empty required fields
                const emptyFields = this.getEmptyRequiredFields();
                
                if (emptyFields.length > 0) {
                    this.showValidationError(emptyFields);
                    return false;
                }
                
                // Additional validations
                if (!this.validatePasswords()) return false;
                if (!this.validatePostcode()) return false;
                if (!this.validatePhone()) return false;
                if (!this.validateDepositPercentage()) return false;
                if (!this.validatePaymentFields()) return false;
                
                // If all validations pass, proceed with form submission
                this.submitForm();
                return true;
            }
            
            getEmptyRequiredFields() {
                const emptyFields = [];
                
                this.requiredFields.forEach(fieldId => {
                    const field = document.getElementById(fieldId);
                    if (field && !field.value.trim()) {
                        emptyFields.push(field);
                    }
                });
                
                return emptyFields;
            }
            
            showValidationError(emptyFields) {
                // Add button feedback animation
                const submitBtn = document.getElementById('submitBtn');
                submitBtn.classList.add('validation-feedback');
                setTimeout(() => submitBtn.classList.remove('validation-feedback'), 600);
                
                // Highlight ALL empty fields simultaneously
                emptyFields.forEach((field, index) => {
                    // Apply validation styling to ALL fields
                    field.classList.add('validation-error');
                    this.addTooltip(field);
                    
                    // Add shake animation to first field only
                    if (index === 0) {
                        this.firstEmptyField = field;
                        // Keep the shake animation on first field
                        setTimeout(() => field.classList.remove('validation-error'), 500);
                        // Re-add the validation styling after shake animation
                        setTimeout(() => field.classList.add('validation-error'), 500);
                    }
                });
                
                // Show validation modal
                this.showValidationModal();
            }
            
            addTooltip(field) {
                // Remove existing tooltip if any
                const existingTooltip = field.parentNode.querySelector('.validation-tooltip');
                if (existingTooltip) {
                    existingTooltip.remove();
                }
                
                // Create new tooltip
                const tooltip = document.createElement('div');
                tooltip.className = 'validation-tooltip';
                tooltip.textContent = 'This field is required.';
                
                // Add tooltip to form group
                field.parentNode.appendChild(tooltip);
                
                // Show tooltip with animation
                setTimeout(() => tooltip.classList.add('show'), 100);
            }
            
            showValidationModal() {
                const modal = document.getElementById('validationModal');
                modal.classList.add('show');
                
                // Auto-hide modal after 3 seconds
                setTimeout(() => {
                    modal.classList.remove('show');
                }, 3000);
            }
            
            clearFieldValidation(field) {
                // Remove validation error styling
                field.classList.remove('validation-error');
                
                // Remove tooltip
                const tooltip = field.parentNode.querySelector('.validation-tooltip');
                if (tooltip) {
                    tooltip.classList.remove('show');
                    setTimeout(() => tooltip.remove(), 300);
                }
            }
            
            clearAllValidation() {
                // Clear all field validations
                document.querySelectorAll('.validation-error').forEach(field => {
                    field.classList.remove('validation-error');
                });
                
                // Remove all tooltips
                document.querySelectorAll('.validation-tooltip').forEach(tooltip => {
                    tooltip.remove();
                });
                
                // Hide modal
                document.getElementById('validationModal').classList.remove('show');
            }
            
            addPaymentFieldsToValidation() {
                // Add payment fields to required fields if not already present
                this.paymentFields.forEach(fieldId => {
                    if (!this.requiredFields.includes(fieldId)) {
                        this.requiredFields.push(fieldId);
                    }
                });
            }
            
            removePaymentFieldsFromValidation() {
                // Remove payment fields from required fields
                this.requiredFields = this.requiredFields.filter(fieldId => 
                    !this.paymentFields.includes(fieldId)
                );
            }
            
            validatePasswords() {
                const password = document.getElementById('password').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                
                if (password !== confirmPassword) {
                    this.showFieldError('confirmPassword', 'Passwords do not match!');
                    return false;
                }
                return true;
            }
            
            validatePostcode() {
                const postcode = document.getElementById('zipCode').value;
                const ukPostcodeRegex = /^[A-Za-z]{1,2}[0-9Rr][0-9A-Za-z]? [0-9][ABD-HJLNP-UW-Zabd-hjlnp-uw-z]{2}$/;
                
                if (!ukPostcodeRegex.test(postcode)) {
                    this.showFieldError('zipCode', 'Please enter a valid UK postcode (e.g., SW1A 1AA)');
                    return false;
                }
                return true;
            }
            
            validatePhone() {
                const phone = document.getElementById('phone').value;
                const ukPhoneRegex = /^(\+44\s?7\d{3}|\(?07\d{3}\)?)\s?\d{3}\s?\d{3}$/;
                
                if (!ukPhoneRegex.test(phone)) {
                    this.showFieldError('phone', 'Please enter a valid UK phone number');
                    return false;
                }
                return true;
            }
            
            validateDepositPercentage() {
                const paymentModel = document.getElementById('paymentModel').value;
                const depositPercentage = document.getElementById('depositPercentage').value;
                
                if (paymentModel === 'deposit-balance' && !depositPercentage) {
                    this.showFieldError('depositPercentage', 'Please select a deposit percentage');
                    return false;
                }
                return true;
            }
            
            validatePaymentFields() {
                // Only validate payment fields if they're visible (paid plans or free plan with add-ons)
                const paymentSection = document.getElementById('paymentSection');
                if (paymentSection.style.display === 'none') {
                    return true;
                }
                
                // Validate card number
                const cardNumber = document.getElementById('cardNumber').value.replace(/\s/g, '');
                if (cardNumber.length < 13 || cardNumber.length > 19) {
                    this.showFieldError('cardNumber', 'Please enter a valid card number');
                    return false;
                }
                
                // Validate expiry date
                const expiryDate = document.getElementById('expiryDate').value;
                const expiryRegex = /^(0[1-9]|1[0-2])\/\d{2}$/;
                if (!expiryRegex.test(expiryDate)) {
                    this.showFieldError('expiryDate', 'Please enter a valid expiry date (MM/YY)');
                    return false;
                }
                
                // Validate CVV
                const cvv = document.getElementById('cvv').value;
                if (cvv.length < 3 || cvv.length > 4) {
                    this.showFieldError('cvv', 'Please enter a valid CVV');
                    return false;
                }
                
                // Validate cardholder name
                const cardholderName = document.getElementById('cardholderName').value.trim();
                if (cardholderName.length < 2) {
                    this.showFieldError('cardholderName', 'Please enter the cardholder name');
                    return false;
                }
                
                return true;
            }
            
            showFieldError(fieldId, message) {
                const field = document.getElementById(fieldId);
                if (field) {
                    this.highlightField(field);
                    this.addCustomTooltip(field, message);
                    field.focus();
                }
            }
            
            addCustomTooltip(field, message) {
                // Remove existing tooltip if any
                const existingTooltip = field.parentNode.querySelector('.validation-tooltip');
                if (existingTooltip) {
                    existingTooltip.remove();
                }
                
                // Create new tooltip with custom message
                const tooltip = document.createElement('div');
                tooltip.className = 'validation-tooltip';
                tooltip.textContent = message;
                
                // Add tooltip to form group
                field.parentNode.appendChild(tooltip);
                
                // Show tooltip with animation
                setTimeout(() => tooltip.classList.add('show'), 100);
            }
            
            submitForm() {
                // Collect form data
                const formData = {
                    businessName: document.getElementById('businessName').value,
                    category: document.getElementById('category').value,
                    description: document.getElementById('description').value,
                    phone: document.getElementById('phone').value,
                    email: document.getElementById('email').value,
                    website: document.getElementById('website').value,
                    address: document.getElementById('address').value,
                    city: document.getElementById('city').value,
                    state: document.getElementById('state').value,
                    zipCode: document.getElementById('zipCode').value,
                    serviceArea: document.getElementById('serviceArea').value,
                    hoursStart: document.getElementById('hoursStart').value,
                    hoursEnd: document.getElementById('hoursEnd').value,
                    daysOpen: Array.from(document.getElementById('daysOpen').selectedOptions).map(option => option.value),
                    cancellationPolicy: document.getElementById('cancellationPolicy').value,
                    customPolicyText: document.getElementById('customPolicyText').value,
                    bookingNotes: document.getElementById('bookingNotes').value,
                    paymentModel: document.getElementById('paymentModel').value,
                    depositPercentage: document.getElementById('depositPercentage').value,
                    ownerName: document.getElementById('ownerName').value,
                    password: document.getElementById('password').value,
                    selectedTier: selectedTier,
                    loyaltyAddonSelected: sessionStorage.getItem('loyaltyAddonSelected') === 'true',
                    // Payment information (if applicable)
                    cardNumber: document.getElementById('cardNumber')?.value || '',
                    expiryDate: document.getElementById('expiryDate')?.value || '',
                    cvv: document.getElementById('cvv')?.value || '',
                    cardholderName: document.getElementById('cardholderName')?.value || '',
                    billingAddress: document.getElementById('billingAddress')?.value || '',
                    billingCity: document.getElementById('billingCity')?.value || '',
                    billingPostcode: document.getElementById('billingPostcode')?.value || '',
                    // Calculate total costs
                    monthlyCost: calculateMonthlyCost(selectedTier),
                    addonsCost: calculateAddonsTotal(getSelectedAddons()),
                    totalCost: calculateMonthlyCost(selectedTier) + calculateAddonsTotal(getSelectedAddons())
                };
                
                // Show loading state
                const submitBtn = document.getElementById('submitBtn');
                submitBtn.disabled = true;
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creating Listing...';
                
                // Save business to the system
                setTimeout(() => {
                    try {
                        // Add business to the business manager
                        const newBusiness = window.businessManager.addBusiness(formData);
                        
                        if (newBusiness) {
                            // Store form data in localStorage for payment page (if needed)
                            localStorage.setItem('businessRegistrationData', JSON.stringify(formData));
                            
                            // Show success message
                            const successMessage = `🎉 Congratulations! Your business "${newBusiness.name}" has been successfully registered and is now live on BLKPAGES!
                            
📍 Your business will appear in:
• ${newBusiness.category.charAt(0).toUpperCase() + newBusiness.category.slice(1)} category listings
• Location: ${newBusiness.city}, ${newBusiness.state}
• Search results for your area

${selectedTier === 'free' ? 
    '💡 Upgrade to a paid plan to unlock features like photo galleries, online booking, and priority placement!' : 
    '✨ Your premium features are now active!'}`;
                            
                            alert(successMessage);
                            
                            // Redirect based on subscription tier
                            if (selectedTier === 'professional' || selectedTier === 'starter') {
                                // For paid tiers, redirect to payment page
                                window.location.href = 'business-payment.html';
                            } else {
                                // For free tier, redirect to login
                                window.location.href = 'business-login.html';
                            }
                        } else {
                            throw new Error('Failed to create business listing');
                        }
                    } catch (error) {
                        console.error('Error creating business:', error);
                        alert('❌ There was an error creating your business listing. Please try again.');
                        submitBtn.disabled = false;
                        submitBtn.innerHTML = 'Create Business Listing';
                    }
                }, 2000);
            }
        }
        
        // Initialize form validator
        const formValidator = new FormValidator();
        
        // Initialize with selected plan from URL or session storage
        function initializePlanSelection() {
            // Check URL parameters first
            const urlParams = new URLSearchParams(window.location.search);
            const planFromUrl = urlParams.get('plan');
            
            // Check session storage
            const planFromStorage = sessionStorage.getItem('selectedPlan');
            
            // Use URL parameter if available, otherwise use session storage, otherwise default to free
            const selectedPlan = planFromUrl || planFromStorage || 'free';
            
            // Store the selection in session storage
            sessionStorage.setItem('selectedPlan', selectedPlan);
            
            // Select the tier and reorder plans
            selectTier(selectedPlan);
            
            // Initialize add-on button states
            initializeAddonStates();
        }
        
        function initializeAddonStates() {
            // Check all add-on states and update buttons
            const addons = [
                { id: 'smsAddonBtn', key: 'smsAddonSelected' },
                { id: 'featuredAddonBtn', key: 'featuredAddonSelected' },
                { id: 'socialAddonBtn', key: 'socialAddonSelected' },
                { id: 'loyaltyAddonBtn', key: 'loyaltyAddonSelected' },
                { id: 'analyticsAddonBtn', key: 'analyticsAddonSelected' },
                { id: 'staffAddonBtn', key: 'staffAddonSelected' }
            ];
            
            addons.forEach(addon => {
                const isSelected = sessionStorage.getItem(addon.key) === 'true';
                const button = document.getElementById(addon.id);
                
                if (isSelected && button) {
                    button.innerHTML = '<i class="fas fa-check"></i> Added to Plan';
                    button.classList.add('added');
                }
            });
        }
        
        // Initialize plan selection
        initializePlanSelection();
        
        // Payment section functions
        function togglePaymentSection(tier) {
            const paymentSection = document.getElementById('paymentSection');
            const freePlanAddonNotice = document.getElementById('freePlanAddonNotice');
            const hasAddons = getSelectedAddons().length > 0;
            
            // Show payment section if:
            // 1. Paid plan (starter/professional) OR
            // 2. Free plan but has premium add-ons
            if (tier === 'starter' || tier === 'professional' || (tier === 'free' && hasAddons)) {
                paymentSection.style.display = 'block';
                // Add payment fields to required fields for validation
                addPaymentFieldsToValidation();
                
                // Show special notice for free plan with add-ons
                if (tier === 'free' && hasAddons) {
                    freePlanAddonNotice.style.display = 'flex';
                } else {
                    freePlanAddonNotice.style.display = 'none';
                }
            } else {
                paymentSection.style.display = 'none';
                freePlanAddonNotice.style.display = 'none';
                // Remove payment fields from required fields
                removePaymentFieldsFromValidation();
            }
        }
        
        function updatePaymentSummary(tier) {
            const planName = document.getElementById('selectedPlanName');
            const monthlyCost = document.getElementById('monthlyCost');
            const totalToday = document.getElementById('totalToday');
            const recurringMonthly = document.getElementById('recurringMonthly');
            const addonsSection = document.getElementById('addonsSection');
            const addonsList = document.getElementById('addonsList');
            const addonsCost = document.getElementById('addonsCost');
            
            const pricing = {
                'free': { name: 'Free Listing', cost: 0 },
                'starter': { name: 'Starter Plan', cost: 15 },
                'professional': { name: 'Professional Plan', cost: 29 }
            };
            
            const plan = pricing[tier];
            
            if (plan) {
                planName.textContent = plan.name;
                monthlyCost.textContent = plan.cost > 0 ? `£${plan.cost}/month` : 'Free';
                
                // Calculate add-ons
                const selectedAddons = getSelectedAddons();
                const addonsTotal = calculateAddonsTotal(selectedAddons);
                
                // Show/hide add-ons section
                if (selectedAddons.length > 0) {
                    addonsSection.style.display = 'block';
                    addonsList.textContent = selectedAddons.map(addon => addon.name).join(', ');
                    addonsCost.textContent = `£${addonsTotal}/month`;
                } else {
                    addonsSection.style.display = 'none';
                }
                
                // Calculate totals
                const totalCost = plan.cost + addonsTotal;
                const recurringTotal = plan.cost + addonsTotal;
                
                totalToday.textContent = totalCost > 0 ? `£${totalCost}` : 'Free';
                recurringMonthly.textContent = recurringTotal > 0 ? `£${recurringTotal}/month` : 'Free';
            }
        }
        
        function getSelectedAddons() {
            const selectedAddons = [];
            
            // Check SMS add-on
            const smsSelected = sessionStorage.getItem('smsAddonSelected') === 'true';
            if (smsSelected) {
                selectedAddons.push({
                    name: 'Extra SMS Credits',
                    cost: 3
                });
            }
            
            // Check featured add-on
            const featuredSelected = sessionStorage.getItem('featuredAddonSelected') === 'true';
            if (featuredSelected) {
                selectedAddons.push({
                    name: 'Featured Listing',
                    cost: 5
                });
            }
            
            // Check social add-on
            const socialSelected = sessionStorage.getItem('socialAddonSelected') === 'true';
            if (socialSelected) {
                selectedAddons.push({
                    name: 'Instagram/TikTok Widget',
                    cost: 4
                });
            }
            
            // Check loyalty add-on
            const loyaltySelected = sessionStorage.getItem('loyaltyAddonSelected') === 'true';
            if (loyaltySelected) {
                selectedAddons.push({
                    name: 'Customer Loyalty Rewards',
                    cost: 5
                });
            }
            
            // Check analytics add-on
            const analyticsSelected = sessionStorage.getItem('analyticsAddonSelected') === 'true';
            if (analyticsSelected) {
                selectedAddons.push({
                    name: 'Advanced Analytics',
                    cost: 5
                });
            }
            
            // Check staff add-on
            const staffSelected = sessionStorage.getItem('staffAddonSelected') === 'true';
            if (staffSelected) {
                selectedAddons.push({
                    name: 'Multi-Staff Scheduling',
                    cost: 2
                });
            }
            
            return selectedAddons;
        }
        
        function calculateAddonsTotal(addons) {
            return addons.reduce((total, addon) => total + addon.cost, 0);
        }
        
        function calculateMonthlyCost(tier) {
            const pricing = {
                'free': 0,
                'starter': 15,
                'professional': 29
            };
            return pricing[tier] || 0;
        }
        
        function addPaymentFieldsToValidation() {
            // Add payment fields to form validator
            formValidator.addPaymentFieldsToValidation();
            
            // Add event listeners for payment field formatting
            formValidator.paymentFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) {
                    field.addEventListener('input', formatPaymentField);
                    field.addEventListener('focus', () => formValidator.clearFieldValidation(field));
                }
            });
        }
        
        function removePaymentFieldsFromValidation() {
            // Remove payment fields from form validator
            formValidator.removePaymentFieldsFromValidation();
            
            // Clear payment fields when hidden
            formValidator.paymentFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) {
                    field.value = '';
                }
            });
        }
        
        function formatPaymentField(event) {
            const field = event.target;
            const value = field.value;
            
            switch (field.id) {
                case 'cardNumber':
                    // Format card number with spaces
                    const cardNumber = value.replace(/\s/g, '').replace(/(.{4})/g, '$1 ').trim();
                    field.value = cardNumber;
                    break;
                    
                case 'expiryDate':
                    // Format expiry date as MM/YY
                    const expiry = value.replace(/\D/g, '');
                    if (expiry.length >= 2) {
                        field.value = expiry.substring(0, 2) + '/' + expiry.substring(2, 4);
                    } else {
                        field.value = expiry;
                    }
                    break;
                    
                case 'cvv':
                    // Only allow numbers for CVV
                    field.value = value.replace(/\D/g, '');
                    break;
            }
        }
        
        // Select loyalty add-on function
        function selectLoyaltyAddon() {
            const button = document.getElementById('loyaltyAddonBtn');
            
            // Check if already added
            if (button.classList.contains('added')) {
                // Remove add-on
                const confirmed = confirm('Remove Loyalty Rewards Programme from your plan?\n\nThis will remove £5/month from your subscription.');
                
                if (confirmed) {
                    // Update button state
                    button.innerHTML = '<i class="fas fa-plus"></i> Add to Plan';
                    button.classList.remove('added');
                    
                    // Remove from session storage
                    sessionStorage.removeItem('loyaltyAddonSelected');
                    
                    // Update payment summary and toggle payment section
                    updatePaymentSummary(selectedTier);
                    togglePaymentSection(selectedTier);
                    
                    alert('Loyalty Rewards Programme removed from your plan.');
                }
                return;
            }
            
            // Show confirmation
            const confirmed = confirm('Add Loyalty Rewards Programme to your plan?\n\nThis will add £5/month to your subscription.\n\nYou can manage this add-on in your business dashboard.');
            
            if (confirmed) {
                // Update button state
                button.innerHTML = '<i class="fas fa-check"></i> Added to Plan';
                button.classList.add('added');
                
                // Store selection in session storage
                sessionStorage.setItem('loyaltyAddonSelected', 'true');
                
                // Update payment summary and toggle payment section
                updatePaymentSummary(selectedTier);
                togglePaymentSection(selectedTier);
                
                alert('Customer Loyalty Rewards added successfully!\n\nYou can configure your loyalty program after creating your business listing.');
            }
        }
        
        // SMS Add-on function
        function selectSMSAddon() {
            const button = document.getElementById('smsAddonBtn');
            
            if (button.classList.contains('added')) {
                const confirmed = confirm('Remove Extra SMS Credits from your plan?\n\nThis will remove £3 per 50 messages from your subscription.');
                
                if (confirmed) {
                    button.innerHTML = '<i class="fas fa-plus"></i> Add to Plan';
                    button.classList.remove('added');
                    sessionStorage.removeItem('smsAddonSelected');
                    updatePaymentSummary(selectedTier);
                    togglePaymentSection(selectedTier);
                    alert('Extra SMS Credits removed from your plan.');
                }
                return;
            }
            
            const confirmed = confirm('Add Extra SMS Credits to your plan?\n\nThis will add £3 per 50 messages to your subscription.\n\nYou can manage this add-on in your business dashboard.');
            
            if (confirmed) {
                button.innerHTML = '<i class="fas fa-check"></i> Added to Plan';
                button.classList.add('added');
                sessionStorage.setItem('smsAddonSelected', 'true');
                updatePaymentSummary(selectedTier);
                togglePaymentSection(selectedTier);
                alert('Extra SMS Credits added successfully!\n\nYou can configure your SMS settings after creating your business listing.');
            }
        }
        
        // Featured Add-on function
        function selectFeaturedAddon() {
            const button = document.getElementById('featuredAddonBtn');
            
            if (button.classList.contains('added')) {
                const confirmed = confirm('Remove Featured Listing from your plan?\n\nThis will remove £5/month from your subscription.');
                
                if (confirmed) {
                    button.innerHTML = '<i class="fas fa-plus"></i> Add to Plan';
                    button.classList.remove('added');
                    sessionStorage.removeItem('featuredAddonSelected');
                    updatePaymentSummary(selectedTier);
                    togglePaymentSection(selectedTier);
                    alert('Featured Listing removed from your plan.');
                }
                return;
            }
            
            const confirmed = confirm('Add Featured Listing to your plan?\n\nThis will add £5/month to your subscription.\n\nYou can manage this add-on in your business dashboard.');
            
            if (confirmed) {
                button.innerHTML = '<i class="fas fa-check"></i> Added to Plan';
                button.classList.add('added');
                sessionStorage.setItem('featuredAddonSelected', 'true');
                updatePaymentSummary(selectedTier);
                togglePaymentSection(selectedTier);
                alert('Featured Listing added successfully!\n\nYour business will get priority placement in search results.');
            }
        }
        
        // Social Add-on function
        function selectSocialAddon() {
            const button = document.getElementById('socialAddonBtn');
            
            if (button.classList.contains('added')) {
                const confirmed = confirm('Remove Instagram/TikTok Widget from your plan?\n\nThis will remove £4/month from your subscription.');
                
                if (confirmed) {
                    button.innerHTML = '<i class="fas fa-plus"></i> Add to Plan';
                    button.classList.remove('added');
                    sessionStorage.removeItem('socialAddonSelected');
                    updatePaymentSummary(selectedTier);
                    togglePaymentSection(selectedTier);
                    alert('Instagram/TikTok Widget removed from your plan.');
                }
                return;
            }
            
            const confirmed = confirm('Add Instagram/TikTok Widget to your plan?\n\nThis will add £4/month to your subscription.\n\nYou can manage this add-on in your business dashboard.');
            
            if (confirmed) {
                button.innerHTML = '<i class="fas fa-check"></i> Added to Plan';
                button.classList.add('added');
                sessionStorage.setItem('socialAddonSelected', 'true');
                updatePaymentSummary(selectedTier);
                togglePaymentSection(selectedTier);
                alert('Instagram/TikTok Widget added successfully!\n\nYou can configure your social media integration after creating your business listing.');
            }
        }
        
        // Analytics Add-on function
        function selectAnalyticsAddon() {
            const button = document.getElementById('analyticsAddonBtn');
            
            if (button.classList.contains('added')) {
                const confirmed = confirm('Remove Advanced Analytics from your plan?\n\nThis will remove £5/month from your subscription.');
                
                if (confirmed) {
                    button.innerHTML = '<i class="fas fa-plus"></i> Add to Plan';
                    button.classList.remove('added');
                    sessionStorage.removeItem('analyticsAddonSelected');
                    updatePaymentSummary(selectedTier);
                    togglePaymentSection(selectedTier);
                    alert('Advanced Analytics removed from your plan.');
                }
                return;
            }
            
            const confirmed = confirm('Add Advanced Analytics to your plan?\n\nThis will add £5/month to your subscription.\n\nYou can manage this add-on in your business dashboard.');
            
            if (confirmed) {
                button.innerHTML = '<i class="fas fa-check"></i> Added to Plan';
                button.classList.add('added');
                sessionStorage.setItem('analyticsAddonSelected', 'true');
                updatePaymentSummary(selectedTier);
                togglePaymentSection(selectedTier);
                alert('Advanced Analytics added successfully!\n\nYou can access detailed performance insights after creating your business listing.');
            }
        }
        
        // Staff Add-on function
        function selectStaffAddon() {
            const button = document.getElementById('staffAddonBtn');
            
            if (button.classList.contains('added')) {
                const confirmed = confirm('Remove Multi-Staff Scheduling from your plan?\n\nThis will remove £2/month per staff member from your subscription.');
                
                if (confirmed) {
                    button.innerHTML = '<i class="fas fa-plus"></i> Add to Plan';
                    button.classList.remove('added');
                    sessionStorage.removeItem('staffAddonSelected');
                    updatePaymentSummary(selectedTier);
                    togglePaymentSection(selectedTier);
                    alert('Multi-Staff Scheduling removed from your plan.');
                }
                return;
            }
            
            const confirmed = confirm('Add Multi-Staff Scheduling to your plan?\n\nThis will add £2/month per staff member to your subscription.\n\nYou can manage this add-on in your business dashboard.');
            
            if (confirmed) {
                button.innerHTML = '<i class="fas fa-check"></i> Added to Plan';
                button.classList.add('added');
                sessionStorage.setItem('staffAddonSelected', 'true');
                updatePaymentSummary(selectedTier);
                togglePaymentSection(selectedTier);
                alert('Multi-Staff Scheduling added successfully!\n\nYou can configure staff schedules after creating your business listing.');
            }
        }
    </script>
</body>
</html>
