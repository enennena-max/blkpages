<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>List Your Business - BLKPAGES</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; line-height: 1.6; color: #ffffff; background: linear-gradient(135deg, #2A2A2A 0%, #1A1A1A 50%, #0F0F0F 100%); min-height: 100vh; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        
        /* Navigation */
        .navbar { background: rgba(0, 0, 0, 0.95); box-shadow: 0 2px 10px rgba(255,255,255,0.1); position: fixed; top: 0; width: 100%; z-index: 1000; }
        .nav-wrapper { display: flex; justify-content: space-between; align-items: center; padding: 1.5rem 0; }
        .logo { font-size: 1.8rem; font-weight: 700; color: #ffffff; text-decoration: none; }
        .nav-links { display: flex; list-style: none; gap: 2rem; }
        .nav-links a { text-decoration: none; color: #ffffff; font-weight: 500; transition: color 0.3s; }
        .nav-links a:hover, .nav-links a.active { color: #007bff; }
        .btn-nav { background: #007bff; color: white !important; padding: 0.5rem 1.5rem; border-radius: 25px; transition: background 0.3s; text-decoration: none; }
        .btn-nav:hover { background: #0056b3; }
        
        /* Main Content */
        .main-content { padding: 120px 0 80px; }
        .page-title { font-size: 3rem; font-weight: 700; margin-bottom: 1rem; text-align: center; color: #ffffff; }
        .page-subtitle { text-align: center; color: #cccccc; margin-bottom: 3rem; font-size: 1.1rem; }
        
        /* Registration Form */
        .registration-container { display: grid; grid-template-columns: 1fr 1fr; gap: 4rem; }
        .registration-form { background: #1a1a1a; padding: 3rem; border-radius: 15px; border: 1px solid #333; }
        .registration-form h2 { font-size: 2rem; font-weight: 600; margin-bottom: 2rem; color: #ffffff; }
        .form-section { margin-bottom: 2rem; }
        .form-section h3 { font-size: 1.3rem; font-weight: 600; margin-bottom: 1rem; color: #ffffff; }
        .form-group { margin-bottom: 1.5rem; }
        .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 500; color: #ffffff; }
        .form-group input, .form-group select, .form-group textarea { 
            width: 100%; 
            padding: 0.75rem; 
            border: 2px solid #333; 
            border-radius: 8px; 
            font-size: 1rem; 
            background: #2a2a2a; 
            color: #ffffff; 
            font-family: inherit;
        }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #007bff;
        }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        .required { color: #ff6b6b; }
        .form-help { color: #888; font-size: 0.9rem; margin-top: 0.5rem; }
        
        /* Policy Preview Styles */
        .policy-preview {
            background: #1a1a1a;
            border: 1px solid #374151;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }
        
        .policy-preview h4 {
            color: #ffffff;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
        }
        
        .policy-content {
            background: #111111;
            border: 1px solid #374151;
            border-radius: 6px;
            padding: 1rem;
            color: #e5e7eb;
            font-size: 0.9rem;
            line-height: 1.5;
            white-space: pre-line;
        }
        
        .custom-policy-editor {
            margin-top: 1rem;
            padding: 1rem;
            background: #1a1a1a;
            border: 1px solid #374151;
            border-radius: 8px;
        }
        
        .custom-policy-editor label {
            color: #ffffff;
            font-weight: 500;
            margin-bottom: 0.5rem;
            display: block;
        }
        
        .custom-policy-editor textarea {
            background: #111111;
            border: 1px solid #374151;
            color: #e5e7eb;
            font-family: inherit;
        }
        
        /* Payment Model Styles */
        .payment-preview {
            background: #1a1a1a;
            border: 1px solid #374151;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }
        
        .payment-preview h4 {
            color: #FF3CAC;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
        }
        
        .preview-content {
            background: #111111;
            border: 1px solid #374151;
            border-radius: 6px;
            padding: 1rem;
            color: #e5e7eb;
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        /* Subscription Tiers */
        .subscription-section { background: #1a1a1a; padding: 3rem; border-radius: 15px; border: 1px solid #333; height: fit-content; }
        .subscription-section h2 { font-size: 2rem; font-weight: 600; margin-bottom: 2rem; color: #ffffff; }
        .subscription-tiers { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); 
            gap: 1.5rem; 
        }
        .tier-card { 
            background: #2a2a2a; 
            padding: 2rem; 
            border-radius: 10px; 
            border: 2px solid #333; 
            cursor: pointer; 
            transition: all 0.3s;
            position: relative;
        }
        .tier-card:hover { border-color: #007bff; }
        .tier-card.selected { border-color: #007bff; background: #1a3a5c; }
        .tier-card { transition: all 0.3s ease; }
        .subscription-tiers { transition: all 0.3s ease; }
        
        /* Visual indicator for selected plan at top */
        .tier-card.selected::after {
            content: "✓ Selected";
            position: absolute;
            top: 10px;
            right: 10px;
            background: #007bff;
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        .tier-card.popular { border-color: #ff6b35; }
        .tier-card.popular::before {
            content: "Most Popular";
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            background: #ff6b35;
            color: white;
            padding: 0.3rem 1rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        .tier-header { text-align: center; margin-bottom: 1.5rem; }
        .tier-name { font-size: 1.3rem; font-weight: 600; color: #ffffff; margin-bottom: 0.5rem; }
        .tier-price { font-size: 2rem; font-weight: 700; color: #007bff; margin-bottom: 0.5rem; }
        .tier-period { color: #888; font-size: 0.9rem; }
        .tier-features { list-style: none; }
        .tier-features li { 
            padding: 0.5rem 0; 
            color: #cccccc; 
            border-bottom: 1px solid #333; 
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .tier-features li:last-child { border-bottom: none; }
        .tier-features li i { color: #10B981; }
        .tier-features li.unavailable { color: #666; }
        .tier-features li.unavailable i { color: #666; }
        
        /* Buttons */
        .btn-submit { 
            background: #007bff; 
            color: white; 
            border: none; 
            padding: 1rem 2rem; 
            border-radius: 25px; 
            cursor: pointer; 
            font-weight: 600; 
            font-size: 1.1rem;
            width: 100%;
            margin-top: 2rem;
            transition: background 0.3s;
        }
        .btn-submit:hover { background: #0056b3; }
        .btn-submit:disabled { background: #333; cursor: not-allowed; }
        
        /* Terms */
        .terms-section { margin-top: 2rem; padding-top: 2rem; border-top: 1px solid #333; }
        .terms-section p { color: #888; font-size: 0.9rem; line-height: 1.5; }
        .terms-section a { color: #007bff; text-decoration: none; }
        .terms-section a:hover { text-decoration: underline; }
        
        /* Footer */
        .footer { background: #222; color: white; padding: 40px 0; text-align: center; }
        
        @media (max-width: 768px) {
            .nav-links { display: none; }
            .page-title { font-size: 2rem; }
            .registration-container { grid-template-columns: 1fr; gap: 2rem; }
            .form-row { grid-template-columns: 1fr; }
            .subscription-tiers { grid-template-columns: 1fr; }
            .tier-card { margin-bottom: 1rem; }
            
            /* Ensure selected plan indicator is visible on mobile */
            .tier-card.selected::after {
                font-size: 0.7rem;
                padding: 0.2rem 0.6rem;
                top: 8px;
                right: 8px;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-wrapper">
                <a href="index.html" class="logo">BLKPAGES</a>
                <ul class="nav-links">
                    <li><a href="directory.html">Directory</a></li>
                    <li><a href="search.html">Search</a></li>
                    <li><a href="business-login.html">Business Login</a></li>
                    <li><a href="contact.html">Contact</a></li>
                </ul>
                <a href="business-login.html" class="btn-nav">Business Login</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <h1 class="page-title">List Your Business</h1>
            <p class="page-subtitle">Join the BLKPAGES community and connect with customers in your area</p>
            
            <div class="registration-container">
                <!-- Registration Form -->
                <div class="registration-form">
                    <h2>Business Information</h2>
                    <form id="businessRegistrationForm">
                        <!-- Business Details -->
                        <div class="form-section">
                            <h3>Business Details</h3>
                            <div class="form-group">
                                <label for="businessName">Business Name <span class="required">*</span></label>
                                <input type="text" id="businessName" name="businessName" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="category">Category <span class="required">*</span></label>
                                <select id="category" name="category" required>
                                    <option value="">Select Category</option>
                                    <option value="hairdresser">Hairdresser</option>
                                    <option value="barber">Barber</option>
                                    <option value="beauty">Beauty Services</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="description">Business Description <span class="required">*</span></label>
                                <textarea id="description" name="description" rows="4" required placeholder="Tell customers about your business, services, and what makes you special..."></textarea>
                                <div class="form-help">Describe your services, specialties, and what customers can expect.</div>
                            </div>
                        </div>
                        
                        <!-- Contact Information -->
                        <div class="form-section">
                            <h3>Contact Information</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="phone">Phone Number <span class="required">*</span></label>
                                    <input type="tel" id="phone" name="phone" pattern="(\+44\s?7\d{3}|\(?07\d{3}\)?)\s?\d{3}\s?\d{3}" placeholder="+44 7123 456789 or 07123 456789" required>
                                </div>
                                <div class="form-group">
                                    <label for="email">Email Address <span class="required">*</span></label>
                                    <input type="email" id="email" name="email" required>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="website">Website (Optional)</label>
                                <input type="url" id="website" name="website" placeholder="https://yourwebsite.com">
                            </div>
                        </div>
                        
                        <!-- Location -->
                        <div class="form-section">
                            <h3>Location</h3>
                            <div class="form-group">
                                <label for="address">Street Address <span class="required">*</span></label>
                                <input type="text" id="address" name="address" required>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="city">City <span class="required">*</span></label>
                                    <input type="text" id="city" name="city" required>
                                </div>
                                <div class="form-group">
                                    <label for="state">County <span class="required">*</span></label>
                                    <input type="text" id="state" name="state" required>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="zipCode">Postcode <span class="required">*</span></label>
                                    <input type="text" id="zipCode" name="zipCode" pattern="[A-Za-z]{1,2}[0-9Rr][0-9A-Za-z]? [0-9][ABD-HJLNP-UW-Zabd-hjlnp-uw-z]{2}" placeholder="e.g., SW1A 1AA" required>
                                </div>
                                <div class="form-group">
                                    <label for="serviceArea">Service Area</label>
                                    <input type="text" id="serviceArea" name="serviceArea" placeholder="e.g., 10 miles radius">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Business Hours -->
                        <div class="form-section">
                            <h3>Business Hours</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="hoursStart">Opening Time</label>
                                    <input type="time" id="hoursStart" name="hoursStart">
                                </div>
                                <div class="form-group">
                                    <label for="hoursEnd">Closing Time</label>
                                    <input type="time" id="hoursEnd" name="hoursEnd">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="daysOpen">Days Open</label>
                                <select id="daysOpen" name="daysOpen" multiple>
                                    <option value="monday">Monday</option>
                                    <option value="tuesday">Tuesday</option>
                                    <option value="wednesday">Wednesday</option>
                                    <option value="thursday">Thursday</option>
                                    <option value="friday">Friday</option>
                                    <option value="saturday">Saturday</option>
                                    <option value="sunday">Sunday</option>
                                </select>
                                <div class="form-help">Hold Ctrl/Cmd to select multiple days</div>
                            </div>
                        </div>
                        
                        <!-- Booking Policies -->
                        <div class="form-section">
                            <h3>Booking Policies</h3>
                            
                            <!-- Cancellation Policy -->
                            <div class="form-group">
                                <label for="cancellationPolicy">Cancellation Policy <span class="required">*</span></label>
                                <select id="cancellationPolicy" name="cancellationPolicy" required onchange="updateCancellationPreview()">
                                    <option value="">Select Policy</option>
                                    <option value="flexible">Flexible</option>
                                    <option value="moderate">Moderate</option>
                                    <option value="strict">Strict</option>
                                    <option value="custom" id="customOption" style="display: none;">Custom (Premium Only)</option>
                                </select>
                                <div class="form-help">Choose a cancellation policy that works for your business.</div>
                            </div>
                            
                            <!-- Policy Preview -->
                            <div id="policyPreview" class="policy-preview" style="display: none;">
                                <h4>Policy Preview</h4>
                                <div class="policy-content" id="policyContent"></div>
                            </div>
                            
                            <!-- Custom Policy Editor (Premium Only) -->
                            <div id="customPolicyEditor" class="custom-policy-editor" style="display: none;">
                                <label for="customPolicyText">Custom Policy Text</label>
                                <textarea id="customPolicyText" name="customPolicyText" rows="6" placeholder="Enter your custom cancellation policy..."></textarea>
                                <div class="form-help">You can customize the policy text. Use [Business Name] to insert your business name automatically.</div>
                            </div>
                            
                            <div class="form-group">
                                <label for="bookingNotes">Additional Booking Information</label>
                                <textarea id="bookingNotes" name="bookingNotes" rows="3" placeholder="Any additional information customers should know when booking (e.g., arrival time, what to bring, special requirements)"></textarea>
                                <div class="form-help">Optional: Additional information to help customers prepare for their appointment.</div>
                            </div>
                        </div>
                        
                        <!-- Payment Model -->
                        <div class="form-section">
                            <h3>Payment Model</h3>
                            <div class="form-group">
                                <label for="paymentModel">Payment Model <span class="required">*</span></label>
                                <select id="paymentModel" name="paymentModel" required onchange="updatePaymentModel()">
                                    <option value="">Select Payment Model</option>
                                    <option value="full-online">Full Payment Online</option>
                                    <option value="deposit-balance">Deposit Online + Balance at Venue</option>
                                    <option value="full-venue">Full Payment at Venue</option>
                                </select>
                                <div class="form-help">Choose how customers will pay for your services. This cannot be changed after setup.</div>
                            </div>
                            
                            <!-- Deposit Percentage (only shown for deposit + balance option) -->
                            <div class="form-group" id="depositPercentageGroup" style="display: none;">
                                <label for="depositPercentage">Deposit Percentage <span class="required">*</span></label>
                                <select id="depositPercentage" name="depositPercentage">
                                    <option value="">Select Deposit Percentage</option>
                                    <option value="10">10%</option>
                                    <option value="20">20%</option>
                                    <option value="30">30%</option>
                                    <option value="40">40%</option>
                                    <option value="50">50%</option>
                                </select>
                                <div class="form-help">Choose what percentage customers will pay as a deposit online.</div>
                            </div>
                            
                            <!-- Payment Model Preview -->
                            <div class="payment-preview" id="paymentPreview" style="display: none;">
                                <h4>Payment Model Preview</h4>
                                <div class="preview-content" id="paymentPreviewContent">
                                    <!-- Preview content will be populated by JavaScript -->
                                </div>
                            </div>
                        </div>
                        
                        <!-- Account Information -->
                        <div class="form-section">
                            <h3>Account Information</h3>
                            <div class="form-group">
                                <label for="ownerName">Owner/Manager Name <span class="required">*</span></label>
                                <input type="text" id="ownerName" name="ownerName" required>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="password">Password <span class="required">*</span></label>
                                    <input type="password" id="password" name="password" required>
                                </div>
                                <div class="form-group">
                                    <label for="confirmPassword">Confirm Password <span class="required">*</span></label>
                                    <input type="password" id="confirmPassword" name="confirmPassword" required>
                                </div>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn-submit" id="submitBtn">Create Business Listing</button>
                    </form>
                </div>
                
                <!-- Subscription Tiers -->
                <div class="subscription-section">
                    <h2>Choose Your Plan</h2>
                    <div class="subscription-tiers">
                        <!-- Free Tier -->
                        <div class="tier-card" data-tier="free" onclick="selectTier('free')">
                            <div class="tier-header">
                                <div class="tier-name">Free Listing</div>
                                <div class="tier-price">£0</div>
                                <div class="tier-period">Forever</div>
                            </div>
                            <ul class="tier-features">
                                <li><i class="fas fa-check"></i> Business name & contact</li>
                                <li><i class="fas fa-check"></i> Basic address</li>
                                <li><i class="fas fa-check"></i> Phone number</li>
                                <li><i class="fas fa-check"></i> Category listing</li>
                                <li><i class="fas fa-times unavailable"></i> Customer reviews</li>
                                <li><i class="fas fa-times unavailable"></i> Business logo</li>
                                <li><i class="fas fa-times unavailable"></i> Photo gallery</li>
                                <li><i class="fas fa-times unavailable"></i> Online booking</li>
                            </ul>
                        </div>
                        
                        <!-- Starter Tier -->
                        <div class="tier-card" data-tier="starter" onclick="selectTier('starter')">
                            <div class="tier-header">
                                <div class="tier-name">Starter</div>
                                <div class="tier-price">£15</div>
                                <div class="tier-period">per month</div>
                            </div>
                            <ul class="tier-features">
                                <li><i class="fas fa-check"></i> Everything in Free</li>
                                <li><i class="fas fa-check"></i> Business logo and photo gallery (up to 3 photos)</li>
                                <li><i class="fas fa-check"></i> Enhanced profile visibility</li>
                                <li><i class="fas fa-check"></i> Customer review highlights</li>
                                <li><i class="fas fa-check"></i> Basic booking system</li>
                                <li><i class="fas fa-times unavailable"></i> Advanced booking system with calendar sync</li>
                                <li><i class="fas fa-times unavailable"></i> Customer management dashboard</li>
                                <li><i class="fas fa-times unavailable"></i> Priority placement in search</li>
                            </ul>
                        </div>

                        <!-- Professional Tier -->
                        <div class="tier-card popular" data-tier="professional" onclick="selectTier('professional')">
                            <div class="tier-header">
                                <div class="tier-name">Professional</div>
                                <div class="tier-price">£29</div>
                                <div class="tier-period">per month</div>
                            </div>
                            <ul class="tier-features">
                                <li><i class="fas fa-check"></i> Everything in Starter</li>
                                <li><i class="fas fa-check"></i> Photo gallery (up to 10 photos)</li>
                                <li><i class="fas fa-check"></i> Advanced booking system with calendar sync</li>
                                <li><i class="fas fa-check"></i> Customer management dashboard</li>
                                <li><i class="fas fa-check"></i> Priority placement in search</li>
                                <li><i class="fas fa-check"></i> Basic analytics</li>
                                <li><i class="fas fa-times unavailable"></i> Advanced analytics (performance trends)</li>
                                <li><i class="fas fa-times unavailable"></i> Marketing tools</li>
                            </ul>
                        </div>

                    </div>
                    
                    <div class="terms-section">
                        <p>By creating a listing, you agree to our <a href="terms.html">Terms of Service</a> and <a href="privacy.html">Privacy Policy</a>.</p>
                        <p>You can upgrade or downgrade your plan at any time from your business dashboard.</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 2rem;">
                <div>
                    <p>&copy; 2024 BLKPAGES. All rights reserved.</p>
                </div>
                <div style="display: flex; gap: 2rem; flex-wrap: wrap;">
                    <a href="about.html" style="color: #ffffff; text-decoration: none;">About Us</a>
                    <a href="contact.html" style="color: #ffffff; text-decoration: none;">Contact Us</a>
                    <a href="privacy.html" style="color: #ffffff; text-decoration: none;">Privacy Policy</a>
                    <a href="terms.html" style="color: #ffffff; text-decoration: none;">Terms & Conditions</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        let selectedTier = 'free';
        
        function selectTier(tier) {
            selectedTier = tier;
            document.querySelectorAll('.tier-card').forEach(card => card.classList.remove('selected'));
            document.querySelector(`[data-tier="${tier}"]`).classList.add('selected');
            
            // Store selection in session storage
            sessionStorage.setItem('selectedPlan', tier);
            
            // Reorder plans to put selected plan at the top
            reorderPlans(tier);
        }
        
        function reorderPlans(selectedTier) {
            const subscriptionTiers = document.querySelector('.subscription-tiers');
            const selectedCard = document.querySelector(`[data-tier="${selectedTier}"]`);
            const allCards = Array.from(document.querySelectorAll('.tier-card'));
            
            // Remove the selected card from its current position
            selectedCard.remove();
            
            // Insert the selected card at the top
            subscriptionTiers.insertBefore(selectedCard, subscriptionTiers.firstChild);
            
            // Add smooth transition
            selectedCard.style.transition = 'all 0.3s ease';
        }
        
        // Cancellation Policy Templates
        const cancellationTemplates = {
            flexible: `[Business Name] – Cancellation Policy:
You may cancel your booking up to 24 hours before your appointment for a full refund.
Cancellations made within 24 hours and no-shows will be charged 100% of the service price.
Refunds are returned to your original payment method within 5–10 business days.`,
            
            moderate: `[Business Name] – Cancellation Policy:
You may cancel your booking up to 48 hours before your appointment for a full refund.
Cancellations made within 48 hours will be charged 50% of the service price.
No-shows will be charged 100% of the service price.
Refunds are returned to your original payment method within 5–10 business days.`,
            
            strict: `[Business Name] – Cancellation Policy:
This booking is non-refundable once confirmed.
No-shows will be charged 100% of the service price.
Refunds are returned to your original payment method within 5–10 business days.`,
            
            custom: `[Business Name] – Cancellation Policy:
Cancellations: You may cancel your appointment up to [X hours/days] before the scheduled time for a full refund.
Late Cancellations: Cancellations made within [X hours/days] will be charged [X%] of the service price.
No-Shows: If you do not attend your appointment without notice, you will be charged [100%] of the service price.
Refunds: Refunds (where applicable) will be processed back to your original payment method within [X working days].`
        };
        
        // Update cancellation policy preview
        function updateCancellationPreview() {
            const policySelect = document.getElementById('cancellationPolicy');
            const policyPreview = document.getElementById('policyPreview');
            const policyContent = document.getElementById('policyContent');
            const customEditor = document.getElementById('customPolicyEditor');
            const customOption = document.getElementById('customOption');
            const businessName = document.getElementById('businessName').value || '[Business Name]';
            
            if (policySelect.value === '') {
                policyPreview.style.display = 'none';
                customEditor.style.display = 'none';
                return;
            }
            
            // Show custom option for premium tiers
            const selectedTier = document.querySelector('.tier-card.selected')?.getAttribute('data-tier');
            if (selectedTier === 'professional') {
                customOption.style.display = 'block';
            } else {
                customOption.style.display = 'none';
                if (policySelect.value === 'custom') {
                    policySelect.value = '';
                    return;
                }
            }
            
            if (policySelect.value === 'custom') {
                policyPreview.style.display = 'none';
                customEditor.style.display = 'block';
                
                // Pre-fill custom template
                const customText = document.getElementById('customPolicyText');
                if (!customText.value) {
                    customText.value = cancellationTemplates.custom.replace('[Business Name]', businessName);
                }
            } else {
                customEditor.style.display = 'none';
                policyPreview.style.display = 'block';
                
                // Show preview with business name
                const template = cancellationTemplates[policySelect.value];
                policyContent.textContent = template.replace('[Business Name]', businessName);
            }
        }
        
        // Update preview when business name changes
        document.getElementById('businessName').addEventListener('input', function() {
            if (document.getElementById('policyPreview').style.display !== 'none') {
                updateCancellationPreview();
            }
        });
        
        // Payment Model Functions
        function updatePaymentModel() {
            const paymentModel = document.getElementById('paymentModel').value;
            const depositGroup = document.getElementById('depositPercentageGroup');
            const paymentPreview = document.getElementById('paymentPreview');
            const previewContent = document.getElementById('paymentPreviewContent');
            
            if (paymentModel === '') {
                depositGroup.style.display = 'none';
                paymentPreview.style.display = 'none';
                return;
            }
            
            if (paymentModel === 'deposit-balance') {
                depositGroup.style.display = 'block';
                document.getElementById('depositPercentage').required = true;
            } else {
                depositGroup.style.display = 'none';
                document.getElementById('depositPercentage').required = false;
            }
            
            // Show preview
            paymentPreview.style.display = 'block';
            
            // Update preview content based on selected model
            const businessName = document.getElementById('businessName').value || '[Business Name]';
            const depositPercentage = document.getElementById('depositPercentage').value;
            
            let previewText = '';
            
            switch (paymentModel) {
                case 'full-online':
                    previewText = `Full Payment Online:
• Customers pay the full service price online at booking
• No additional payment required at the venue
• Example: "Full payment of £70 due now."`;
                    break;
                    
                case 'deposit-balance':
                    if (depositPercentage) {
                        const depositAmount = Math.round(70 * (depositPercentage / 100)); // Using £70 as example
                        const balanceAmount = 70 - depositAmount;
                        previewText = `Deposit Online + Balance at Venue:
• Customers pay ${depositPercentage}% deposit online (£${depositAmount})
• Remaining balance (£${balanceAmount}) paid at the venue
• Example: "Pay £${depositAmount} now (${depositPercentage}%), balance £${balanceAmount} at the venue."`;
                    } else {
                        previewText = `Deposit Online + Balance at Venue:
• Customers pay a percentage deposit online
• Remaining balance paid at the venue
• Select deposit percentage above to see example`;
                    }
                    break;
                    
                case 'full-venue':
                    previewText = `Full Payment at Venue:
• No payment required online at booking
• Full service price paid directly at the venue
• Example: "No payment due now. Full balance of £70 payable at the venue."`;
                    break;
            }
            
            previewContent.textContent = previewText;
        }
        
        // Update preview when deposit percentage changes
        document.getElementById('depositPercentage').addEventListener('change', function() {
            if (document.getElementById('paymentModel').value === 'deposit-balance') {
                updatePaymentModel();
            }
        });
        
        // Form validation
        document.getElementById('businessRegistrationForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Validate passwords match
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (password !== confirmPassword) {
                alert('Passwords do not match!');
                return;
            }
            
            // Validate required fields
            const requiredFields = ['businessName', 'category', 'description', 'phone', 'email', 'address', 'city', 'state', 'zipCode', 'cancellationPolicy', 'ownerName', 'password'];
            let isValid = true;
            
            // Validate UK postcode format
            const postcode = document.getElementById('zipCode').value;
            const ukPostcodeRegex = /^[A-Za-z]{1,2}[0-9Rr][0-9A-Za-z]? [0-9][ABD-HJLNP-UW-Zabd-hjlnp-uw-z]{2}$/;
            if (!ukPostcodeRegex.test(postcode)) {
                alert('Please enter a valid UK postcode (e.g., SW1A 1AA, M1 1AA)');
                document.getElementById('zipCode').focus();
                return;
            }
            
            // Validate UK phone number format
            const phone = document.getElementById('phone').value;
            const ukPhoneRegex = /^(\+44\s?7\d{3}|\(?07\d{3}\)?)\s?\d{3}\s?\d{3}$/;
            if (!ukPhoneRegex.test(phone)) {
                alert('Please enter a valid UK phone number (e.g., +44 7123 456789 or 07123 456789)');
                document.getElementById('phone').focus();
                return;
            }
            
            requiredFields.forEach(field => {
                const element = document.getElementById(field);
                if (!element.value.trim()) {
                    isValid = false;
                    element.style.borderColor = '#ff6b6b';
                } else {
                    element.style.borderColor = '#333';
                }
            });
            
            if (!isValid) {
                alert('Please fill in all required fields.');
                return;
            }
            
            // Collect form data
            const formData = {
                businessName: document.getElementById('businessName').value,
                category: document.getElementById('category').value,
                description: document.getElementById('description').value,
                phone: document.getElementById('phone').value,
                email: document.getElementById('email').value,
                website: document.getElementById('website').value,
                address: document.getElementById('address').value,
                city: document.getElementById('city').value,
                state: document.getElementById('state').value,
                zipCode: document.getElementById('zipCode').value,
                serviceArea: document.getElementById('serviceArea').value,
                hoursStart: document.getElementById('hoursStart').value,
                hoursEnd: document.getElementById('hoursEnd').value,
                daysOpen: Array.from(document.getElementById('daysOpen').selectedOptions).map(option => option.value),
                cancellationPolicy: document.getElementById('cancellationPolicy').value,
                customPolicyText: document.getElementById('customPolicyText').value,
                bookingNotes: document.getElementById('bookingNotes').value,
                paymentModel: document.getElementById('paymentModel').value,
                depositPercentage: document.getElementById('depositPercentage').value,
                ownerName: document.getElementById('ownerName').value,
                password: document.getElementById('password').value,
                selectedTier: selectedTier
            };
            
            // Store form data in localStorage for payment page
            localStorage.setItem('businessRegistrationData', JSON.stringify(formData));
            
            // Show loading state
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creating Listing...';
            
            // Simulate form submission
            setTimeout(() => {
                if (selectedTier === 'premium') {
                    // Redirect to payment page
                    alert('Redirecting to payment page for Premium subscription...');
                    window.location.href = 'business-payment.html';
                } else {
                    // Free listing created
                    alert('Your free business listing has been created! You can now log in to manage your profile.');
                    window.location.href = 'business-login.html';
                }
            }, 2000);
        });
        
        // Initialize with selected plan from URL or session storage
        function initializePlanSelection() {
            // Check URL parameters first
            const urlParams = new URLSearchParams(window.location.search);
            const planFromUrl = urlParams.get('plan');
            
            // Check session storage
            const planFromStorage = sessionStorage.getItem('selectedPlan');
            
            // Use URL parameter if available, otherwise use session storage, otherwise default to free
            const selectedPlan = planFromUrl || planFromStorage || 'free';
            
            // Store the selection in session storage
            sessionStorage.setItem('selectedPlan', selectedPlan);
            
            // Select the tier and reorder plans
            selectTier(selectedPlan);
        }
        
        // Initialize plan selection
        initializePlanSelection();
    </script>
</body>
</html>
