<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Royal Hair Studio - BlkPages</title>
    <script src="https://cdn.tailwindcss.com?v=2"></script>
    <script src="js/suppress-tailwind-warning.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- SEO Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "LocalBusiness",
        "name": "Royal Hair Studio",
        "description": "Professional hair salon specializing in natural hair care, styling, and treatments for all hair types.",
        "url": "https://blkpages.com/business/royal-hair-studio",
        "telephone": "+44-20-7123-4567",
        "email": "info@royalhairstudio.com",
        "address": {
            "@type": "PostalAddress",
            "streetAddress": "123 Beauty Street",
            "addressLocality": "London",
            "postalCode": "SW1A 1AA",
            "addressCountry": "GB"
        },
        "geo": {
            "@type": "GeoCoordinates",
            "latitude": "51.5074",
            "longitude": "-0.1278"
        },
        "openingHours": [
            "Mo-Fr 09:00-18:00",
            "Sa 09:00-17:00"
        ],
        "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.8",
            "reviewCount": "127"
        },
        "image": "https://blkpages.com/images/royal-hair-studio-hero.jpg",
        "priceRange": "££",
        "serviceArea": {
            "@type": "GeoCircle",
            "geoMidpoint": {
                "@type": "GeoCoordinates",
                "latitude": "51.5074",
                "longitude": "-0.1278"
            },
            "geoRadius": "5000"
        }
    }
    </script>
    
    <style>
        .list-business-btn:hover{box-shadow:0 0 16px rgba(16,185,129,0.6);}/* green glow */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #121212 0%, #1A1A1A 50%, #0F0F0F 100%);
            min-height: 100vh;
            color: #ffffff;
            padding-bottom: 80px; /* Space for sticky CTA */
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Navigation */
        .navbar {
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(10px);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .nav-wrapper {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            color: #ffffff;
            text-decoration: none;
            background: linear-gradient(135deg, #FF3CAC, #784BA0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
        }
        
        .nav-links a {
            text-decoration: none;
            color: #ffffff;
            font-weight: 500;
            transition: color 0.3s;
        }
        
        .nav-links a:hover {
            color: #FF3CAC;
        }
        
        /* Hero Banner */
        .hero-banner {
            background: linear-gradient(135deg, #1A1A1A 0%, #2A2A2A 100%);
            padding: 2rem;
            border-radius: 20px;
            margin: 120px 0 2rem 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            gap: 2rem;
        }
        
        .business-logo {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, #FF3CAC, #784BA0);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: white; 
            flex-shrink: 0;
        }
        
        .business-info h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, #FF3CAC, #784BA0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .business-category {
            background: linear-gradient(135deg, #FF3CAC, #784BA0);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 25px; 
            font-size: 0.9rem;
            font-weight: 600;
            display: inline-block;
            margin-bottom: 1rem;
        }
        
        .business-rating {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .stars {
            color: #FFD700;
            font-size: 1.2rem;
        }
        
        .rating-text {
            color: #cccccc;
            font-size: 1rem;
        }
        
        .business-description {
            color: #cccccc;
            font-size: 1.1rem;
            line-height: 1.6;
            max-width: 600px;
        }
        
        /* Photo Gallery */
        .photo-gallery {
            margin: 3rem 0;
        }
        
        .gallery-title {
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: #ffffff;
        }
        
        .gallery-container {
            position: relative;
            background: #1A1A1A;
            border-radius: 15px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .gallery-slides {
            display: flex;
            transition: transform 0.5s ease;
        }
        
        .gallery-slide {
            min-width: 100%;
            height: 400px;
            background-size: cover;
            background-position: center;
            position: relative;
        }
        
        .gallery-slide:nth-child(1) { background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 300"><rect width="400" height="300" fill="%23FF3CAC"/><text x="200" y="150" text-anchor="middle" fill="white" font-size="24" font-family="Arial">Salon Interior</text></svg>'); }
        .gallery-slide:nth-child(2) { background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 300"><rect width="400" height="300" fill="%23784BA0"/><text x="200" y="150" text-anchor="middle" fill="white" font-size="24" font-family="Arial">Hair Styling</text></svg>'); }
        .gallery-slide:nth-child(3) { background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 300"><rect width="400" height="300" fill="%232B86C5"/><text x="200" y="150" text-anchor="middle" fill="white" font-size="24" font-family="Arial">Professional Tools</text></svg>'); }
        
        .gallery-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            padding: 1rem;
            cursor: pointer; 
            font-size: 1.5rem;
            transition: background 0.3s;
        }
        
        .gallery-nav:hover {
            background: rgba(0, 0, 0, 0.9);
        }
        
        .gallery-prev {
            left: 0;
        }
        
        .gallery-next {
            right: 0;
        }
        
        .gallery-dots {
            position: absolute;
            bottom: 1rem;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 0.5rem;
        }
        
        .gallery-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            border: none;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .gallery-dot.active {
            background: #FF3CAC;
        }
        
        /* Main Content Grid */
        .content-wrapper {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 3rem;
            margin: 3rem 0;
        }
        
        @media (max-width: 768px) {
            .content-wrapper {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
        }
        
        .content-main {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }
        
        .content-sidebar {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }
        
        /* Cards */
        .card {
            background: #1A1A1A;
            padding: 2rem;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .card h2 {
            font-size: 1.5rem;
            font-weight: 600; 
            margin-bottom: 1.5rem;
            color: #ffffff;
        }
        
        .card h3 {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #FF3CAC;
        }
        
        /* Contact Info with Icons */
        .contact-info {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .contact-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: #2A2A2A;
            border-radius: 10px;
            transition: background 0.3s;
        }
        
        .contact-item:hover {
            background: #333;
        }
        
        .contact-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #FF3CAC, #784BA0);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: white;
            flex-shrink: 0;
        }
        
        .contact-details h4 {
            color: #ffffff;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }
        
        .contact-details p {
            color: #cccccc;
            font-size: 0.9rem;
        }
        
        /* Services Section */
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }
        
        /* Payment Method Info */
        .payment-method-info {
            background: rgba(255, 60, 172, 0.1);
            border: 1px solid rgba(255, 60, 172, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .payment-method-text {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            color: #e5e7eb;
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        .payment-method-text i {
            color: #FF3CAC;
            font-size: 1rem;
            margin-top: 0.1rem;
            flex-shrink: 0;
        }
        
        .payment-method-text strong {
            color: #FF3CAC;
            font-weight: 600;
        }
        
        .service-item {
            background: #2A2A2A;
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .service-item:hover {
            transform: translateY(-5px);
            border-color: #FF3CAC;
            box-shadow: 0 4px 6px rgba(255, 60, 172, 0.2);
        }
        
        .service-info {
            flex: 1;
        }
        
        .add-service-btn {
            background: linear-gradient(135deg, #FF3CAC, #784BA0);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .add-service-btn:hover {
            background: linear-gradient(135deg, #FF1493, #8A2BE2);
            transform: translateY(-1px);
        }
        
        .add-service-btn.selected {
            background: linear-gradient(135deg, #10B981, #059669);
            color: white;
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.4);
        }
        
        .add-service-btn.selected:hover {
            background: linear-gradient(135deg, #059669, #047857);
            transform: translateY(-1px);
        }
        
        .add-service-btn.selected i {
            transform: rotate(45deg);
        }
        
        .selected-services {
            margin-top: 2rem;
            padding: 1.5rem;
            background: #2A2A2A;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .selected-services h3 {
            color: #FF3CAC;
            margin-bottom: 1rem;
        }
        
        .selected-service-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: #1A1A1A;
            border-radius: 8px;
            margin-bottom: 0.5rem;
        }
        
        .selected-service-info {
            flex: 1;
        }
        
        .selected-service-name {
            color: #ffffff;
            font-weight: 600;
        }
        
        .selected-service-price {
            color: #FF3CAC;
            font-weight: 600;
        }
        
        .remove-service-btn {
            background: #666666;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .remove-service-btn:hover {
            background: #ff4444;
        }
        
        .total-price {
            text-align: right;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #ffffff;
            font-size: 1.2rem;
        }
        
        /* Booking Section */
        .booking-section {
            background: linear-gradient(135deg, #121212 0%, #1A1A1A 50%, #0F0F0F 100%);
            padding: 3rem 0;
            margin-top: 2rem;
        }
        
        .booking-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 3rem;
        }
        
        .booking-form {
            background: #1A1A1A;
            border-radius: 12px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }
        
        .booking-sidebar {
            background: #1A1A1A;
            border-radius: 12px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            height: fit-content;
            position: sticky;
            top: 120px;
        }
        
        .booking-form h2 {
            color: #ffffff;
            margin-bottom: 2rem;
            font-size: 1.8rem;
        }
        
        .booking-form h3 {
            color: #FF3CAC;
            margin-bottom: 1.5rem;
            font-size: 1.3rem;
        }
        
        .booking-services, .booking-datetime, .booking-details, .booking-payment, .booking-policies {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: #2A2A2A;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .add-more-btn {
            background: linear-gradient(135deg, #FF3CAC, #784BA0);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .add-more-btn:hover {
            background: linear-gradient(135deg, #FF1493, #8A2BE2);
            transform: translateY(-1px);
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-label {
            display: block;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: #ffffff;
        }
        
        .form-input, .form-textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.3s;
            background: #1A1A1A;
            color: #ffffff;
        }
        
        .form-input:focus, .form-textarea:focus {
            outline: none;
            border-color: #FF3CAC;
            box-shadow: 0 0 0 3px rgba(255, 60, 172, 0.1);
        }
        
        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        .payment-options {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .payment-option {
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            background: #1A1A1A;
        }
        
        .payment-option:hover {
            border-color: #FF3CAC;
            box-shadow: 0 4px 6px rgba(255, 60, 172, 0.2);
        }
        
        .payment-option.selected {
            border-color: #FF3CAC;
            background: linear-gradient(135deg, rgba(255, 60, 172, 0.1), rgba(120, 75, 160, 0.1));
        }
        
        /* Payment Model Info Styles */
        .payment-model-info {
            background: rgba(255, 60, 172, 0.1);
            border: 1px solid rgba(255, 60, 172, 0.3);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .payment-model-info h4 {
            color: #FF3CAC;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .payment-model-info h4::before {
            content: "💳";
            font-size: 1.2rem;
        }
        
        .payment-model-info .payment-details {
            color: #e5e7eb;
            font-size: 0.95rem;
            line-height: 1.6;
        }
        
        .payment-model-info .payment-amount {
            font-size: 1.2rem;
            font-weight: 700;
            color: #ffffff;
            margin: 0.5rem 0;
        }
        
        .payment-model-info .balance-info {
            color: #9CA3AF;
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }
        
        .payment-disclaimer {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            padding: 1rem;
            margin-top: 1rem;
        }
        
        .payment-disclaimer p {
            color: #9CA3AF;
            font-size: 0.85rem;
            line-height: 1.4;
            margin: 0;
        }
        
        .payment-disclaimer strong {
            color: #ffffff;
            font-weight: 600;
        }
        
        .payment-header {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .payment-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #FF3CAC, #784BA0);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }
        
        .payment-title {
            font-weight: 600;
            color: #ffffff;
        }
        
        .payment-description {
            color: #cccccc;
            font-size: 0.9rem;
        }
        
        .policy-checkbox {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .policy-checkbox input {
            width: 18px;
            height: 18px;
        }
        
        .policy-checkbox label {
            font-size: 0.9rem;
            color: #cccccc;
        }
        
        .policy-text {
            font-size: 0.9rem;
            color: #cccccc;
            line-height: 1.5;
        }
        
        .required-terms-checkbox {
            margin-top: 1.5rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .required-label {
            color: #cccccc;
            font-weight: 400;
            font-size: 0.9rem;
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
            cursor: pointer;
            line-height: 1.4;
        }
        
        .required-asterisk {
            color: #FF3CAC;
            font-weight: 600;
        }
        
        .terms-link {
            color: #FF3CAC;
            text-decoration: none;
            font-weight: 500;
        }
        
        .terms-link:hover {
            text-decoration: underline;
        }
        
        .policy-links {
            color: #FF3CAC;
            text-decoration: none;
        }
        
        .policy-links:hover {
            text-decoration: underline;
        }
        
        .booking-summary {
            background: #2A2A2A;
            border-radius: 8px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* Payment options in sidebar */
        .booking-sidebar .payment-options {
            margin: 1.5rem 0;
        }
        
        .booking-sidebar .payment-option {
            margin-bottom: 0.75rem;
            padding: 0.75rem;
            font-size: 0.9rem;
        }
        
        .booking-sidebar .payment-title {
            font-size: 0.9rem;
            font-weight: 600;
        }
        
        .booking-sidebar .payment-description {
            font-size: 0.8rem;
            opacity: 0.8;
        }
        
        /* Payment model info in sidebar */
        .booking-sidebar .payment-model-info {
            margin-bottom: 1rem;
            padding: 1rem;
            font-size: 0.85rem;
        }
        
        .booking-sidebar .payment-model-info h4 {
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }
        
        .booking-sidebar .payment-model-info .payment-amount {
            font-size: 0.85rem;
            margin-bottom: 0.5rem;
        }
        
        .booking-sidebar .payment-model-info p {
            font-size: 0.8rem;
            line-height: 1.4;
        }
        
        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .summary-item:last-child {
            border-bottom: none;
            font-weight: 700;
            font-size: 1.1rem;
        }
        
        .summary-label {
            color: #cccccc;
        }
        
        .summary-value {
            color: #ffffff;
            font-weight: 500;
        }
        
        .summary-services-list {
            margin-bottom: 1rem;
        }
        
        .summary-service-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .summary-service-item:last-child {
            border-bottom: none;
        }
        
        .summary-service-name {
            color: #ffffff;
            font-size: 0.9rem;
            flex: 1;
        }
        
        .summary-service-price {
            color: #FF3CAC;
            font-weight: 600;
            font-size: 0.9rem;
            margin-right: 0.5rem;
        }
        
        .summary-remove-btn {
            background: #666666;
            color: white;
            border: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            transition: all 0.3s ease;
        }
        
        .summary-remove-btn:hover {
            background: #ff4444;
        }
        
        .add-service-text {
            text-align: center;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .add-service-text small {
            color: #cccccc;
            font-size: 0.8rem;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .add-service-text small:hover {
            color: #FF3CAC;
        }
        
        /* Disclaimer Styles */
        .staff-allocation-disclaimer, .venue-payment-disclaimer {
            background: #1A1A1A;
            border: 1px solid rgba(255, 60, 172, 0.3);
            border-left: 4px solid #FF3CAC;
            border-radius: 8px;
            padding: 1rem;
            margin: 1.5rem 0;
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
        }
        
        .disclaimer-icon {
            color: #FF3CAC;
            font-size: 1.1rem;
            margin-top: 0.1rem;
            flex-shrink: 0;
        }
        
        .disclaimer-text {
            color: #cccccc;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .disclaimer-text strong {
            color: #ffffff;
            font-weight: 600;
        }
        
        /* Policy Modal Styles */
        #policyModalContent {
            background: #111111;
            border: 1px solid #374151;
            border-radius: 8px;
            padding: 1.5rem;
            color: #e5e7eb;
            font-size: 0.95rem;
            line-height: 1.6;
            white-space: pre-line;
            max-height: 60vh;
            overflow-y: auto;
        }
        
        .venue-payment-disclaimer {
            margin-top: 1rem;
            background: rgba(255, 60, 172, 0.05);
            border-color: rgba(255, 60, 172, 0.2);
        }
        
        .paynow-payment-disclaimer {
            margin-top: 1rem;
            background: #1A1A1A;
            border: 1px solid rgba(255, 60, 172, 0.3);
            border-left: 4px solid #FF3CAC;
            border-radius: 8px;
            padding: 1rem;
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
        }
        
        .booking-notes-disclaimer {
            margin-top: 0.5rem;
        }
        
        .booking-notes-disclaimer small {
            color: #888888;
            font-size: 0.8rem;
            font-style: italic;
        }

        /* Treatwell-style Checkout Options */
        .checkout-options-simple {
            background: #1A1A1A;
            border-radius: 8px;
            padding: 1rem 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .checkout-text {
            color: #cccccc;
            font-size: 0.95rem;
            margin: 0;
            text-align: center;
        }

        .checkout-link {
            color: #FF3CAC;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .checkout-link:hover {
            color: #FF6BCB;
            text-decoration: underline;
        }

        .checkout-link.guest-link {
            color: #0D9488;
        }

        .guest-text {
            color: #cccccc;
            font-weight: 400;
        }

        .checkout-form {
            background: #1A1A1A;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid rgba(255, 60, 172, 0.2);
        }

        .checkout-form h4 {
            color: #ffffff;
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .btn-secondary { 
            background: #333;
            color: #ffffff;
            border: 1px solid #555;
            border-radius: 6px;
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: #444;
            border-color: #666;
        }

        .btn-primary {
            background: linear-gradient(135deg, #FF3CAC 0%, #784BA0 100%);
            color: white; 
            border: none;
            border-radius: 6px;
            padding: 0.75rem 1.5rem;
            cursor: pointer; 
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(255, 60, 172, 0.3);
        }

        .form-links {
            margin-top: 1rem;
            text-align: center;
        }

        .form-links a {
            color: #FF3CAC;
            text-decoration: none;
            font-size: 0.9rem;
        }

        .form-links a:hover {
            text-decoration: underline;
        }

        /* Back Button Styling */
        .back-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            color: #ffffff;
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-right: 1rem;
        }

        .back-btn:hover {
            background: rgba(255, 60, 172, 0.2);
            border-color: rgba(255, 60, 172, 0.4);
            transform: translateX(-2px);
        }

        .back-btn i {
            font-size: 0.8rem;
        }

        /* No Services Message Styling */
        .no-services-message {
            background: #1A1A1A;
            border-radius: 12px;
            padding: 3rem 2rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
        }

        .no-services-content {
            max-width: 400px;
            margin: 0 auto;
        }

        .no-services-icon {
            font-size: 3rem;
            color: #666;
            margin-bottom: 1rem;
            display: block;
        }

        .no-services-content h3 {
            color: #ffffff;
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
        }

        .no-services-content p {
            color: #cccccc;
            font-size: 1rem;
            margin-bottom: 2rem;
            line-height: 1.5;
        }

        .add-service-btn {
            background: linear-gradient(135deg, #FF3CAC 0%, #784BA0 100%);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin: 0 auto;
        }

        .add-service-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 60, 172, 0.3);
        }

        .add-service-btn i {
            font-size: 0.9rem;
        }

        /* Reduce gap between selected services and booking section on desktop only */
        @media (min-width: 768px) {
            .booking-section {
                margin-top: -2rem;
            }
            
            .booking-form {
                margin-top: 0;
            }
        }
        
        .booking-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .booking-actions .btn-secondary:hover {
            background: #cccccc;
            color: #121212;
        }
        
        @media (max-width: 768px) {
            .booking-actions {
                flex-direction: column;
            }
            
            .booking-actions .btn-secondary {
                width: 100%;
                justify-content: center;
            }
        }
        
        @media (max-width: 768px) {
            .staff-allocation-disclaimer, .venue-payment-disclaimer {
                margin: 1rem 0;
                padding: 0.875rem;
            }
            
            .disclaimer-text {
                font-size: 0.85rem;
            }
        }
        
        /* Confirmation Page Styles */
        .confirmation-page {
            background: #1A1A1A;
            border-radius: 12px;
            padding: 3rem;
            text-align: center;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .confirmation-header {
            margin-bottom: 3rem;
        }
        
        .success-icon {
            width: 80px;
            height: 80px;
            background: #10B981;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 2rem;
            font-size: 2rem;
            color: white;
        }
        
        .confirmation-header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 1rem;
        }
        
        .confirmation-subtitle {
            color: #cccccc;
            font-size: 1.2rem;
        }
        
        .confirmation-details {
            text-align: left;
            margin-bottom: 3rem;
        }
        
        .detail-section {
            background: #2A2A2A;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .detail-section h3 {
            color: #FF3CAC;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }
        
        .detail-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.75rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .detail-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .detail-label {
            color: #cccccc;
            font-weight: 500; 
        }
        
        .detail-value {
            color: #ffffff;
            font-weight: 600;
        }
        
        .business-info {
            background: #1A1A1A;
            border-radius: 6px;
            padding: 1rem;
        }
        
        .business-name {
            font-weight: 600;
            color: #FF3CAC;
            margin-bottom: 0.5rem;
        }
        
        .business-address, .business-phone {
            color: #cccccc;
            margin-bottom: 0.25rem;
        }
        
        .payment-info {
            background: #1A1A1A;
            border-radius: 6px;
            padding: 1rem;
        }
        
        .payment-method, .transaction-id, .payment-status {
            color: #ffffff;
            margin-bottom: 0.5rem;
        }
        
        .payment-notice, .success-notice {
            background: rgba(255, 60, 172, 0.1);
            border: 1px solid #FF3CAC;
            border-radius: 8px;
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .notice-icon {
            color: #FF3CAC;
            font-size: 1.5rem;
        }
        
        .notice-text {
            color: #ffffff;
            line-height: 1.5;
        }
        
        .confirmation-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 1rem 2rem;
            border-radius: 6px;
            font-weight: 600;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s;
            cursor: pointer;
            border: none;
            font-size: 1rem;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #FF3CAC, #784BA0);
            color: white;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #FF1493, #8A2BE2);
            transform: translateY(-1px);
        }
        
        .btn-secondary { 
            background: transparent; 
            color: #FF3CAC;
            border: 2px solid #FF3CAC;
        }
        
        .btn-secondary:hover {
            background: #FF3CAC;
            color: white; 
        }
        
        @media (max-width: 768px) {
            .confirmation-page {
                padding: 2rem 1rem;
            }
            
            .confirmation-header h1 {
                font-size: 2rem;
            }
            
            .confirmation-actions {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
        }
        
        .cta-button {
            width: 100%;
            background: linear-gradient(135deg, #FF3CAC, #784BA0);
            color: white;
            border: none;
            padding: 1rem 2rem; 
            border-radius: 6px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer; 
            transition: all 0.3s;
            margin-top: 2rem;
            box-shadow: 0 4px 6px rgba(255, 60, 172, 0.3);
        }
        
        .cta-button:hover:not(:disabled) {
            background: linear-gradient(135deg, #FF1493, #8A2BE2);
            transform: translateY(-1px);
            box-shadow: 0 6px 8px rgba(255, 60, 172, 0.4);
        }
        
        .cta-button:disabled {
            background: #9CA3AF;
            cursor: not-allowed;
            box-shadow: none;
        }
        
        /* Mobile touch improvements for CTA button */
        .cta-button {
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            min-height: 44px; /* Minimum touch target size */
        }
        
        /* Calendar Styles */
        .calendar-container {
            margin-bottom: 2rem;
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .calendar-nav {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #cccccc;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 4px;
            transition: background 0.3s;
        }
        
        .calendar-nav:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .calendar-month {
            font-weight: 600;
            font-size: 1.2rem;
            color: #ffffff;
        }
        
        .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.5rem;
        }
        
        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            color: #ffffff;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .calendar-day:hover {
            background: rgba(255, 60, 172, 0.2);
            border-color: #FF3CAC;
            transform: translateY(-2px);
        }
        
        .calendar-day.selected {
            background: linear-gradient(135deg, #FF3CAC, #784BA0);
            color: white;
            border: 2px solid #FF3CAC;
            box-shadow: 0 4px 12px rgba(255, 60, 172, 0.4);
            transform: scale(1.05);
        }
        
        .calendar-day.closed {
            background: #2A2A2A;
            color: #666666;
            cursor: not-allowed;
            opacity: 0.4;
            position: relative;
        }
        
        .calendar-day.closed:hover {
            background: #2A2A2A;
            transform: none;
        }
        
        .closed-text {
            font-size: 0.7rem;
            color: #999999;
            margin-top: 0.2rem;
        }
        
        .day-number {
            font-weight: 600;
        }
        
        .calendar-day.available {
            background: rgba(255, 60, 172, 0.1);
            color: #FF3CAC;
            border: 2px solid rgba(255, 60, 172, 0.3);
        }
        
        .calendar-day.unavailable {
            color: #666666;
            cursor: not-allowed;
            background: rgba(255, 255, 255, 0.02);
            border-color: rgba(255, 255, 255, 0.1);
        }
        
        .time-slots {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .time-slot {
            padding: 1rem;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            background: rgba(255, 255, 255, 0.05);
            color: #ffffff;
        }
        
        .time-slot:hover {
            border-color: #FF3CAC;
            background: rgba(255, 60, 172, 0.2);
            transform: translateY(-2px);
        }
        
        .time-slot.selected {
            border-color: #FF3CAC;
            background: linear-gradient(135deg, #FF3CAC, #784BA0);
            color: white;
            box-shadow: 0 4px 12px rgba(255, 60, 172, 0.4);
            transform: scale(1.05);
        }
        
        .time-slot.unavailable {
            background: rgba(255, 255, 255, 0.02);
            color: #666666;
            cursor: not-allowed;
            border-color: rgba(255, 255, 255, 0.1);
            opacity: 0.5;
        }
        
        @media (max-width: 768px) {
            .booking-content {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
            
            .booking-sidebar {
                position: static;
                order: -1;
            }
            
            .time-slots {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .cta-button {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                margin: 0;
                border-radius: 0;
                z-index: 100;
            }
            
            body {
                padding-bottom: 80px;
            }
        }
        
        .service-name {
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 0.5rem;
        }
        
        .service-price {
            color: #FF3CAC;
            font-weight: 700;
            font-size: 1.2rem;
        }
        
        .service-description {
            color: #cccccc;
            font-size: 0.9rem;
            margin: 0.5rem 0;
        }
        
        /* Reviews Section */
        .reviews-section {
            margin: 2rem 0;
        }
        
        .reviews-summary { 
            display: flex; 
            align-items: center; 
            gap: 2rem;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: #2A2A2A;
            border-radius: 10px; 
        }
        
        .rating-display {
            text-align: center;
        }
        
        .rating-number {
            font-size: 3rem;
            font-weight: 700;
            color: #FF3CAC;
            margin-bottom: 0.5rem;
        }
        
        .rating-stars {
            color: #FFD700;
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }
        
        .rating-count {
            color: #cccccc;
            font-size: 0.9rem;
        }
        
        .reviews-section {
            background: #121212;
            padding: 4rem 0;
        }
        
        .reviews-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .review-item { 
            background: #2A2A2A;
            padding: 1.5rem;
            border-radius: 10px; 
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 1rem;
        }
        
        .review-header {
            display: flex; 
            justify-content: space-between; 
            align-items: flex-start;
            margin-bottom: 1rem;
        }
        
        .reviewer-info {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }
        
        .reviewer-name {
            font-weight: 600;
            color: #ffffff;
            font-size: 1rem;
        }
        
        .verified-badge {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            color: #4ADE80;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .verified-badge i {
            font-size: 0.75rem;
        }
        
        .review-date {
            color: #888;
            font-size: 0.9rem;
        }
        
        .review-rating {
            color: #FFD700;
            margin-bottom: 0.5rem;
        }
        
        .review-text {
            color: #cccccc;
            line-height: 1.5;
            margin-bottom: 1rem;
        }
        
        /* Business Reply Styles */
        .business-reply {
            background: rgba(255, 60, 172, 0.1);
            border: 1px solid rgba(255, 60, 172, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }
        
        .reply-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .reply-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #FF3CAC;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .reply-label i {
            font-size: 0.8rem;
        }
        
        .reply-date {
            color: #999;
            font-size: 0.8rem;
        }
        
        .reply-text {
            color: #ffffff;
            line-height: 1.5;
            font-size: 0.95rem;
        }
        
        /* Google Maps */
        .map-container {
            margin: 2rem 0;
        }
        
        .map-iframe {
            width: 100%;
            height: 250px;
            border: none;
            border-radius: 10px;
        }
        
        /* Sticky CTA Button */
        .sticky-cta {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #FF3CAC, #784BA0);
            padding: 1rem 2rem;
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            box-shadow: 0 -5px 20px rgba(255, 60, 172, 0.3);
        }
        
        .sticky-cta button {
            background: white;
            color: #FF3CAC;
            border: none;
            padding: 1rem 2rem;
            border-radius: 25px;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            min-height: 44px; /* Minimum touch target size for mobile */
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            user-select: none;
        }
        
        .sticky-cta button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .sticky-cta .secondary-btn {
            background: transparent;
            color: white;
            border: 2px solid white;
        }
        
        .sticky-cta .secondary-btn:hover {
            background: white;
            color: #FF3CAC;
        }
        
        /* Footer */
        .footer {
            background: #1A1A1A;
            color: white;
            padding: 40px 0;
            text-align: center;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 3rem;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            
            .hero-banner {
                flex-direction: column;
                text-align: center;
            }
            
            .business-logo {
                width: 100px;
                height: 100px;
                font-size: 2.5rem;
            }
            
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .gallery-slide {
                height: 250px;
            }
            
            .sticky-cta {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .sticky-cta button {
                width: 100%;
                justify-content: center;
                min-height: 48px; /* Larger touch target on mobile */
                font-size: 1rem;
                padding: 1.2rem 2rem;
            }
        }
        
        /* Error states for validation */
        .services-section.error {
            border-color: #ef4444;
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
        }
        
        /* Inline error messages */
        .field-error {
            color: #ff4444;
            font-size: 0.85rem;
            margin-top: 0.25rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }
        
        .field-error i {
            font-size: 0.75rem;
        }
        
        .error-border {
            border-color: #ff4444 !important;
            box-shadow: 0 0 0 2px rgba(255, 68, 68, 0.2) !important;
        }
        
        /* Services error styling */
        .services-error {
            margin-top: 0.5rem;
            padding: 0.5rem;
            background: rgba(255, 68, 68, 0.1);
            border: 1px solid #ff4444;
            border-radius: 4px;
        }
        
        /* Date/time error styling */
        .booking-calendar.error {
            border: 2px solid #ff4444;
            background: rgba(255, 68, 68, 0.05);
        }
        
        .form-input.error {
            border-color: #ef4444;
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
        }
        
        .form-checkbox.error {
            border-color: #ef4444;
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
        }
        
        .form-input.error {
            border-color: #ef4444;
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
        }
        
        .inline-error {
            color: #ef4444;
            font-size: 0.875rem;
            margin-top: 0.5rem;
            display: block;
        }
        
        /* Progress indicator */
        .progress-indicator {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: linear-gradient(135deg, rgba(255, 60, 172, 0.1), rgba(138, 43, 226, 0.1));
            border-radius: 16px;
            border: 2px solid rgba(255, 60, 172, 0.2);
            box-shadow: 0 4px 20px rgba(255, 60, 172, 0.1);
        }
        
        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            position: relative;
        }
        
        .progress-step:not(:last-child)::after {
            content: '';
            position: absolute;
            top: 20px;
            left: 60%;
            width: 80%;
            height: 2px;
            background: rgba(255, 255, 255, 0.2);
            z-index: 1;
        }
        
        .progress-step.completed:not(:last-child)::after {
            background: #10b981;
        }
        
        .progress-step.current:not(:last-child)::after {
            background: linear-gradient(90deg, #10b981 50%, rgba(255, 255, 255, 0.2) 50%);
        }
        
        .step-circle {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 1rem;
            position: relative;
            z-index: 2;
            transition: all 0.4s ease;
        }
        
        .step-circle.pending {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.5);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .step-circle.current {
            background: linear-gradient(135deg, #FF3CAC, #784BA0);
            color: white;
            border: 3px solid #FF3CAC;
            box-shadow: 0 0 25px rgba(255, 60, 172, 0.6);
            transform: scale(1.1);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 25px rgba(255, 60, 172, 0.6); }
            50% { box-shadow: 0 0 35px rgba(255, 60, 172, 0.8); }
            100% { box-shadow: 0 0 25px rgba(255, 60, 172, 0.6); }
        }
        
        .step-circle.completed {
            background: linear-gradient(135deg, #00C851, #00A041);
            color: white;
            border: 3px solid #00C851;
            box-shadow: 0 0 15px rgba(0, 200, 81, 0.4);
        }
        
        .step-label {
            margin-top: 0.5rem;
            font-size: 0.75rem;
            text-align: center;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .step-circle.current + .step-label {
            color: #FF3CAC;
            font-weight: 600;
        }
        
        .step-circle.completed + .step-label {
            color: #10b981;
        }
        
        /* Mobile optimizations */
        @media (max-width: 768px) {
            .progress-indicator {
                margin-bottom: 1rem;
                padding: 0.75rem;
            }
            
            .step-circle {
                width: 40px;
                height: 40px;
                font-size: 0.875rem;
            }
            
            .step-label {
                font-size: 0.625rem;
            }
            
            .inline-error {
                font-size: 0.75rem;
                margin-top: 0.25rem;
            }
        }
        
        .error-message {
            position: relative;
            display: inline-block;
        }
        
        .error-message::after {
            content: attr(data-message);
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            background: #ef4444;
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.8rem;
            white-space: nowrap;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            animation: fadeInBubble 0.3s ease-out;
        }
        
        .error-message::before {
            content: '';
            position: absolute;
            top: -8px;
            left: 50%;
            transform: translateX(-50%);
            border: 4px solid transparent;
            border-top-color: #ef4444;
            z-index: 1000;
        }
        
        @keyframes fadeInBubble {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 bg-charcoal/95 backdrop-blur-md border-b border-white/10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Desktop Navigation -->
            <div class="hidden lg:flex items-center justify-between h-16">
                <!-- Left: Logo -->
                <div class="flex items-center">
                    <a href="index.html" class="text-2xl font-bold text-white hover:text-neon-pink transition-colors duration-300">BlkPages</a>
                </div>
                
                <!-- Center: Main Navigation -->
                <div class="flex items-center space-x-8">
                    <a href="index.html" class="text-text-secondary hover:text-neon-pink transition-colors duration-300 font-medium">Home</a>
                    <a href="search-results.html" class="text-text-secondary hover:text-neon-pink transition-colors duration-300 font-medium">Browse</a>
                    <a href="offers.html" class="text-text-secondary hover:text-neon-pink transition-colors duration-300 font-medium">Offers</a>
                    <a href="why-list-with-us.html#pricing" class="text-text-secondary hover:text-neon-pink transition-colors duration-300 font-medium">Plans</a>
                </div>
                
                <!-- Right: Actions -->
                <div class="flex items-center space-x-4">
                    <!-- Basket Icon -->
                    <div class="basket-icon" id="basketIcon" onclick="scrollToBooking()" style="position: relative; cursor: pointer; padding: 0.5rem; border-radius: 50%; background: rgba(13, 148, 136, 0.1); border: 1px solid rgba(13, 148, 136, 0.3); transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; width: 40px; height: 40px;">
                        <i class="fas fa-shopping-basket" style="color: #0D9488; font-size: 1.2rem;"></i>
                        <span class="basket-count" id="basketCount" style="position: absolute; top: -5px; right: -5px; background: #ff4444; color: white; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 0.7rem; font-weight: 600; border: 2px solid #1a1a1a;">0</span>
                    </div>
                    
                    <!-- Sign In / Customer Menu -->
                    <div class="auth-links" id="authLinks" style="align-items: center; gap: 0.5rem;">
                        <button id="loginBtn" class="text-white hover:text-neon-pink transition-colors duration-300 text-sm" onclick="redirectToLogin()">
                            <i class="fas fa-sign-in-alt mr-1"></i>Sign In
                        </button>
                    </div>
                    
                    <!-- Customer Menu (for logged-in users) -->
                    <div class="customer-menu" id="customerMenu" style="display: none; position: relative;">
                        <button class="customer-initial" id="customerInitial" onclick="toggleCustomerMenu()" style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #0D9488, #10B981); color: white; border: none; font-size: 1.2rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 8px rgba(13, 148, 136, 0.3);">
                            <span id="customerInitialText">U</span>
                        </button>
                        <div class="customer-dropdown" id="customerDropdown" style="display: none; position: absolute; top: 100%; right: 0; background: rgba(26, 26, 26, 0.95); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px; box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3); min-width: 150px; z-index: 1000; margin-top: 0.5rem;">
                            <a href="customer-dashboard.html" class="dropdown-item" style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; color: #ffffff; text-decoration: none; font-size: 0.9rem; transition: all 0.3s ease; border-bottom: 1px solid rgba(255, 255, 255, 0.05);">
                                <i class="fas fa-user"></i>
                                Account
                            </a>
                            <a href="#" onclick="signOut()" class="dropdown-item" style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; color: #ffffff; text-decoration: none; font-size: 0.9rem; transition: all 0.3s ease;">
                                <i class="fas fa-sign-out-alt"></i>
                                Sign Out
                            </a>
                        </div>
                    </div>
                    
                    <!-- List Business Button (smaller and less overpowering) -->
                    <a href="business-register.html" class="text-text-secondary hover:text-green-400 transition-colors duration-300 font-medium text-sm list-business-btn">+ List Business</a>
                </div>
            </div>
            
            <!-- Mobile Navigation -->
            <div class="lg:hidden flex items-center justify-between h-16">
                <!-- Left: Logo -->
                <div class="flex items-center">
                    <a href="index.html" class="text-xl font-bold text-white hover:text-neon-pink transition-colors duration-300">BlkPages</a>
                </div>
                
                <!-- Right: Actions -->
                <div class="flex items-center space-x-3">
                    <!-- Basket Icon -->
                    <div class="basket-icon" id="mobileBasketIcon" onclick="scrollToBooking()" style="position: relative; cursor: pointer; padding: 0.5rem; border-radius: 50%; background: rgba(13, 148, 136, 0.1); border: 1px solid rgba(13, 148, 136, 0.3); transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; width: 40px; height: 40px;">
                        <i class="fas fa-shopping-basket" style="color: #0D9488; font-size: 1.2rem;"></i>
                        <span class="basket-count" id="mobileBasketCount" style="position: absolute; top: -5px; right: -5px; background: #ff4444; color: white; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 0.7rem; font-weight: 600; border: 2px solid #1a1a1a;">0</span>
                    </div>
                    
                    <!-- Account Icon -->
                    <div class="auth-links" id="mobileAuthLinks" style="align-items: center; gap: 0.5rem;">
                        <button id="mobileLoginBtn" class="text-white hover:text-neon-pink transition-colors duration-300 text-sm" onclick="toggleLoginModal(event)">
                            <i class="fas fa-sign-in-alt"></i>
                        </button>
                    </div>
                    
                    <!-- Customer Menu (Mobile) -->
                    <div class="customer-menu" id="mobileCustomerMenu" style="display: none; position: relative;">
                        <button class="customer-initial" id="mobileCustomerInitial" onclick="toggleCustomerMenu()" style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #0D9488, #10B981); color: white; border: none; font-size: 1.2rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 8px rgba(13, 148, 136, 0.3);">
                            <span id="mobileCustomerInitialText">U</span>
                        </button>
                        <div class="customer-dropdown" id="mobileCustomerDropdown" style="display: none; position: absolute; top: 100%; right: 0; background: rgba(26, 26, 26, 0.95); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px; box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3); min-width: 150px; z-index: 1000; margin-top: 0.5rem;">
                            <a href="customer-dashboard.html" class="dropdown-item" style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; color: #ffffff; text-decoration: none; font-size: 0.9rem; transition: all 0.3s ease; border-bottom: 1px solid rgba(255, 255, 255, 0.05);">
                                <i class="fas fa-user"></i>
                                Account
                            </a>
                            <a href="#" onclick="signOut()" class="dropdown-item" style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; color: #ffffff; text-decoration: none; font-size: 0.9rem; transition: all 0.3s ease;">
                                <i class="fas fa-sign-out-alt"></i>
                                Sign Out
                            </a>
                        </div>
                    </div>
                    
                    <!-- Hamburger Menu -->
                    <button class="text-white hover:text-neon-pink transition-colors duration-300" onclick="toggleMobileMenu()">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
            
            <!-- Mobile Menu -->
            <div id="mobileMenu" class="lg:hidden hidden bg-charcoal/95 backdrop-blur-md border-t border-white/10">
                <div class="px-4 py-4 space-y-4">
                    <a href="index.html" class="block text-text-secondary hover:text-neon-pink transition-colors duration-300 font-medium">Home</a>
                    <a href="search-results.html" class="block text-text-secondary hover:text-neon-pink transition-colors duration-300 font-medium">Browse</a>
                    <a href="offers.html" class="block text-text-secondary hover:text-neon-pink transition-colors duration-300 font-medium">Offers</a>
                    <a href="why-list-with-us.html#pricing" class="block text-text-secondary hover:text-neon-pink transition-colors duration-300 font-medium">Plans</a>
                    <a href="business-register.html" class="block text-text-secondary hover:text-green-400 transition-colors duration-300 font-medium py-2 list-business-btn">+ List Business</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-black/90 backdrop-blur-md rounded-2xl p-8 max-w-md w-full border border-white/10">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-bold gradient-text">Login</h3>
                    <button onclick="toggleLoginModal(event)" class="text-white/70 hover:text-white">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <form id="loginForm" onsubmit="handleLogin(event)">
                    <div class="mb-4">
                        <label class="block text-white/70 mb-2">Email</label>
                        <input type="email" required class="w-full px-4 py-3 rounded-lg bg-white/10 border border-white/20 text-white placeholder-white/50 focus:outline-none focus:border-neon-pink" placeholder="customer@example.com">
                    </div>
                    <div class="mb-6">
                        <label class="block text-white/70 mb-2">Password</label>
                        <input type="password" required class="w-full px-4 py-3 rounded-lg bg-white/10 border border-white/20 text-white placeholder-white/50 focus:outline-none focus:border-neon-pink" placeholder="password123">
                    </div>
                    <button type="submit" class="w-full py-3 rounded-lg bg-gradient-to-r from-neon-pink to-neon-purple text-white font-semibold hover:from-neon-purple hover:to-neon-blue transition-all duration-300">
                        Login
                    </button>
                </form>
                <div class="mt-4 text-center">
                    <p class="text-white/70 text-sm">Don't have an account? <a href="#" onclick="redirectToRegister()" class="text-neon-pink hover:text-neon-purple transition-colors duration-300">Sign up</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Hero Banner -->
            <div class="container">
        <div class="hero-banner">
            <div class="business-logo">
                <i class="fas fa-cut"></i>
            </div>
                <div class="business-info">
                        <h1>Royal Hair Studio</h1>
                <div class="business-category">Hair Salon</div>
                <div class="business-rating">
                    <div class="stars">★★★★★</div>
                    <div class="rating-text">4.8 (127 reviews)</div>
                </div>
                <p class="business-description">
                    Professional hair salon specializing in natural hair care, styling, and treatments for all hair types. 
                    Our experienced stylists provide personalized service in a welcoming, modern environment.
                            </p>
                        </div>
                            </div>
                        </div>
                        
    <!-- Photo Gallery -->
    <div class="container">
        <div class="photo-gallery">
            <h2 class="gallery-title">Gallery</h2>
            <div class="gallery-container">
                <div class="gallery-slides" id="gallerySlides">
                    <div class="gallery-slide"></div>
                    <div class="gallery-slide"></div>
                    <div class="gallery-slide"></div>
                        </div>
                <button class="gallery-nav gallery-prev" onclick="changeSlide(-1)">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="gallery-nav gallery-next" onclick="changeSlide(1)">
                    <i class="fas fa-chevron-right"></i>
                </button>
                <div class="gallery-dots">
                    <button class="gallery-dot active" onclick="currentSlide(1)"></button>
                    <button class="gallery-dot" onclick="currentSlide(2)"></button>
                    <button class="gallery-dot" onclick="currentSlide(3)"></button>
                    </div>
                            </div>
                            </div>
                        </div>
                        
                <!-- Main Content -->
    <div class="container">
        <div class="content-wrapper">
            <div class="content-main">
                    <!-- About Section -->
                <div class="card">
                        <h2>About Royal Hair Studio</h2>
                    <p style="color: #cccccc; line-height: 1.6; margin-bottom: 1rem;">
                        With over 10 years of experience in the hair industry, Royal Hair Studio has become a trusted name 
                        in London's beauty scene. We specialize in natural hair care, protective styling, and modern cuts 
                        that enhance your natural beauty.
                    </p>
                    <p style="color: #cccccc; line-height: 1.6;">
                        Our team of certified stylists stays up-to-date with the latest techniques and trends, ensuring 
                        you receive the highest quality service. We use premium products and maintain the highest standards 
                        of hygiene and professionalism.
                            </p>
                        </div>
                        
                    <!-- Services Section -->
                <div class="card">
                    <h2>Services & Prices</h2>
                    
                    <!-- Payment Method Information -->
                    <div class="payment-method-info" id="paymentMethodInfo">
                        <div class="payment-method-text">
                            <i class="fas fa-credit-card"></i>
                            <span id="paymentMethodText">Select services to see payment options</span>
                            </div>
                            </div>
                    
                        <div class="services-instruction" style="margin-bottom: 1rem; padding: 1rem; background: rgba(255, 60, 172, 0.1); border-radius: 8px; border-left: 4px solid #FF3CAC;">
                            <p style="margin: 0; color: #FF3CAC; font-weight: 600;">
                                <i class="fas fa-info-circle"></i> 
                                Start by selecting a service below to begin your booking
                            </p>
                            <button onclick="testButtonUpdate()" style="margin-top: 0.5rem; padding: 0.5rem; background: #FF3CAC; color: white; border: none; border-radius: 4px; cursor: pointer; margin-right: 0.5rem;">
                                Test Button Update
                            </button>
                            <button onclick="testAddService()" style="margin-top: 0.5rem; padding: 0.5rem; background: #784BA0; color: white; border: none; border-radius: 4px; cursor: pointer;">
                                Test Add Service
                            </button>
                        </div>
                        <div class="services-grid">
                        <div class="service-item">
                            <div class="service-info">
                                <div class="service-name">Hair Cut & Style</div>
                                <div class="service-price">£45</div>
                                <div class="service-description">Professional cut and styling for all hair types</div>
                            </div>
                            <button class="add-service-btn" onclick="addService('Hair Cut & Style', 45, 30);">
                                <i class="fas fa-plus"></i> Add
                            </button>
                        </div>
                        <div class="service-item">
                            <div class="service-info">
                                <div class="service-name">Hair Coloring</div>
                                <div class="service-price">£85</div>
                                <div class="service-description">Full color service with premium products</div>
                            </div>
                            <button class="add-service-btn" onclick="addService('Hair Coloring', 85, 90)">
                                <i class="fas fa-plus"></i> Add
                            </button>
                        </div>
                        <div class="service-item">
                            <div class="service-info">
                                <div class="service-name">Deep Conditioning</div>
                                <div class="service-price">£35</div>
                                <div class="service-description">Intensive treatment for damaged hair</div>
                            </div>
                            <button class="add-service-btn" onclick="addService('Deep Conditioning', 35, 45)">
                                <i class="fas fa-plus"></i> Add
                            </button>
                            </div>
                        <div class="service-item">
                            <div class="service-info">
                                <div class="service-name">Bridal Package</div>
                                <div class="service-price">£150</div>
                                <div class="service-description">Complete bridal hair styling package</div>
                            </div>
                            <button class="add-service-btn" onclick="addService('Bridal Package', 150, 120)">
                                <i class="fas fa-plus"></i> Add
                            </button>
                            </div>
                        </div>
                        
                    <!-- Selected Services Display -->
                    <div id="selected-services" class="selected-services" style="display: none;">
                        <h3>Selected Services</h3>
                        <div id="selected-services-list"></div>
                        <div class="total-price">
                            <strong>Total: £<span id="total-price">0</span></strong>
                            </div>
                        </div>
                        </div>
                    </div>
                    
            <div class="content-sidebar">
                <!-- Contact Information -->
                <div class="card">
                    <h2>Contact Information</h2>
                    <div class="contact-info">
                            <div class="contact-item">
                            <div class="contact-icon">📍</div>
                            <div class="contact-details">
                                <h4>Address</h4>
                                <p>123 Beauty Street<br>London SW1A 1AA</p>
                            </div>
                            </div>
                            
                            <div class="contact-item">
                            <div class="contact-icon">📞</div>
                            <div class="contact-details">
                                <h4>Phone</h4>
                                <p>+44 20 7123 4567</p>
                            </div>
                                </div>
                        
                            <div class="contact-item">
                            <div class="contact-icon">🌐</div>
                            <div class="contact-details">
                                <h4>Website</h4>
                                <p>www.royalhairstudio.com</p>
                            </div>
                        </div>
                        
                            <div class="contact-item">
                            <div class="contact-icon">⏰</div>
                            <div class="contact-details">
                                <h4>Opening Hours</h4>
                                <p>Mon-Fri: 9:00 AM - 6:00 PM<br>Sat: 9:00 AM - 5:00 PM<br>Sun: Closed</p>
                            </div>
                        </div>
                            </div>
                        </div>
                        
                <!-- Quick Actions -->
                <div class="card">
                    <h2>Quick Actions</h2>
                        <div style="display: flex; flex-direction: column; gap: 1rem;">
                        <button style="width: 100%; background: transparent; color: #FF3CAC; border: 2px solid #FF3CAC; padding: 1rem; border-radius: 10px; font-weight: 600; cursor: pointer; transition: all 0.3s;" onmouseover="this.style.background='#FF3CAC'; this.style.color='white'" onmouseout="this.style.background='transparent'; this.style.color='#FF3CAC'" onclick="trackContactClick('call')">
                                <i class="fas fa-phone"></i> Call Now
                        </button>
                        <button style="width: 100%; background: transparent; color: #FF3CAC; border: 2px solid #FF3CAC; padding: 1rem; border-radius: 10px; font-weight: 600; cursor: pointer; transition: all 0.3s;" onmouseover="this.style.background='#FF3CAC'; this.style.color='white'" onmouseout="this.style.background='transparent'; this.style.color='#FF3CAC'">
                            <i class="fas fa-share"></i> Share
                        </button>
                        </div>
                    </div>
                    
                <!-- Map -->
                <div class="card">
                    <h2>Location</h2>
                    <div class="map-container">
                        <iframe 
                            class="map-iframe"
                            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2483.123456789!2d-0.1278!3d51.5074!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x0!2zNTHCsDMwJzI2LjYiTiAwwrAwNyc0MC4xIlc!5e0!3m2!1sen!2suk!4v1234567890123!5m2!1sen!2suk"
                            allowfullscreen="" 
                            loading="lazy" 
                            referrerpolicy="no-referrer-when-downgrade">
                        </iframe>
                </div>
            </div>
            </div>
        </div>
    </div>

                    
    <!-- Booking Section -->
    <div id="booking-section" class="booking-section" style="display: none;">
        <div class="container">
            <!-- Progress Indicator -->
            <div class="progress-indicator" id="progressIndicator">
                <div class="progress-step" id="step1">
                    <div class="step-circle pending">1</div>
                    <div class="step-label">Service</div>
                </div>
                <div class="progress-step" id="step2">
                    <div class="step-circle pending">2</div>
                    <div class="step-label">Date & Time</div>
                </div>
                <div class="progress-step" id="step3">
                    <div class="step-circle pending">3</div>
                    <div class="step-label">Details</div>
                </div>
                <div class="progress-step" id="step4">
                    <div class="step-circle pending">4</div>
                    <div class="step-label">Confirm</div>
                </div>
                    </div>
                    
            <div class="booking-content">
                <div class="booking-form">
                    <h2>Complete Your Booking</h2>
                    
                    <!-- Selected Services -->
                    <div class="booking-services">
                        <h3>Selected Services</h3>
                        <div id="booking-services-list"></div>
                        <div class="add-more-services">
                            <button class="add-more-btn" onclick="showServiceSelection()">
                                <i class="fas fa-plus"></i> Add Another Treatment
                            </button>
                            </div>
                            </div>
                    
                    <!-- Date & Time Selection -->
                    <div class="booking-datetime">
                        <h3>Select Date & Time</h3>
                        <div class="calendar-container">
                            <div class="calendar-header">
                                <button class="calendar-nav" onclick="changeMonth(-1)">
                                    <i class="fas fa-chevron-left"></i>
                            </button>
                                <div class="calendar-month" id="currentMonth">December 2024</div>
                                <button class="calendar-nav" onclick="changeMonth(1)">
                                    <i class="fas fa-chevron-right"></i>
                            </button>
                            </div>
                            <div class="calendar-days" id="calendarDays"></div>
                            </div>
                        <div class="time-slots" id="timeSlots"></div>
                            </div>
                    
                    <!-- Treatwell-style Login/Guest Options -->
                    <div class="checkout-options-simple">
                        <p class="checkout-text">
                            <a href="#" class="checkout-link" onclick="saveBasketContents(); toggleLoginModal(event);">Sign in</a> or 
                            <a href="#" class="checkout-link" onclick="saveBasketContents(); redirectToRegister();">sign up</a> 
                            to save your details, or 
                            <span class="guest-text">continue as guest</span>
                        </p>
                            </div>


                    <!-- No Services Message (Hidden by default) -->
                    <div class="no-services-message" id="noServicesMessage" style="display: none;">
                        <div class="no-services-content">
                            <i class="fas fa-shopping-cart no-services-icon"></i>
                            <h3>No Services Selected</h3>
                            <p>You haven't selected any services yet. Choose from our range of treatments below.</p>
                            <button onclick="scrollToServices()" class="add-service-btn">
                                <i class="fas fa-plus"></i>
                                <span>Add Service</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Customer Details (Hidden until checkout method selected) -->
                    <div class="booking-details" id="customerDetails" style="display: none;">
                        <h3>Your Details</h3>
                        <div class="form-group">
                            <label class="form-label">Full Name *</label>
                            <input type="text" class="form-input" id="fullName" required placeholder="Enter your full name (first & last)">
            </div>
                        <div class="form-group">
                            <label class="form-label">Email Address *</label>
                            <input type="email" class="form-input" id="email" required placeholder="Enter your email (e.g., name@example.com)">
        </div>
                        <div class="form-group">
                            <label class="form-label">Phone Number *</label>
                            <input type="tel" class="form-input" id="phone" required placeholder="Enter your UK mobile or landline (e.g., 07123 456789 or 020 7946 1234)">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Postcode *</label>
                            <input type="text" class="form-input" id="postcode" required placeholder="Enter your UK postcode (e.g., SW1A 1AA)" style="text-transform: uppercase;">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Booking Notes (Optional)</label>
                            <textarea class="form-textarea" id="bookingNotes" placeholder="Any special requests or notes for your appointment..."></textarea>
                            <div class="booking-notes-disclaimer">
                                <small>These notes will be passed to the business. BlkPages does not monitor or edit these notes.</small>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Staff Allocation Disclaimer -->
                    <div class="staff-allocation-disclaimer">
                        <div class="disclaimer-icon">
                            <i class="fas fa-info-circle"></i>
                        </div>
                        <div class="disclaimer-text">
                            <strong>Staff Allocation:</strong> Appointments are booked with the first available stylist or therapist. If you would like to see a specific person, please contact the business directly to confirm availability.
                        </div>
                    </div>
                    
                    <!-- Payment Options -->
                    <div class="booking-payment">
                        <h3>Payment Information</h3>
                        <div class="payment-model-info" id="paymentModelInfo">
                            <!-- Payment model information will be populated by JavaScript -->
                        </div>
                        
                        <!-- Pay at Venue Disclaimer -->
                        <div class="venue-payment-disclaimer" id="venuePaymentDisclaimer" style="display: none;">
                            <div class="disclaimer-icon">
                                <i class="fas fa-info-circle"></i>
                            </div>
                            <div class="disclaimer-text">
                                This business has chosen to allow payment at venue. BlkPages does not handle payments or refunds for this booking.
                            </div>
                        </div>
                        
                        <!-- Pay Now Disclaimer -->
                        <div class="paynow-payment-disclaimer" id="payNowPaymentDisclaimer" style="display: none;">
                            <div class="disclaimer-icon">
                                <i class="fas fa-credit-card"></i>
                            </div>
                            <div class="disclaimer-text">
                                Payments are processed by BlkPages via Stripe, on behalf of Royal Hair Studio. Your contract of service is with Royal Hair Studio, not BlkPages. Refunds are subject to the venue's cancellation policy. <a href="#" onclick="openCancellationPolicyModal(); return false;" class="terms-link">View Royal Hair Studio's cancellation policy</a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Policies -->
                    <div class="booking-policies">
                        <div class="policy-checkbox">
                            <input type="checkbox" id="marketingPlatform">
                            <label for="marketingPlatform">Receive marketing emails from BlkPages</label>
                        </div>
                        <div class="policy-checkbox">
                            <input type="checkbox" id="marketingBusiness">
                            <label for="marketingBusiness">Receive marketing emails from Royal Hair Studio</label>
                        </div>
                        
                        <!-- Required Terms & Conditions Checkbox -->
                        <div class="required-terms-checkbox">
                            <input type="checkbox" id="acceptTerms" onchange="updateBookingButton()" required>
                            <label for="acceptTerms" class="required-label">
                                <span class="required-asterisk">*</span>
                                By completing this booking, I agree to BlkPages' booking policy as well as <a href="#" onclick="openCancellationPolicyModal(); return false;" class="terms-link">Royal Hair Studio's cancellation policy</a>.
                            </label>
                        </div>
                    </div>
                </div>
                
                <!-- Booking Summary Sidebar -->
                <div class="booking-sidebar">
                    <h3>Booking Summary</h3>
                    <div class="booking-summary">
                        <div class="summary-services-list" id="summaryServicesList">
                            <!-- Services will be populated here -->
                        </div>
                        <div class="add-service-text">
                            <small onclick="showServiceSelection()">Add service</small>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Date</span>
                            <span class="summary-value" id="summaryDate">-</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Time</span>
                            <span class="summary-value" id="summaryTime">-</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Duration</span>
                            <span class="summary-value" id="summaryDuration">-</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Total</span>
                            <span class="summary-value" id="summaryTotal">£0</span>
                        </div>
                    </div>
                    
                    <!-- Payment Information -->
                    <div class="payment-model-info" id="paymentModelInfo">
                        <!-- Payment model information will be populated by JavaScript -->
                    </div>
                    
                    <!-- Payment Options -->
                    <div class="payment-options" id="paymentOptions">
                        <!-- Payment options will be populated based on business model -->
                    </div>
                    
                </div>
            </div>
        </div>
    </div>

    <!-- Customer Reviews Section -->
                    <div class="reviews-section">
        <div class="container">
            <div class="card">
                        <h2>Customer Reviews</h2>
                        <div class="reviews-summary">
                            <div class="rating-display">
                        <div class="rating-number">4.8</div>
                                <div class="rating-stars">★★★★★</div>
                                <div class="rating-count">Based on 127 reviews</div>
                            </div>
                    <div style="flex: 1;">
                        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
                            <span style="color: #cccccc; font-size: 0.9rem; width: 20px;">5</span>
                            <div style="flex: 1; height: 8px; background: #333; border-radius: 4px; overflow: hidden;">
                                <div style="height: 100%; background: #FFD700; border-radius: 4px; width: 85%;"></div>
                                    </div>
                            <span style="color: #cccccc; font-size: 0.9rem; width: 30px;">85%</span>
                                </div>
                        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
                            <span style="color: #cccccc; font-size: 0.9rem; width: 20px;">4</span>
                            <div style="flex: 1; height: 8px; background: #333; border-radius: 4px; overflow: hidden;">
                                <div style="height: 100%; background: #FFD700; border-radius: 4px; width: 12%;"></div>
                                    </div>
                            <span style="color: #cccccc; font-size: 0.9rem; width: 30px;">12%</span>
                                </div>
                                    </div>
                                </div>
                
                <div class="reviews-list">
                    <!-- Review 1 -->
                    <div class="review-item">
                        <div class="review-header">
                            <div class="reviewer-info">
                                <div class="reviewer-name">Sarah J.</div>
                                <div class="verified-badge">
                                    <i class="fas fa-check-circle"></i> Verified Customer
                                    </div>
                                </div>
                            <div class="review-date">2 days ago</div>
                                    </div>
                        <div class="review-rating">★★★★★</div>
                        <div class="review-text">
                            "Amazing service! The stylist really understood what I wanted and my hair looks fantastic. 
                            The salon is clean and professional. Highly recommend!"
                                </div>
                        <!-- Business Reply -->
                        <div class="business-reply">
                            <div class="reply-header">
                                <div class="reply-label">
                                    <i class="fas fa-store"></i> Business Reply
                                </div>
                                <div class="reply-date">1 day ago</div>
                            </div>
                            <div class="reply-text">
                                "Thank you so much Sarah! We're thrilled you loved your experience. 
                                We look forward to seeing you again soon!"
                            </div>
                            </div>
                        </div>
                        
                    <!-- Review 2 -->
                            <div class="review-item">
                                <div class="review-header">
                                    <div class="reviewer-info">
                                <div class="reviewer-name">Michael B.</div>
                                <div class="verified-badge">
                                    <i class="fas fa-check-circle"></i> Verified Customer
                                    </div>
                                </div>
                            <div class="review-date">1 week ago</div>
                        </div>
                        <div class="review-rating">★★★★★</div>
                                <div class="review-text">
                            "Best haircut I've had in years! The barber was professional and took his time. 
                            Great atmosphere and friendly staff."
                                </div>
                            </div>
                            
                    <!-- Review 3 -->
                            <div class="review-item">
                                <div class="review-header">
                                    <div class="reviewer-info">
                                <div class="reviewer-name">Emma W.</div>
                                <div class="verified-badge">
                                    <i class="fas fa-check-circle"></i> Verified Customer
                                    </div>
                                </div>
                            <div class="review-date">2 weeks ago</div>
                        </div>
                        <div class="review-rating">★★★★☆</div>
                                <div class="review-text">
                            "Good service overall. The stylist was friendly and the cut was nice, 
                            though it took a bit longer than expected. Would recommend."
                        </div>
                        <!-- Business Reply -->
                        <div class="business-reply">
                            <div class="reply-header">
                                <div class="reply-label">
                                    <i class="fas fa-store"></i> Business Reply
                                </div>
                                <div class="reply-date">2 weeks ago</div>
                            </div>
                            <div class="reply-text">
                                "Thank you for your feedback Emma! We appreciate your patience and are glad you enjoyed the service. 
                                We're always working to improve our efficiency."
                            </div>
                                </div>
                            </div>
                            
                    <!-- Review 4 -->
                            <div class="review-item">
                                <div class="review-header">
                                    <div class="reviewer-info">
                                <div class="reviewer-name">David L.</div>
                                <div class="verified-badge">
                                    <i class="fas fa-check-circle"></i> Verified Customer
                                    </div>
                                </div>
                            <div class="review-date">3 weeks ago</div>
                        </div>
                        <div class="review-rating">★★★★★</div>
                                <div class="review-text">
                            "Excellent experience from start to finish. Professional team, great atmosphere, 
                            and my hair looks amazing. Will definitely be back!"
                                </div>
                            </div>
                            
                    <!-- Review 5 -->
                            <div class="review-item">
                                <div class="review-header">
                                    <div class="reviewer-info">
                                <div class="reviewer-name">Lisa M.</div>
                                <div class="verified-badge">
                                    <i class="fas fa-check-circle"></i> Verified Customer
                                    </div>
                                </div>
                            <div class="review-date">1 month ago</div>
                        </div>
                        <div class="review-rating">★★★☆☆</div>
                                <div class="review-text">
                            "The service was okay, but I had to wait longer than my appointment time. 
                            The stylist was friendly though and the end result was decent."
                                </div>
                        <!-- Business Reply -->
                        <div class="business-reply">
                            <div class="reply-header">
                                <div class="reply-label">
                                    <i class="fas fa-store"></i> Business Reply
                            </div>
                                <div class="reply-date">1 month ago</div>
                            </div>
                            <div class="reply-text">
                                "Thank you for your feedback Lisa. We apologize for the wait time and are working to improve our scheduling. 
                                We're glad you were happy with the final result and hope to serve you better next time."
                            </div>
                        </div>
                    </div>
                </div>
                        </div>
                    </div>
                </div>
                
    <!-- Cancellation Policy Modal -->
    <div id="cancellationPolicyModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-black/90 backdrop-blur-md rounded-2xl p-8 max-w-2xl w-full border border-white/10">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-bold gradient-text" id="policyModalTitle">Cancellation Policy</h3>
                    <button onclick="closeCancellationPolicyModal()" class="text-white/70 hover:text-white">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <div class="policy-content" id="policyModalContent">
                    <!-- Policy content will be loaded here -->
                </div>
            </div>
                        </div>
                    </div>
                    
    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 BlkPages – Supporting Black-owned Businesses</p>
                </div>
    </footer>

    <script>
        // Global variables
        let selectedServices = [];
        let selectedDate = null;
        let selectedTime = null;
        let selectedPayment = null;
        
        // Add service function - make it globally accessible
        window.addService = function(name, price, duration) {
            console.log('addService called with:', name, price, duration);
            // Add service to selection
            selectedServices.push({ name, price, duration });
            
            // Clear services error if any
            clearServicesError();
            
            // Update button appearance
            const buttons = document.querySelectorAll('.add-service-btn');
            buttons.forEach(button => {
                const onclick = button.getAttribute('onclick');
                if (onclick && onclick.includes(`'${name}'`)) {
                    button.classList.add('selected');
                    button.innerHTML = '<i class="fas fa-check"></i> Added';
                }
            });
            
            // Show booking section
            const bookingSection = document.getElementById('booking-section');
            if (bookingSection) {
                bookingSection.style.display = 'block';
            }
            
            // Show customer details section
            const customerDetails = document.getElementById('customerDetails');
            if (customerDetails) {
                customerDetails.style.display = 'block';
            }
            
            // Update selected services display
            updateSelectedServicesDisplay();
            
            // Update progress indicator and payment display
            updateProgressIndicator();
            updatePaymentModelDisplay();
            
            // Update basket count and save basket
            updateBasketCount();
            saveBasket();
        }
        
        // Update selected services display
        function updateSelectedServicesDisplay() {
            // Update the main selected services section
            const selectedServicesDiv = document.getElementById('selected-services');
            const selectedServicesList = document.getElementById('selected-services-list');
            const totalPriceSpan = document.getElementById('total-price');
            
            if (selectedServices.length === 0) {
                if (selectedServicesDiv) selectedServicesDiv.style.display = 'none';
                return;
            }
            
            if (selectedServicesDiv) selectedServicesDiv.style.display = 'block';
            if (selectedServicesList) selectedServicesList.innerHTML = '';
            
            let totalPrice = 0;
            selectedServices.forEach(service => {
                const serviceItem = document.createElement('div');
                serviceItem.className = 'selected-service-item';
                serviceItem.innerHTML = `
                    <div class="selected-service-info">
                        <div class="selected-service-name">${service.name}</div>
                        <div class="selected-service-price">£${service.price}</div>
                    </div>
                    <button class="remove-service-btn" onclick="event.stopPropagation(); removeService('${service.name}')">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                if (selectedServicesList) selectedServicesList.appendChild(serviceItem);
                totalPrice += service.price;
            });
            
            if (totalPriceSpan) {
                totalPriceSpan.textContent = totalPrice;
            }
            
            // Also update the booking summary section
            updateBookingSummarySection();
            
            // Update the booking services list in the "Complete Your Booking" section
            updateBookingServicesList();
        }
        
        // Update booking summary section
        function updateBookingSummarySection() {
            const summaryServicesList = document.getElementById('summaryServicesList');
            const summaryTotalPrice = document.getElementById('summaryTotalPrice');
            
            if (!summaryServicesList) return;
            
            summaryServicesList.innerHTML = '';
            let totalPrice = 0;
            let totalDuration = 0;
            
            selectedServices.forEach(service => {
                const serviceItem = document.createElement('div');
                serviceItem.className = 'summary-service-item';
                serviceItem.innerHTML = `
                    <div class="summary-service-name">${service.name}</div>
                    <div class="summary-service-price">£${service.price}</div>
                `;
                summaryServicesList.appendChild(serviceItem);
                totalPrice += service.price;
                totalDuration += service.duration;
            });
            
            if (summaryTotalPrice) {
                summaryTotalPrice.textContent = totalPrice;
            }
            
            // Update duration in the booking summary
            const summaryDuration = document.getElementById('summaryDuration');
            if (summaryDuration) {
                summaryDuration.textContent = `${totalDuration} min`;
            }
        }
        
        // Remove service function
        window.removeService = function(name) {
            selectedServices = selectedServices.filter(service => service.name !== name);
            
            // Reset button appearance
            const buttons = document.querySelectorAll('.add-service-btn');
            buttons.forEach(button => {
                const onclick = button.getAttribute('onclick');
                if (onclick && onclick.includes(`'${name}'`)) {
                    button.classList.remove('selected');
                    button.innerHTML = '<i class="fas fa-plus"></i> Add';
                }
            });
            
            // Update display
            updateSelectedServicesDisplay();
            
            // Update basket count and save basket
            updateBasketCount();
            saveBasket();
            
            // Hide booking section if no services and clear date/time
            if (selectedServices.length === 0) {
                const bookingSection = document.getElementById('booking-section');
                if (bookingSection) {
                    bookingSection.style.display = 'none';
                }
                
                // Clear date and time selections when basket is empty
                clearDateAndTime();
            }
        }
        
        // Date and time selection functions
        function selectDate(day, month, year) {
            selectedDate = new Date(year, month, day);
            document.querySelectorAll('.calendar-day').forEach(el => el.classList.remove('selected'));
            event.target.classList.add('selected');
            
            // Clear date error if any
            clearDateError();
            
            // Generate time slots for selected date
            generateTimeSlots();
        }
        
        function selectTime(time) {
            selectedTime = time;
            document.querySelectorAll('.time-slot').forEach(el => el.classList.remove('selected'));
            event.target.classList.add('selected');
            
            // Clear time error if any
            clearTimeError();
        }
        
        function generateTimeSlots() {
            const timeSlots = document.getElementById('timeSlots');
            const slots = [
                { time: '9:00 AM', available: true },
                { time: '10:00 AM', available: true },
                { time: '11:00 AM', available: true },
                { time: '12:00 PM', available: true },
                { time: '1:00 PM', available: true },
                { time: '2:00 PM', available: true },
                { time: '3:00 PM', available: true },
                { time: '4:00 PM', available: true },
                { time: '5:00 PM', available: true }
            ];
            
            timeSlots.innerHTML = '';
            slots.forEach(slot => {
                const slotElement = document.createElement('div');
                slotElement.className = 'time-slot';
                slotElement.textContent = slot.time;
                
                if (slot.available) {
                    slotElement.onclick = () => selectTime(slot.time);
                }
                
                timeSlots.appendChild(slotElement);
            });
        }
        
        
        // Book appointment function with step-by-step validation
        function bookAppointment() {
            // Clear any existing errors
            clearAllErrors();
            
            // Step 1: Check if services are selected
            if (selectedServices.length === 0) {
                showServicesError();
                return;
            }
            
            // Step 2: Check if date is selected
            if (!selectedDate) {
                showDateError();
                return;
            }
            
            // Step 3: Check if time is selected
            if (!selectedTime) {
                showTimeError();
                return;
            }
            
            // Step 4: Check customer details one by one with UK-specific validation
            const fullName = document.getElementById('fullName').value.trim();
            const nameValidation = validateName(fullName);
            if (!nameValidation.isValid) {
                showFieldError('fullName', nameValidation.message);
                return;
            }
            
            const email = document.getElementById('email').value.trim();
            const emailValidation = validateEmail(email);
            if (!emailValidation.isValid) {
                showFieldError('email', emailValidation.message);
                return;
            }
            
            const phone = document.getElementById('phone').value.trim();
            const phoneValidation = validatePhone(phone);
            if (!phoneValidation.isValid) {
                showFieldError('phone', phoneValidation.message);
                return;
            }
            
            const postcode = document.getElementById('postcode').value.trim();
            const postcodeValidation = validatePostcode(postcode);
            if (!postcodeValidation.isValid) {
                showFieldError('postcode', postcodeValidation.message);
                return;
            }
            
            // Step 5: Check terms acceptance
            if (!document.getElementById('acceptTerms').checked) {
                showTermsError();
                return;
            }
            
            // All validations passed - show booking summary
            showBookingSummary();
        }
        
        // Clear all error states
        function clearAllErrors() {
            document.querySelectorAll('.error').forEach(el => el.classList.remove('error'));
            document.querySelectorAll('.inline-error').forEach(el => el.remove());
            document.querySelectorAll('.field-error').forEach(el => el.remove());
            document.querySelectorAll('.error-border').forEach(el => el.classList.remove('error-border'));
            document.querySelectorAll('.services-error').forEach(el => el.remove());
        }
        
        // Enhanced UK-specific validation functions
        function validateName(name) {
            if (!name || !name.trim()) {
                return { isValid: false, message: 'Please enter your full name.' };
            }
            
            const trimmedName = name.trim();
            
            // Check minimum length
            if (trimmedName.length < 2) {
                return { isValid: false, message: 'Name must be at least 2 characters long.' };
            }
            
            // Check maximum length
            if (trimmedName.length > 50) {
                return { isValid: false, message: 'Name must be 50 characters or less.' };
            }
            
            // Check if only one word (no space)
            if (!trimmedName.includes(' ')) {
                return { isValid: false, message: 'Please enter your first and last name.' };
            }
            
            // Check for invalid characters (only letters, hyphens, apostrophes, and spaces)
            const nameRegex = /^[a-zA-Z\s\-']+$/;
            if (!nameRegex.test(trimmedName)) {
                return { isValid: false, message: 'Names can only include letters, hyphens, or apostrophes.' };
            }
            
            // Check for consecutive spaces
            if (trimmedName.includes('  ')) {
                return { isValid: false, message: 'Name cannot contain consecutive spaces.' };
            }
            
            // Check for names starting or ending with spaces, hyphens, or apostrophes
            if (trimmedName.startsWith(' ') || trimmedName.endsWith(' ') ||
                trimmedName.startsWith('-') || trimmedName.endsWith('-') ||
                trimmedName.startsWith("'") || trimmedName.endsWith("'")) {
                return { isValid: false, message: 'Name cannot start or end with spaces, hyphens, or apostrophes.' };
            }
            
            return { isValid: true };
        }
        
        function validateEmail(email) {
            if (!email || !email.trim()) {
                return { isValid: false, message: 'Please enter your email address.' };
            }
            
            const trimmedEmail = email.trim();
            
            // Check maximum length
            if (trimmedEmail.length > 254) {
                return { isValid: false, message: 'Email address is too long (maximum 254 characters).' };
            }
            
            // Enhanced email regex for better validation
            const emailRegex = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;
            if (!emailRegex.test(trimmedEmail)) {
                return { isValid: false, message: 'Please enter a valid email address (e.g., name@example.com).' };
            }
            
            // Check for consecutive dots
            if (trimmedEmail.includes('..')) {
                return { isValid: false, message: 'Email cannot contain consecutive dots.' };
            }
            
            // Check for spaces
            if (trimmedEmail.includes(' ')) {
                return { isValid: false, message: 'Email cannot contain spaces.' };
            }
            
            return { isValid: true };
        }
        
        function validatePhone(phone) {
            if (!phone || !phone.trim()) {
                return { isValid: false, message: 'Please enter your phone number.' };
            }
            
            const trimmedPhone = phone.trim();
            
            // Remove all spaces, hyphens, and parentheses for validation
            const cleanPhone = trimmedPhone.replace(/[\s\-\(\)]/g, '');
            
            // Check if phone contains only valid characters
            const validPhoneRegex = /^[\d\+\s\-\(\)]+$/;
            if (!validPhoneRegex.test(trimmedPhone)) {
                return { isValid: false, message: 'Phone number can only contain digits, spaces, hyphens, parentheses, and + sign.' };
            }
            
            // Check minimum length (UK numbers are at least 10 digits)
            if (cleanPhone.length < 10) {
                return { isValid: false, message: 'Phone number is too short. UK numbers must be at least 10 digits.' };
            }
            
            // Check maximum length (UK numbers are at most 15 digits including country code)
            if (cleanPhone.length > 15) {
                return { isValid: false, message: 'Phone number is too long. Please check your number.' };
            }
            
            // UK phone number patterns
            const ukMobileRegex = /^(\+44|0)7[0-9]{9}$/; // Mobile numbers starting with 07
            const ukLandlineRegex = /^(\+44|0)[1-9][0-9]{8,9}$/; // Landline numbers
            const ukSpecialRegex = /^(\+44|0)800[0-9]{6,7}$/; // Freephone numbers
            const ukPremiumRegex = /^(\+44|0)9[0-9]{8,9}$/; // Premium rate numbers
            
            if (!ukMobileRegex.test(cleanPhone) && 
                !ukLandlineRegex.test(cleanPhone) && 
                !ukSpecialRegex.test(cleanPhone) && 
                !ukPremiumRegex.test(cleanPhone)) {
                return { isValid: false, message: 'Please enter a valid UK phone number (mobile, landline, freephone, or premium rate).' };
            }
            
            return { isValid: true };
        }
        
        function validatePostcode(postcode) {
            if (!postcode || !postcode.trim()) {
                return { isValid: false, message: 'Please enter your postcode.' };
            }
            
            const trimmedPostcode = postcode.trim().toUpperCase();
            
            // Check maximum length
            if (trimmedPostcode.length > 8) {
                return { isValid: false, message: 'Postcode is too long. UK postcodes are maximum 8 characters.' };
            }
            
            // Check minimum length
            if (trimmedPostcode.length < 5) {
                return { isValid: false, message: 'Postcode is too short. UK postcodes are minimum 5 characters.' };
            }
            
            // Enhanced UK postcode regex pattern with more comprehensive coverage
            const ukPostcodeRegex = /^[A-Z]{1,2}[0-9R][0-9A-Z]? [0-9][A-Z]{2}$/;
            
            if (!ukPostcodeRegex.test(trimmedPostcode)) {
                return { isValid: false, message: 'Please enter a valid UK postcode (e.g., SW1A 1AA, M1 1AA, B33 8TH).' };
            }
            
            // Additional validation for specific invalid patterns
            if (trimmedPostcode.includes('  ')) {
                return { isValid: false, message: 'Postcode cannot contain consecutive spaces.' };
            }
            
            return { isValid: true };
        }

        // Individual error functions
        function showServicesError() {
            const servicesSection = document.querySelector('.services-section') || document.getElementById('services-section');
            if (servicesSection) {
                servicesSection.classList.add('error');
                servicesSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
                
                // Remove existing error
                const existingError = servicesSection.querySelector('.services-error');
                if (existingError) existingError.remove();
                
                // Add new error message
                const errorDiv = document.createElement('div');
                errorDiv.className = 'services-error';
                errorDiv.innerHTML = '<i class="fas fa-exclamation-circle"></i> Please select a service to continue.';
                servicesSection.appendChild(errorDiv);
            }
        }
        
        function showDateError() {
            const bookingSection = document.getElementById('booking-section');
            if (bookingSection) {
                bookingSection.classList.add('error');
                bookingSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
                
                // Remove existing error
                const existingError = bookingSection.querySelector('.date-error');
                if (existingError) existingError.remove();
                
                // Add new error message
                const errorDiv = document.createElement('div');
                errorDiv.className = 'field-error date-error';
                errorDiv.innerHTML = '<i class="fas fa-exclamation-circle"></i> Please select a date to continue.';
                
                const calendarContainer = bookingSection.querySelector('.booking-calendar');
                if (calendarContainer) {
                    calendarContainer.appendChild(errorDiv);
                }
            }
        }
        
        function showTimeError() {
            const bookingSection = document.getElementById('booking-section');
            if (bookingSection) {
                bookingSection.classList.add('error');
                bookingSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
                
                // Remove existing error
                const existingError = bookingSection.querySelector('.time-error');
                if (existingError) existingError.remove();
                
                // Add new error message
                const errorDiv = document.createElement('div');
                errorDiv.className = 'field-error time-error';
                errorDiv.innerHTML = '<i class="fas fa-exclamation-circle"></i> Please select a time to continue.';
                
                const timeSlotsContainer = bookingSection.querySelector('.time-slots');
                if (timeSlotsContainer) {
                    timeSlotsContainer.appendChild(errorDiv);
                }
            }
        }
        
        function showFieldError(fieldId, message) {
            const field = document.getElementById(fieldId);
            if (field) {
                field.classList.add('error-border');
                field.scrollIntoView({ behavior: 'smooth', block: 'center' });
                field.focus();
                
                // Remove existing error
                const existingError = field.parentNode.querySelector('.field-error');
                if (existingError) existingError.remove();
                
                // Add new error message
                const errorDiv = document.createElement('div');
                errorDiv.className = 'field-error';
                errorDiv.innerHTML = `<i class="fas fa-exclamation-circle"></i> ${message}`;
                field.parentNode.appendChild(errorDiv);
            }
        }
        
        function showTermsError() {
            const termsCheckbox = document.getElementById('acceptTerms');
            if (termsCheckbox) {
                termsCheckbox.scrollIntoView({ behavior: 'smooth', block: 'center' });
                termsCheckbox.focus();
                
                // Remove existing error
                const existingError = termsCheckbox.parentNode.querySelector('.field-error');
                if (existingError) existingError.remove();
                
                // Add new error message
                const errorDiv = document.createElement('div');
                errorDiv.className = 'field-error';
                errorDiv.innerHTML = '<i class="fas fa-exclamation-circle"></i> Please accept the terms and conditions.';
                termsCheckbox.parentNode.appendChild(errorDiv);
            }
        }
        
        // Clear individual error functions
        function clearFieldError(fieldId) {
            const field = document.getElementById(fieldId);
            if (field) {
                field.classList.remove('error-border');
                const error = field.parentNode.querySelector('.field-error');
                if (error) error.remove();
            }
        }
        
        function clearServicesError() {
            const servicesSection = document.querySelector('.services-section') || document.getElementById('services-section');
            if (servicesSection) {
                servicesSection.classList.remove('error');
                const error = servicesSection.querySelector('.services-error');
                if (error) error.remove();
            }
        }
        
        function clearDateError() {
            const bookingSection = document.getElementById('booking-section');
            if (bookingSection) {
                bookingSection.classList.remove('error');
                const error = bookingSection.querySelector('.date-error');
                if (error) error.remove();
            }
        }
        
        function clearTimeError() {
            const bookingSection = document.getElementById('booking-section');
            if (bookingSection) {
                bookingSection.classList.remove('error');
                const error = bookingSection.querySelector('.time-error');
                if (error) error.remove();
            }
        }
        
        function clearTermsError() {
            const termsCheckbox = document.getElementById('acceptTerms');
            if (termsCheckbox) {
                const error = termsCheckbox.parentNode.querySelector('.field-error');
                if (error) error.remove();
            }
        }
        
        // Update booking button state
        function updateCompleteBookingButton() {
            // This function can be used to update the booking button state
            // For now, it's a placeholder to prevent the error
        }
        
        // Update booking button when terms are accepted
        function updateBookingButton() {
            // This function is called when the terms checkbox changes
            // For now, it's a placeholder to prevent the error
        }
        
        // Scroll to booking section (without scrolling to end of page)
        function scrollToBooking() {
            const bookingSection = document.getElementById('booking-section');
            if (bookingSection) {
                bookingSection.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'start' 
                });
            }
        }
        
        // Real-time validation - clear errors when user corrects input
        function setupRealTimeValidation() {
            // Name field validation
            const nameField = document.getElementById('fullName');
            if (nameField) {
                nameField.addEventListener('input', function() {
                    const nameValidation = validateName(this.value.trim());
                    if (nameValidation.isValid) {
                        clearFieldError('fullName');
                    }
                });
            }
            
            // Email field validation
            const emailField = document.getElementById('email');
            if (emailField) {
                emailField.addEventListener('input', function() {
                    const emailValidation = validateEmail(this.value.trim());
                    if (emailValidation.isValid) {
                        clearFieldError('email');
                    }
                });
            }
            
            // Phone field validation
            const phoneField = document.getElementById('phone');
            if (phoneField) {
                phoneField.addEventListener('input', function() {
                    const phoneValidation = validatePhone(this.value.trim());
                    if (phoneValidation.isValid) {
                        clearFieldError('phone');
                    }
                });
            }
            
            // Postcode field validation
            const postcodeField = document.getElementById('postcode');
            if (postcodeField) {
                postcodeField.addEventListener('input', function() {
                    const postcodeValidation = validatePostcode(this.value.trim());
                    if (postcodeValidation.isValid) {
                        clearFieldError('postcode');
                    }
                });
            }
            
            // Terms checkbox validation
            const termsCheckbox = document.getElementById('acceptTerms');
            if (termsCheckbox) {
                termsCheckbox.addEventListener('change', function() {
                    if (this.checked) {
                        clearTermsError();
                    }
                });
            }
        }
        
        // Step-by-step validation functions
        function scrollToServicesAndShowError() {
            const servicesSection = document.querySelector('.services-section') || document.getElementById('services-section');
            if (servicesSection) {
                servicesSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
                showInlineError(servicesSection, 'Please select a service to continue.');
            }
        }
        
        function scrollToDateAndShowError() {
            const bookingSection = document.getElementById('booking-section');
            if (bookingSection) {
                bookingSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
                showInlineError(bookingSection, 'Please select a date and time to continue.');
            }
        }
        
        function scrollToFieldAndShowError(field, message) {
            if (field) {
                field.scrollIntoView({ behavior: 'smooth', block: 'center' });
                field.focus();
                showInlineError(field, message);
            }
        }
        
        function scrollToTermsAndShowError() {
            const termsCheckbox = document.getElementById('acceptTerms');
            if (termsCheckbox) {
                termsCheckbox.scrollIntoView({ behavior: 'smooth', block: 'center' });
                showInlineError(termsCheckbox, 'Please accept the terms and conditions to continue.');
            }
        }
        
        // Show inline error message
        function showInlineError(element, message) {
            // Remove any existing error message
            const existingError = element.parentNode.querySelector('.inline-error');
            if (existingError) {
                existingError.remove();
            }
            
            // Add error class to element
            element.classList.add('error');
            
            // Create inline error message
            const errorDiv = document.createElement('div');
            errorDiv.className = 'inline-error';
            errorDiv.textContent = message;
            errorDiv.style.cssText = 'color: #ef4444; font-size: 0.875rem; margin-top: 0.5rem; display: block;';
            
            // Insert error message after the element
            element.parentNode.insertBefore(errorDiv, element.nextSibling);
            
            // Remove error when user interacts with the field
            const removeError = () => {
                element.classList.remove('error');
                if (errorDiv.parentNode) {
                    errorDiv.remove();
                }
            };
            
            if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                element.addEventListener('input', removeError, { once: true });
            } else {
                element.addEventListener('click', removeError, { once: true });
            }
        }
        
        // UK-specific customer details validation
        function validateCustomerDetails() {
            const fullName = document.getElementById('fullName');
            const email = document.getElementById('email');
            const phone = document.getElementById('phone');
            const postcode = document.getElementById('postcode');
            
            // Validate Full Name
            if (!fullName || !fullName.value.trim()) {
                return { isValid: false, field: fullName, message: 'Please enter your full name.' };
            }
            
            // Check if name has at least 2 words (first and last)
            const nameWords = fullName.value.trim().split(/\s+/);
            if (nameWords.length < 2) {
                return { isValid: false, field: fullName, message: 'Please enter your first and last name.' };
            }
            
            // Validate name format (letters, hyphens, apostrophes only)
            const nameRegex = /^(?=.{2,50}$)[A-Za-z]+(?:['-][A-Za-z]+)?\s+[A-Za-z]+(?:['-][A-Za-z]+)?$/;
            if (!nameRegex.test(fullName.value.trim())) {
                return { isValid: false, field: fullName, message: 'Names can only include letters, hyphens, or apostrophes.' };
            }
            
            // Validate Email
            if (!email || !email.value.trim()) {
                return { isValid: false, field: email, message: 'Please enter your email address.' };
            }
            
            const emailRegex = /^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/;
            if (!emailRegex.test(email.value.trim())) {
                return { isValid: false, field: email, message: 'Please enter a valid email address (e.g., name@example.com).' };
            }
            
            // Validate UK Phone Number
            if (!phone || !phone.value.trim()) {
                return { isValid: false, field: phone, message: 'Please enter your phone number.' };
            }
            
            // Remove spaces and dashes for validation
            const cleanPhone = phone.value.replace(/[\s-]/g, '');
            const ukMobileRegex = /^(07\d{9})$/;
            const ukLandlineRegex = /^(0(1|2|3)\d{8,9})$/;
            
            if (!ukMobileRegex.test(cleanPhone) && !ukLandlineRegex.test(cleanPhone)) {
                return { isValid: false, field: phone, message: 'Please enter a valid UK mobile or landline number.' };
            }
            
            // Validate UK Postcode
            if (!postcode || !postcode.value.trim()) {
                return { isValid: false, field: postcode, message: 'Please enter your postcode.' };
            }
            
            const ukPostcodeRegex = /^([Gg][Ii][Rr] 0[Aa]{2}|(([A-PR-UWYZ][0-9][0-9]?|[A-PR-UWYZ][A-HK-Y][0-9][0-9]?|[A-PR-UWYZ][0-9][A-HJKSTUW]|[A-PR-UWYZ][A-HK-Y][0-9][ABEHMNPRVWXY]))\s?[0-9][ABD-HJLNP-UW-Z]{2})$/;
            if (!ukPostcodeRegex.test(postcode.value.trim().toUpperCase())) {
                return { isValid: false, field: postcode, message: 'Please enter a valid UK postcode (e.g., SW1A 1AA).' };
            }
            
            return { isValid: true };
        }
        
        // Show booking summary
        function showBookingSummary() {
            const totalPrice = selectedServices.reduce((sum, service) => sum + service.price, 0);
            
            const summary = `
                <div style="background: white; padding: 2rem; border-radius: 8px; max-width: 500px; margin: 2rem auto;">
                    <h3 style="color: #333; margin-bottom: 1rem;">Booking Summary</h3>
                    
                    <div style="margin-bottom: 1rem;">
                        <h4 style="color: #666; margin-bottom: 0.5rem;">Services</h4>
                        ${selectedServices.map(service => `
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.25rem;">
                                <span>${service.name}</span>
                                <span>£${service.price}</span>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <h4 style="color: #666; margin-bottom: 0.5rem;">Appointment</h4>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.25rem;">
                            <span>Date</span>
                            <span>${selectedDate.toLocaleDateString()}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.25rem;">
                            <span>Time</span>
                            <span>${selectedTime}</span>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <h4 style="color: #666; margin-bottom: 0.5rem;">Total</h4>
                        <div style="display: flex; justify-content: space-between; font-weight: bold; font-size: 1.2rem;">
                            <span>£${totalPrice}</span>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                        <button onclick="confirmBooking()" style="flex: 1; background: #FF3CAC; color: white; padding: 0.75rem; border: none; border-radius: 4px; cursor: pointer;">
                            Confirm Booking
                        </button>
                        <button onclick="closeModal()" style="flex: 1; background: #666; color: white; padding: 0.75rem; border: none; border-radius: 4px; cursor: pointer;">
                            Cancel
                        </button>
                    </div>
                </div>
            `;
            
            showModal(summary);
        }
        
        // Show modal
        function showModal(content) {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1000;
            `;
            modal.innerHTML = content;
            modal.id = 'bookingModal';
            document.body.appendChild(modal);
        }
        
        // Close modal
        function closeModal() {
            const modal = document.getElementById('bookingModal');
            if (modal) {
                modal.remove();
            }
        }
        
        // Confirm booking
        function confirmBooking() {
            closeModal();
            alert('Your booking is confirmed! 🎉');
        }
        
        // Progress indicator functions
        function updateProgressIndicator() {
            const step1 = document.getElementById('step1');
            const step2 = document.getElementById('step2');
            const step3 = document.getElementById('step3');
            const step4 = document.getElementById('step4');
            
            // Reset all steps
            [step1, step2, step3, step4].forEach(step => {
                step.classList.remove('current', 'completed');
                const circle = step.querySelector('.step-circle');
                circle.classList.remove('current', 'completed', 'pending');
                circle.classList.add('pending');
            });
            
            // Step 1: Service selection
            if (selectedServices.length > 0) {
                step1.classList.add('completed');
                step1.querySelector('.step-circle').classList.remove('pending');
                step1.querySelector('.step-circle').classList.add('completed');
            } else {
                step1.classList.add('current');
                step1.querySelector('.step-circle').classList.remove('pending');
                step1.querySelector('.step-circle').classList.add('current');
                return;
            }
            
            // Step 2: Date and time
            if (selectedDate && selectedTime) {
                step2.classList.add('completed');
                step2.querySelector('.step-circle').classList.remove('pending');
                step2.querySelector('.step-circle').classList.add('completed');
            } else {
                step2.classList.add('current');
                step2.querySelector('.step-circle').classList.remove('pending');
                step2.querySelector('.step-circle').classList.add('current');
                return;
            }
            
            // Step 3: Customer details
            const fullName = document.getElementById('fullName');
            const email = document.getElementById('email');
            const phone = document.getElementById('phone');
            const postcode = document.getElementById('postcode');
            const terms = document.getElementById('acceptTerms');
            
            if (fullName?.value.trim() && email?.value.trim() && phone?.value.trim() && postcode?.value.trim() && terms?.checked) {
                step3.classList.add('completed');
                step3.querySelector('.step-circle').classList.remove('pending');
                step3.querySelector('.step-circle').classList.add('completed');
                
                step4.classList.add('current');
                step4.querySelector('.step-circle').classList.remove('pending');
                step4.querySelector('.step-circle').classList.add('current');
            } else {
                step3.classList.add('current');
                step3.querySelector('.step-circle').classList.remove('pending');
                step3.querySelector('.step-circle').classList.add('current');
            }
        }
        
        // Payment model display function
        function updatePaymentModelDisplay() {
            const paymentModelInfo = document.getElementById('paymentModelInfo');
            const paymentOptions = document.getElementById('paymentOptions');
            
            // Calculate total (use 0 if no services selected)
            const total = selectedServices.length > 0 ? selectedServices.reduce((sum, service) => sum + service.price, 0) : 0;
            
            // In real implementation, this would come from business data
            const businessPaymentModel = 'deposit-balance'; // Options: 'full-online', 'deposit-balance', 'full-venue'
            const depositPercentage = 30; // In real implementation, this would come from business data
            
            let paymentModelHTML = '';
            let paymentOptionsHTML = '';
            
            // If no services selected, show placeholder message
            if (total === 0) {
                paymentModelHTML = `
                    <h4>Payment Information</h4>
                    <div class="payment-details">
                        <p>No current services selected. Select services above to see payment information.</p>
                    </div>
                `;
                paymentOptionsHTML = '';
            } else {
                // Show payment information based on business model
                switch (businessPaymentModel) {
                    case 'full-online':
                        paymentModelHTML = `
                            <h4>Payment Information</h4>
                            <div class="payment-details">
                                <p><strong>Full Payment Online</strong></p>
                                <p>Total Amount: <strong>£${total}</strong></p>
                                <p>You will be charged the full amount when you complete your booking.</p>
                            </div>
                        `;
                        break;
                        
                    case 'deposit-balance':
                        const depositAmount = Math.round(total * (depositPercentage / 100));
                        const balanceAmount = total - depositAmount;
                        paymentModelHTML = `
                            <h4>Payment Information</h4>
                            <div class="payment-details">
                                <p><strong>Deposit + Balance at Venue</strong></p>
                                <p>Deposit (${depositPercentage}%): <strong>£${depositAmount}</strong></p>
                                <p>Balance at Venue: <strong>£${balanceAmount}</strong></p>
                                <p>Total: <strong>£${total}</strong></p>
                            </div>
                        `;
                        break;
                        
                    case 'full-venue':
                        paymentModelHTML = `
                            <h4>Payment Information</h4>
                            <div class="payment-details">
                                <p><strong>Pay at Venue</strong></p>
                                <p>Total Amount: <strong>£${total}</strong></p>
                                <p>No payment required online. Pay when you arrive.</p>
                            </div>
                        `;
                        break;
                }
            }
            
            if (paymentModelInfo) {
                paymentModelInfo.innerHTML = paymentModelHTML;
            }
            if (paymentOptions) {
                paymentOptions.innerHTML = paymentOptionsHTML;
            }
        }
        
        // Initialize progress tracking
        function initializeProgressTracking() {
            // Update progress when services are added/removed
            document.addEventListener('click', function(e) {
                if (e.target.closest('.add-service-btn') || e.target.closest('.remove-service-btn')) {
                    setTimeout(updateProgressIndicator, 100);
                }
            });
            
            // Update progress when form fields change
            const formInputs = document.querySelectorAll('#fullName, #email, #phone, #postcode, #acceptTerms');
            formInputs.forEach(input => {
                input.addEventListener('input', updateProgressIndicator);
                input.addEventListener('change', updateProgressIndicator);
            });
            
            // Update progress when date/time is selected
            document.addEventListener('click', function(e) {
                if (e.target.closest('.calendar-day') || e.target.closest('.time-slot')) {
                    setTimeout(updateProgressIndicator, 100);
                }
            });
        }
        
        // Page loaded
        window.addEventListener('load', function() {
            console.log('Page loaded successfully!');
            // Ensure page starts at the top
            window.scrollTo(0, 0);
        });
        
        // Also ensure page starts at top when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            window.scrollTo(0, 0);
        });
        
        // Gallery functionality
        let currentSlideIndex = 0;
        let slides = document.querySelectorAll('.gallery-slide');
        let dots = document.querySelectorAll('.gallery-dot');
        let uploadedPhotos = []; // Added this line
        
        function showSlide(index) {
            const slidesContainer = document.getElementById('gallerySlides');
            slidesContainer.style.transform = `translateX(-${index * 100}%)`;
            
            dots.forEach((dot, i) => {
                dot.classList.toggle('active', i === index);
            });
        }
        
        function changeSlide(direction) {
            currentSlideIndex += direction;
            if (currentSlideIndex >= slides.length) currentSlideIndex = 0;
            if (currentSlideIndex < 0) currentSlideIndex = slides.length - 1;
            showSlide(currentSlideIndex);
        }
        
        function currentSlide(index) {
            currentSlideIndex = index - 1;
            showSlide(currentSlideIndex);
        }
        
        // Auto-slide every 5 seconds
        setInterval(() => {
            changeSlide(1);
        }, 5000);
        
        // Test function to check if JavaScript is working
        function testFunction() {
            alert('JavaScript is working!');
        }
        
        // Service selection and booking functionality
        
        
        
        function clearAllBookingData() {
            console.log('Basket is empty - clearing all booking data');
            
            // Clear all booking variables
            selectedDate = null;
            selectedTime = null;
            selectedPayment = null;
            
            // Clear all form fields
            const fullName = document.getElementById('fullName');
            const email = document.getElementById('email');
            const phone = document.getElementById('phone');
            const postcode = document.getElementById('postcode');
            const acceptTerms = document.getElementById('acceptTerms');
            
            if (fullName) fullName.value = '';
            if (email) email.value = '';
            if (phone) phone.value = '';
            if (postcode) postcode.value = '';
            if (acceptTerms) acceptTerms.checked = false;
            
            // Clear all visual selections
            clearDateAndTime();
            
            // Clear payment selections
            document.querySelectorAll('.payment-option').forEach(option => option.classList.remove('selected'));
            document.querySelectorAll('.payment-method').forEach(method => method.classList.remove('selected'));
            
            // Hide booking section
            const bookingSection = document.getElementById('booking-section');
            if (bookingSection) {
                bookingSection.style.display = 'none';
            }
            
            // Show no services message
            showNoServicesMessage();
            
            // Update progress indicator
            updateProgressIndicator();
        }
        
        function clearDateAndTime() {
            // Clear selected date and time
            selectedDate = null;
            selectedTime = null;
            
            // Clear visual selections
            document.querySelectorAll('.calendar-day').forEach(el => el.classList.remove('selected'));
            document.querySelectorAll('.time-slot').forEach(el => el.classList.remove('selected'));
            
            // Clear time slots display
            const timeSlots = document.getElementById('timeSlots');
            if (timeSlots) {
                timeSlots.innerHTML = '<p class="text-center text-gray-500">Select a date to see available times</p>';
            }
        }
        
        function updateSelectedServices() {
            const selectedServicesDiv = document.getElementById('selected-services');
            const selectedServicesList = document.getElementById('selected-services-list');
            const totalPriceSpan = document.getElementById('total-price');
            
            if (selectedServices.length === 0) {
                selectedServicesDiv.style.display = 'none';
                return;
            }
            
            selectedServicesDiv.style.display = 'block';
            selectedServicesList.innerHTML = '';
            
            let totalPrice = 0;
            selectedServices.forEach(service => {
                const serviceItem = document.createElement('div');
                serviceItem.className = 'selected-service-item';
                serviceItem.innerHTML = `
                    <div class="selected-service-info">
                        <div class="selected-service-name">${service.name}</div>
                        <div class="selected-service-price">£${service.price}</div>
                    </div>
                    <button class="remove-service-btn" onclick="event.stopPropagation(); removeService('${service.name}')">
                        <i class="fas fa-times"></i>
                        </button>
                `;
                selectedServicesList.appendChild(serviceItem);
                totalPrice += service.price;
            });
            
            totalPriceSpan.textContent = totalPrice;
        }
        
        function showServiceSelection() {
            // Scroll back to services section
            document.querySelector('.services-grid').scrollIntoView({ 
                behavior: 'smooth' 
            });
        }
        
        // CTA Button functions

        function selectGuestCheckout() {
            // Hide checkout options and show customer details
            document.querySelector('.checkout-options-simple').style.display = 'none';
            document.getElementById('customerDetails').style.display = 'block';
            
            console.log('Guest checkout selected');
        }

        // Check if user is logged in and pre-fill details
        function checkUserLogin() {
            const isLoggedIn = localStorage.getItem('userLoggedIn') === 'true';
            
            if (isLoggedIn) {
                // Hide checkout options and show customer details
                document.querySelector('.checkout-options-simple').style.display = 'none';
                document.getElementById('customerDetails').style.display = 'block';
                
                // Pre-fill customer details
                const userEmail = localStorage.getItem('userEmail');
                const userName = localStorage.getItem('userName');
                const userPhone = localStorage.getItem('userPhone');
                const userPostcode = localStorage.getItem('userPostcode');
                
                if (userEmail) document.getElementById('email').value = userEmail;
                if (userName) document.getElementById('fullName').value = userName;
                if (userPhone) document.getElementById('phone').value = userPhone;
                if (userPostcode) document.getElementById('postcode').value = userPostcode;
                
                // Restore basket contents if they exist
                restoreBasketContents();
                
                console.log('User is logged in, details pre-filled and basket restored');
            }
        }

        // Save basket contents before redirecting to login/register
        function saveBasketContents() {
            const basketData = {
                selectedServices: selectedServices,
                selectedDate: selectedDate,
                selectedTime: selectedTime,
                selectedPayment: selectedPayment,
                timestamp: Date.now()
            };
            localStorage.setItem('basketContents', JSON.stringify(basketData));
            console.log('Basket contents saved:', basketData);
        }

        // Restore basket contents after login/register
        function restoreBasketContents() {
            const savedBasket = localStorage.getItem('basketContents');
            if (savedBasket) {
                try {
                    const basketData = JSON.parse(savedBasket);
                    // Only restore if it's recent (within 1 hour)
                    if (Date.now() - basketData.timestamp < 3600000) {
                        selectedServices = basketData.selectedServices || [];
                        selectedDate = basketData.selectedDate ? new Date(basketData.selectedDate) : null;
                        selectedTime = basketData.selectedTime;
                        selectedPayment = basketData.selectedPayment;
                        
                        // Update UI with restored data
                        updateSelectedServices();
                        updateBookingSummary();
                        updateBookingServicesList();
                        
                        // Show booking section if services were restored
                        if (selectedServices.length > 0) {
                            const bookingSection = document.getElementById('booking-section');
                            if (bookingSection) {
                                bookingSection.style.display = 'block';
                                initializeCalendar();
                            }
                        }
                        
                        console.log('Basket contents restored:', basketData);
                    } else {
                        // Clear old basket data
                        localStorage.removeItem('basketContents');
                    }
                } catch (error) {
                    console.error('Error restoring basket:', error);
                }
            }
        }

        // Update Payment Method Information
        function updatePaymentMethodInfo() {
            console.log('updatePaymentMethodInfo called');
            const paymentMethodText = document.getElementById('paymentMethodText');
            
            if (!paymentMethodText) {
                console.log('paymentMethodText element not found');
                return;
            }
            
            // In real implementation, this would come from business data
            const businessPaymentModel = 'deposit-balance'; // Options: 'full-online', 'deposit-balance', 'full-venue'
            const depositPercentage = 30; // In real implementation, this would come from business data
            
            let paymentMethodDescription = '';
            
            switch (businessPaymentModel) {
                case 'full-online':
                    paymentMethodDescription = 'This business accepts <strong>Full Payment Online</strong> payments. <br><br><strong>Next step:</strong> Select a service above to see pricing and payment details.';
                    break;
                    
                case 'deposit-balance':
                    paymentMethodDescription = `This business accepts <strong>Deposit Online + Balance at Venue</strong> payments (${depositPercentage}% deposit required). <br><br><strong>Next step:</strong> Select a service above to see pricing and payment details.`;
                    break;
                    
                case 'full-venue':
                    paymentMethodDescription = 'This business accepts <strong>Full Payment at Venue</strong> payments. No payment is required online - you will pay the full amount when you arrive. <br><br><strong>Next step:</strong> Select a service above to see pricing and booking details.';
                    break;
            }
            
            console.log('Setting payment method text:', paymentMethodDescription);
            paymentMethodText.innerHTML = paymentMethodDescription;
        }
        
        // Payment Model Display Function
        function updatePaymentModelDisplay() {
            console.log('updatePaymentModelDisplay called');
            
            const paymentModelInfo = document.getElementById('paymentModelInfo');
            const paymentOptions = document.getElementById('paymentOptions');
            
            console.log('paymentModelInfo element:', paymentModelInfo);
            console.log('paymentOptions element:', paymentOptions);
            
            // Calculate total (use 0 if no services selected)
            const total = selectedServices.length > 0 ? selectedServices.reduce((sum, service) => sum + service.price, 0) : 0;
            console.log('Total calculated:', total);
            
            // In real implementation, this would come from business data
            const businessPaymentModel = 'deposit-balance'; // Options: 'full-online', 'deposit-balance', 'full-venue'
            const depositPercentage = 30; // In real implementation, this would come from business data
            
            let paymentModelHTML = '';
            let paymentOptionsHTML = '';
            
            // If no services selected, show placeholder message
            if (total === 0) {
                paymentModelHTML = `
                    <h4>Payment Information</h4>
                    <div class="payment-details">
                        <p>No current services selected. Select services above to see payment information.</p>
                    </div>
                `;
                paymentOptionsHTML = '';
            } else {
                switch (businessPaymentModel) {
                case 'full-online':
                    paymentModelHTML = `
                        <h4>Full Payment Online</h4>
                        <div class="payment-details">
                            <div class="payment-amount">Full payment of £${total} due now.</div>
                            <p>Complete your booking with secure online payment. No additional payment required at the venue.</p>
                            <div class="payment-disclaimer">
                                <p><strong>Payment Processing:</strong> Payments are processed by BlkPages via Stripe, on behalf of Royal Hair Studio. Your contract of service is with Royal Hair Studio, not BlkPages.</p>
                            </div>
                        </div>
                    `;
                    paymentOptionsHTML = `
                        <div class="payment-option" onclick="selectPayment('payNow')">
                            <div class="payment-header">
                                <div class="payment-icon">
                                    <i class="fas fa-credit-card"></i>
                                </div>
                                <div>
                                    <div class="payment-title">Complete Booking</div>
                                    <div class="payment-description">Secure payment with card or digital wallet</div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'deposit-balance':
                    const depositAmount = Math.round(total * (depositPercentage / 100));
                    const balanceAmount = total - depositAmount;
                    paymentModelHTML = `
                        <h4>Deposit Online + Balance at Venue</h4>
                        <div class="payment-details">
                            <div class="payment-amount">Pay £${depositAmount} now (${depositPercentage}%), balance £${balanceAmount} at the venue.</div>
                            <p>Secure your booking with a ${depositPercentage}% deposit. Pay the remaining balance when you arrive.</p>
                            <div class="balance-info">
                                <strong>Deposit:</strong> £${depositAmount} (${depositPercentage}%)<br>
                                <strong>Balance at venue:</strong> £${balanceAmount}
                            </div>
                            <div class="payment-disclaimer">
                                <p><strong>Payment Processing:</strong> Payments are processed by BlkPages via Stripe, on behalf of Royal Hair Studio. Your contract of service is with Royal Hair Studio, not BlkPages.</p>
                            </div>
                        </div>
                    `;
                    paymentOptionsHTML = `
                        <div class="payment-option" onclick="selectPayment('payNow')">
                            <div class="payment-header">
                                <div class="payment-icon">
                                    <i class="fas fa-credit-card"></i>
                                </div>
                                <div>
                                    <div class="payment-title">Complete Booking</div>
                                    <div class="payment-description">Pay £${depositAmount} deposit online</div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'full-venue':
                    paymentModelHTML = `
                        <h4>Full Payment at Venue</h4>
                        <div class="payment-details">
                            <div class="payment-amount">No payment due now. Full balance of £${total} payable at the venue.</div>
                            <p>Book your appointment without any upfront payment. Pay the full amount when you arrive.</p>
                            <div class="payment-disclaimer">
                                <p><strong>Payment Processing:</strong> No online payment required. You will pay Royal Hair Studio directly at the venue. Your contract of service is with Royal Hair Studio, not BlkPages.</p>
                            </div>
                        </div>
                    `;
                    paymentOptionsHTML = `
                        <div class="payment-option" onclick="selectPayment('payAtVenue')">
                            <div class="payment-header">
                                <div class="payment-icon">
                                    <i class="fas fa-store"></i>
                                </div>
                                <div>
                                    <div class="payment-title">Complete Booking</div>
                                    <div class="payment-description">No payment required now - pay £${total} at the venue</div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                }
            }
            
            paymentModelInfo.innerHTML = paymentModelHTML;
            paymentOptions.innerHTML = paymentOptionsHTML;
        }
        
        // Run check on page load
        document.addEventListener('DOMContentLoaded', function() {
            checkUserLogin();
            
            // Initialize payment method info
            updatePaymentMethodInfo();
            
            // Setup real-time validation
            setupRealTimeValidation();
            
            // Initialize payment model display
            updatePaymentModelDisplay();
            
            // Initialize progress tracking
            initializeProgressTracking();
            
            // Payment buttons are now in the sidebar
            
            // Debug: Check if booking section exists
            const bookingSection = document.getElementById('booking-section');
            console.log('Page loaded - Booking section found:', bookingSection);
            console.log('Booking section display style:', bookingSection ? bookingSection.style.display : 'not found');
            
            // Initialize calendar on page load
            initializeCalendar();
        });

        // Back button function
        function goBack() {
            if (window.history.length > 1) {
                window.history.back();
            } else {
                // If no history, go to homepage
                window.location.href = 'index.html';
            }
        }

        // No services message functions
        function showNoServicesMessage() {
            const noServicesMessage = document.getElementById('noServicesMessage');
            if (noServicesMessage) {
                noServicesMessage.style.display = 'block';
                console.log('No services message shown');
            }
        }

        function hideNoServicesMessage() {
            const noServicesMessage = document.getElementById('noServicesMessage');
            if (noServicesMessage) {
                noServicesMessage.style.display = 'none';
                console.log('No services message hidden');
            }
        }

        function scrollToServices() {
            // Find the services section
            const servicesSection = document.querySelector('.services-section') || 
                                  document.querySelector('[class*="service"]') || 
                                  document.querySelector('h2') ||
                                  document.querySelector('.card');
            
            if (servicesSection) {
                servicesSection.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'start' 
                });
                console.log('Scrolled to services section');
            }
        }

        function clearAllErrors() {
            // Remove error classes from all elements
            document.querySelectorAll('.error').forEach(el => el.classList.remove('error'));
            document.querySelectorAll('.error-message').forEach(el => el.classList.remove('error-message'));
        }
        
        function showFieldError(element, message, sectionId) {
            if (!element) return;
            
            // Add error class to the element
            element.classList.add('error');
            
            // Add error message bubble
            element.classList.add('error-message');
            element.setAttribute('data-message', message);
            
            // Scroll to the section containing the error
            const section = document.getElementById(sectionId);
            if (section) {
                section.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
            
            // Remove error state after 5 seconds
            setTimeout(() => {
                element.classList.remove('error', 'error-message');
                element.removeAttribute('data-message');
            }, 5000);
        }
        
        // Step-by-step validation functions
        function scrollToServicesAndShowError() {
            const servicesSection = document.querySelector('.services-section') || document.getElementById('services-section');
            if (servicesSection) {
                servicesSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
                showInlineError(servicesSection, 'Please select a service to continue.');
            }
        }
        
        function scrollToDateAndShowError() {
            const bookingSection = document.getElementById('booking-section');
            if (bookingSection) {
                bookingSection.style.display = 'block';
                bookingSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
                showInlineError(bookingSection, 'Please select a date and time to continue.');
            }
        }
        
        function validateCustomerDetails() {
            const fullName = document.getElementById('fullName');
            const email = document.getElementById('email');
            const phone = document.getElementById('phone');
            const postcode = document.getElementById('postcode');
            
            // Validate Full Name
            if (!fullName || !fullName.value.trim()) {
                return { isValid: false, field: fullName, message: 'Please enter your full name.' };
            }
            
            // Check if name has at least 2 words (first and last)
            const nameWords = fullName.value.trim().split(/\s+/);
            if (nameWords.length < 2) {
                return { isValid: false, field: fullName, message: 'Please enter your first and last name.' };
            }
            
            // Validate name format (letters, hyphens, apostrophes only)
            const nameRegex = /^(?=.{2,50}$)[A-Za-z]+(?:['-][A-Za-z]+)?\s+[A-Za-z]+(?:['-][A-Za-z]+)?$/;
            if (!nameRegex.test(fullName.value.trim())) {
                return { isValid: false, field: fullName, message: 'Names can only include letters, hyphens, or apostrophes.' };
            }
            
            // Validate Email
            if (!email || !email.value.trim()) {
                return { isValid: false, field: email, message: 'Please enter your email address.' };
            }
            
            const emailRegex = /^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/;
            if (!emailRegex.test(email.value.trim())) {
                return { isValid: false, field: email, message: 'Please enter a valid email address (e.g., name@example.com).' };
            }
            
            // Validate UK Phone Number
            if (!phone || !phone.value.trim()) {
                return { isValid: false, field: phone, message: 'Please enter your phone number.' };
            }
            
            // Remove spaces and dashes for validation
            const cleanPhone = phone.value.replace(/[\s-]/g, '');
            const ukMobileRegex = /^(07\d{9})$/;
            const ukLandlineRegex = /^(0(1|2|3)\d{8,9})$/;
            
            if (!ukMobileRegex.test(cleanPhone) && !ukLandlineRegex.test(cleanPhone)) {
                return { isValid: false, field: phone, message: 'Please enter a valid UK mobile or landline number.' };
            }
            
            // Validate UK Postcode
            if (!postcode || !postcode.value.trim()) {
                return { isValid: false, field: postcode, message: 'Please enter your postcode.' };
            }
            
            const ukPostcodeRegex = /^([Gg][Ii][Rr] 0[Aa]{2}|(([A-PR-UWYZ][0-9][0-9]?|[A-PR-UWYZ][A-HK-Y][0-9][0-9]?|[A-PR-UWYZ][0-9][A-HJKSTUW]|[A-PR-UWYZ][A-HK-Y][0-9][ABEHMNPRVWXY]))\s?[0-9][ABD-HJLNP-UW-Z]{2})$/;
            if (!ukPostcodeRegex.test(postcode.value.trim().toUpperCase())) {
                return { isValid: false, field: postcode, message: 'Please enter a valid UK postcode (e.g., SW1A 1AA).' };
            }
            
            return { isValid: true };
        }
        
        function scrollToFieldAndShowError(field, message) {
            if (field) {
                field.scrollIntoView({ behavior: 'smooth', block: 'center' });
                field.focus();
                showInlineError(field, message);
            }
        }
        
        function scrollToTermsAndShowError() {
            const termsCheckbox = document.getElementById('acceptTerms');
            if (termsCheckbox) {
                termsCheckbox.scrollIntoView({ behavior: 'smooth', block: 'center' });
                showInlineError(termsCheckbox, 'Please accept the terms and conditions to continue.');
            }
        }
        
        function showInlineError(element, message) {
            // Remove any existing error message
            const existingError = element.parentNode.querySelector('.inline-error');
            if (existingError) {
                existingError.remove();
            }
            
            // Add error class to element
            element.classList.add('error');
            
            // Create inline error message
            const errorDiv = document.createElement('div');
            errorDiv.className = 'inline-error';
            errorDiv.textContent = message;
            errorDiv.style.cssText = 'color: #ef4444; font-size: 0.875rem; margin-top: 0.5rem; display: block;';
            
            // Insert error message after the element
            element.parentNode.insertBefore(errorDiv, element.nextSibling);
            
            // Remove error when user interacts with the field
            const removeError = () => {
                element.classList.remove('error');
                if (errorDiv.parentNode) {
                    errorDiv.remove();
                }
            };
            
            if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                element.addEventListener('input', removeError, { once: true });
            } else {
                element.addEventListener('click', removeError, { once: true });
            }
        }
        
        function showBookingSummary() {
            // Create booking summary modal
            const summary = createBookingSummary();
            showModal(summary);
        }
        
        function createBookingSummary() {
            const totalPrice = selectedServices.reduce((sum, service) => sum + service.price, 0);
            
            return `
                <div class="booking-summary">
                    <h3 class="text-xl font-bold mb-4">Booking Summary</h3>
                    
                    <div class="summary-section mb-4">
                        <h4 class="font-semibold mb-2">Services</h4>
                        ${selectedServices.map(service => `
                            <div class="flex justify-between mb-1">
                                <span>${service.name}</span>
                                <span>£${service.price}</span>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="summary-section mb-4">
                        <h4 class="font-semibold mb-2">Appointment</h4>
                        <div class="flex justify-between mb-1">
                            <span>Date</span>
                            <span>${selectedDate.toLocaleDateString()}</span>
                        </div>
                        <div class="flex justify-between mb-1">
                            <span>Time</span>
                            <span>${selectedTime}</span>
                        </div>
                    </div>
                    
                    <div class="summary-section mb-4">
                        <h4 class="font-semibold mb-2">Your Details</h4>
                        <div class="flex justify-between mb-1">
                            <span>Name</span>
                            <span>${document.getElementById('fullName').value}</span>
                        </div>
                        <div class="flex justify-between mb-1">
                            <span>Email</span>
                            <span>${document.getElementById('email').value}</span>
                        </div>
                        <div class="flex justify-between mb-1">
                            <span>Phone</span>
                            <span>${document.getElementById('phone').value}</span>
                        </div>
                        <div class="flex justify-between mb-1">
                            <span>Postcode</span>
                            <span>${document.getElementById('postcode').value.toUpperCase()}</span>
                        </div>
                    </div>
                    
                    <div class="summary-section mb-4">
                        <h4 class="font-semibold mb-2">Total</h4>
                        <div class="flex justify-between text-lg font-bold">
                            <span>£${totalPrice}</span>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3 mt-6">
                        <button onclick="confirmBooking()" class="flex-1 bg-gradient-to-r from-neon-pink to-neon-purple text-white py-3 px-6 rounded-lg font-semibold">
                            Confirm Booking
                            </button>
                        <button onclick="closeModal()" class="flex-1 bg-gray-600 text-white py-3 px-6 rounded-lg font-semibold">
                            Cancel
                            </button>
                    </div>
                </div>
            `;
        }
        
        function showModal(content) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-lg p-6 max-w-md w-full mx-4">
                    ${content}
                </div>
            `;
            document.body.appendChild(modal);
            
            // Close modal when clicking outside
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeModal();
                }
            });
        }
        
        function closeModal() {
            const modal = document.querySelector('.fixed.inset-0');
            if (modal) {
                modal.remove();
            }
        }
        
        function confirmBooking() {
            // Complete the booking process
            completeBooking();
            closeModal();
        }
        
        function updateProgressIndicator() {
            const step1 = document.getElementById('step1');
            const step2 = document.getElementById('step2');
            const step3 = document.getElementById('step3');
            const step4 = document.getElementById('step4');
            
            // Reset all steps
            [step1, step2, step3, step4].forEach(step => {
                step.classList.remove('current', 'completed');
                const circle = step.querySelector('.step-circle');
                circle.classList.remove('current', 'completed', 'pending');
                circle.classList.add('pending');
            });
            
            // Step 1: Service selection
            if (selectedServices.length > 0) {
                step1.classList.add('completed');
                step1.querySelector('.step-circle').classList.remove('pending');
                step1.querySelector('.step-circle').classList.add('completed');
            } else {
                step1.classList.add('current');
                step1.querySelector('.step-circle').classList.remove('pending');
                step1.querySelector('.step-circle').classList.add('current');
                return;
            }
            
            // Step 2: Date and time
            if (selectedDate && selectedTime) {
                step2.classList.add('completed');
                step2.querySelector('.step-circle').classList.remove('pending');
                step2.querySelector('.step-circle').classList.add('completed');
            } else {
                step2.classList.add('current');
                step2.querySelector('.step-circle').classList.remove('pending');
                step2.querySelector('.step-circle').classList.add('current');
                return;
            }
            
            // Step 3: Customer details
            const fullName = document.getElementById('fullName');
            const email = document.getElementById('email');
            const phone = document.getElementById('phone');
            const postcode = document.getElementById('postcode');
            const terms = document.getElementById('acceptTerms');
            
            if (fullName?.value.trim() && email?.value.trim() && phone?.value.trim() && postcode?.value.trim() && terms?.checked) {
                step3.classList.add('completed');
                step3.querySelector('.step-circle').classList.remove('pending');
                step3.querySelector('.step-circle').classList.add('completed');
                
                step4.classList.add('current');
                step4.querySelector('.step-circle').classList.remove('pending');
                step4.querySelector('.step-circle').classList.add('current');
            } else {
                step3.classList.add('current');
                step3.querySelector('.step-circle').classList.remove('pending');
                step3.querySelector('.step-circle').classList.add('current');
            }
        }
        
        // Add event listeners to update progress indicator
        function initializeProgressTracking() {
            // Update progress when services are selected/deselected
            document.addEventListener('click', function(e) {
                if (e.target.closest('.service-card')) {
                    setTimeout(updateProgressIndicator, 100);
                }
            });
            
            // Update progress when form fields change
            const formInputs = document.querySelectorAll('#fullName, #email, #phone, #postcode, #acceptTerms');
            formInputs.forEach(input => {
                input.addEventListener('input', updateProgressIndicator);
                input.addEventListener('change', updateProgressIndicator);
            });
            
            // Update progress when date/time is selected
            document.addEventListener('click', function(e) {
                if (e.target.closest('.calendar-day') || e.target.closest('.time-slot')) {
                    setTimeout(updateProgressIndicator, 100);
                }
            });
        }

        
        function showBookingPopup(missingItems) {
            // Store missing items for later use
            window.lastMissingItems = missingItems;
            
            // Create popup overlay
            const overlay = document.createElement('div');
            overlay.id = 'booking-popup-overlay';
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.7);
                z-index: 1000;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 1rem;
            `;
            
            // Create popup content
            const popup = document.createElement('div');
            popup.style.cssText = `
                background: #1A1A1A;
                border-radius: 12px;
                padding: 2rem;
                max-width: 400px;
                width: 100%;
                border: 1px solid rgba(255, 255, 255, 0.1);
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
                text-align: center;
            `;
            
            popup.innerHTML = `
                <div style="color: #FF3CAC; font-size: 1.5rem; margin-bottom: 1rem;">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <h3 style="color: #ffffff; font-size: 1.3rem; margin-bottom: 1rem;">
                    Complete Your Booking Details
                </h3>
                <p style="color: #cccccc; margin-bottom: 1.5rem; line-height: 1.5;">
                    Please complete the following before booking:
                </p>
                <div style="text-align: left; margin-bottom: 2rem;">
                    ${missingItems.map(item => `
                        <div style="color: #FF3CAC; margin-bottom: 0.5rem; display: flex; align-items: center;">
                            <i class="fas fa-times" style="margin-right: 0.5rem; font-size: 0.8rem;"></i>
                            ${item}
                        </div>
                    `).join('')}
                </div>
                <button onclick="closeBookingPopup()" style="
                    background: linear-gradient(135deg, #FF3CAC, #784BA0);
                    color: white;
                    border: none;
                    padding: 1rem 2rem;
                    border-radius: 6px;
                    font-weight: 600;
                    cursor: pointer;
                    font-size: 1rem;
                    width: 100%;
                ">
                    <i class="fas fa-check"></i> Got It
                            </button>
            `;
            
            overlay.appendChild(popup);
            document.body.appendChild(overlay);
            
            // Close popup when clicking overlay
            overlay.addEventListener('click', function(e) {
                if (e.target === overlay) {
                    closeBookingPopup();
                }
            });
        }
        
        function closeBookingPopup() {
            const overlay = document.getElementById('booking-popup-overlay');
            if (overlay) {
                overlay.remove();
            }
            
            // Scroll to the first missing field in logical order
            setTimeout(() => {
                scrollToFirstMissingField();
            }, 300);
        }
        
        function scrollToFirstMissingField() {
            if (!window.lastMissingItems || window.lastMissingItems.length === 0) {
                return;
            }
            
            const missingItems = window.lastMissingItems;
            
            // Check for missing items in logical order
            for (let item of missingItems) {
                if (item === 'Select a Service') {
                    // Scroll to services section - try multiple selectors
                    let servicesSection = document.querySelector('.services-section') || 
                                        document.querySelector('#services-section') ||
                                        document.querySelector('[class*="service"]');
                    
                    // If not found by class, look for heading containing "Services"
                    if (!servicesSection) {
                        const headings = document.querySelectorAll('h2, h3');
                        for (let heading of headings) {
                            if (heading.textContent.toLowerCase().includes('service')) {
                                servicesSection = heading;
                                break;
                            }
                        }
                    }
                    
                    if (servicesSection) {
                        servicesSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        return;
                    }
                } else if (item === 'Accept Terms & Conditions') {
                    // Scroll to terms checkbox
                    const termsCheckbox = document.getElementById('acceptTerms');
                    if (termsCheckbox) {
                        termsCheckbox.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        termsCheckbox.focus();
                        return;
                    }
                } else if (item === 'Select Payment Method') {
                    // Scroll to payment section - try multiple selectors
                    let paymentSection = document.querySelector('.payment-options') ||
                                       document.querySelector('[id*="payment"]') ||
                                       document.querySelector('[class*="payment"]');
                    
                    // If not found, look for heading containing "Payment"
                    if (!paymentSection) {
                        const headings = document.querySelectorAll('h3, h4');
                        for (let heading of headings) {
                            if (heading.textContent.toLowerCase().includes('payment')) {
                                paymentSection = heading;
                                break;
                            }
                        }
                    }
                    
                    if (paymentSection) {
                        paymentSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        return;
                    }
                } else if (item === 'Enter Your Name') {
                    // Scroll to name field
                    const nameField = document.getElementById('fullName');
                    if (nameField) {
                        nameField.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        nameField.focus();
                        return;
                    }
                } else if (item === 'Enter Valid Email') {
                    // Scroll to email field
                    const emailField = document.getElementById('email');
                    if (emailField) {
                        emailField.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        emailField.focus();
                        return;
                    }
                } else if (item === 'Enter Phone Number') {
                    // Scroll to phone field
                    const phoneField = document.getElementById('phone');
                    if (phoneField) {
                        phoneField.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        phoneField.focus();
                        return;
                    }
                }
            }
            
            // No fallback scroll - let user stay where they are
        }
        
        function updateBookingServicesList() {
            const bookingServicesList = document.getElementById('booking-services-list');
            bookingServicesList.innerHTML = '';
            
            selectedServices.forEach(service => {
                const serviceItem = document.createElement('div');
                serviceItem.className = 'selected-service-item';
                serviceItem.innerHTML = `
                    <div class="selected-service-info">
                        <div class="selected-service-name">${service.name}</div>
                        <div class="selected-service-price">£${service.price}</div>
                        </div>
                    <button class="remove-service-btn" onclick="event.stopPropagation(); removeService('${service.name}')">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                bookingServicesList.appendChild(serviceItem);
            });
        }
        
        function initializeCalendar() {
            const today = new Date();
            const currentMonth = today.getMonth();
            const currentYear = today.getFullYear();
            
            document.getElementById('currentMonth').textContent = 
                new Date(currentYear, currentMonth).toLocaleDateString('en-US', { 
                    month: 'long', 
                    year: 'numeric' 
                });
            
            generateCalendarDays(currentYear, currentMonth);
        }
        
        function generateCalendarDays(year, month) {
            const calendarDays = document.getElementById('calendarDays');
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            // Business closed days (example: Sundays and Mondays)
            const businessClosedDays = [0, 1]; // Sunday = 0, Monday = 1
            
            // Clear existing days
            calendarDays.innerHTML = '';
            
            // Add day headers
            const dayHeaders = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            dayHeaders.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.textContent = day;
                dayHeader.style.fontWeight = '600';
                dayHeader.style.color = '#cccccc';
                dayHeader.style.textAlign = 'center';
                dayHeader.style.padding = '0.5rem';
                calendarDays.appendChild(dayHeader);
            });
            
            // Add empty cells for days before month starts
            for (let i = 0; i < firstDay; i++) {
                const emptyDay = document.createElement('div');
                calendarDays.appendChild(emptyDay);
            }
            
            // Add days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                const currentDate = new Date(year, month, day);
                const dayOfWeek = currentDate.getDay();
                
                // Check if business is closed on this day
                const isClosed = businessClosedDays.includes(dayOfWeek);
                
                if (isClosed) {
                    dayElement.className = 'calendar-day closed';
                    dayElement.innerHTML = `
                        <div class="day-number">${day}</div>
                        <div class="closed-text">Closed</div>
                    `;
                    dayElement.style.cursor = 'not-allowed';
                    dayElement.style.opacity = '0.4';
                } else {
                    dayElement.className = 'calendar-day available';
                    dayElement.textContent = day;
                    dayElement.onclick = () => selectDate(day, month, year);
                }
                
                calendarDays.appendChild(dayElement);
            }
        }
        
        function changeMonth(direction) {
            // Implementation for month navigation
            console.log('Change month:', direction);
        }
        
        function selectDate(day, month, year) {
            // Check if clicking on already selected date (deselect)
            if (selectedDate && 
                selectedDate.getDate() === day && 
                selectedDate.getMonth() === month && 
                selectedDate.getFullYear() === year &&
                event.target.classList.contains('selected')) {
                
                // Deselect the date
                selectedDate = null;
                selectedTime = null; // Also clear time when date is deselected
                event.target.classList.remove('selected');
                
                // Clear time slots
                const timeSlots = document.getElementById('timeSlots');
                if (timeSlots) {
                    timeSlots.innerHTML = '<p class="text-center text-gray-500">Select a date to see available times</p>';
                }
                
                // Update UI
                updateBookingSummary();
                updateProgressIndicator();
                return;
            }
            
            // Select new date
            selectedDate = new Date(year, month, day);
            document.querySelectorAll('.calendar-day').forEach(el => el.classList.remove('selected'));
            event.target.classList.add('selected');
            
            // Generate time slots for selected date
            generateTimeSlots();
            updateBookingSummary();
            updateProgressIndicator();
        }
        
        function generateTimeSlots() {
            const timeSlots = document.getElementById('timeSlots');
            const slots = [
                { time: '9:00 AM', available: true },
                { time: '10:30 AM', available: true },
                { time: '12:00 PM', available: true },
                { time: '1:30 PM', available: false },
                { time: '3:00 PM', available: true },
                { time: '4:30 PM', available: true },
                { time: '6:00 PM', available: false }
            ];
            
            timeSlots.innerHTML = '';
            
            slots.forEach(slot => {
                const slotElement = document.createElement('div');
                slotElement.className = `time-slot ${slot.available ? 'available' : 'unavailable'}`;
                slotElement.textContent = slot.time;
                
                if (slot.available) {
                    slotElement.onclick = () => selectTime(slot.time);
                }
                
                timeSlots.appendChild(slotElement);
            });
        }
        
        function selectTime(time) {
            // Check if clicking on already selected time (deselect)
            if (selectedTime === time && event.target.classList.contains('selected')) {
                // Deselect the time
                selectedTime = null;
                event.target.classList.remove('selected');
                
                // Update UI
                updateBookingSummary();
                updateProgressIndicator();
                return;
            }
            
            // Select new time
            selectedTime = time;
            document.querySelectorAll('.time-slot').forEach(el => el.classList.remove('selected'));
            event.target.classList.add('selected');
            
            // Clear time error if any
            clearTimeError();
            
            updateBookingSummary();
            updateProgressIndicator();
        }
        
        function selectPayment(type) {
            // Step-by-step validation - guide customer one error at a time
            // Clear any existing errors first
            clearAllErrors();
            
            // Step 1: Check if services are selected
            if (selectedServices.length === 0) {
                showServicesError();
                return;
            }
            
            // Step 2: Check if date is selected
            if (!selectedDate) {
                showDateError();
                return;
            }
            
            // Step 3: Check if time is selected
            if (!selectedTime) {
                showTimeError();
                return;
            }
            
            // Step 4: Check required customer details one by one
            const fullName = document.getElementById('fullName').value.trim();
            if (!fullName) {
                showFieldError('fullName', 'This field is required.');
                return;
            }
            
            const email = document.getElementById('email').value.trim();
            if (!email) {
                showFieldError('email', 'This field is required.');
                return;
            }
            
            const phone = document.getElementById('phone').value.trim();
            if (!phone) {
                showFieldError('phone', 'This field is required.');
                return;
            }
            
            const postcode = document.getElementById('postcode').value.trim();
            if (!postcode) {
                showFieldError('postcode', 'This field is required.');
                return;
            }
            
            // Step 5: Check terms acceptance
            if (!document.getElementById('acceptTerms').checked) {
                showTermsError();
                return;
            }
            
            // All validations passed - proceed with payment selection
            selectedPayment = type;
            
            // Update UI
            document.querySelectorAll('.payment-option').forEach(option => option.classList.remove('selected'));
            event.target.closest('.payment-option').classList.add('selected');
            
            // Show/hide payment disclaimers
            const venueDisclaimer = document.getElementById('venuePaymentDisclaimer');
            const payNowDisclaimer = document.getElementById('payNowPaymentDisclaimer');
            
            if (type === 'payAtVenue') {
                venueDisclaimer.style.display = 'flex';
                payNowDisclaimer.style.display = 'none';
            } else if (type === 'payNow') {
                venueDisclaimer.style.display = 'none';
                payNowDisclaimer.style.display = 'flex';
            } else {
                venueDisclaimer.style.display = 'none';
                payNowDisclaimer.style.display = 'none';
            }
            
            // Update complete booking button
            updateBookingSummary();
            
            // Update payment model display
            updatePaymentModelDisplay();
            
            // Complete the booking after successful validation
            completeBooking();
        }
        
        
        
        
        function updateBookingSummary() {
            // Update services list
            const summaryServicesList = document.getElementById('summaryServicesList');
            summaryServicesList.innerHTML = '';
            
            if (selectedServices.length > 0) {
                selectedServices.forEach(service => {
                    const serviceItem = document.createElement('div');
                    serviceItem.className = 'summary-service-item';
                    serviceItem.innerHTML = `
                        <div class="summary-service-name">${service.name}</div>
                        <div class="summary-service-price">£${service.price}</div>
                        <button class="summary-remove-btn" onclick="event.stopPropagation(); removeService('${service.name}')">
                            <i class="fas fa-times"></i>
                        </button>
                    `;
                    summaryServicesList.appendChild(serviceItem);
                });
                
                const totalDuration = selectedServices.reduce((sum, s) => sum + s.duration, 0);
                document.getElementById('summaryDuration').textContent = `${totalDuration} min`;
                
                const totalPrice = selectedServices.reduce((sum, s) => sum + s.price, 0);
                document.getElementById('summaryTotal').textContent = `£${totalPrice}`;
                
                // Update complete booking button
            } else {
                // Clear price and duration when no services
                document.getElementById('summaryDuration').textContent = '0 min';
                document.getElementById('summaryTotal').textContent = '£0';
                console.log('Price and duration cleared - no services selected');
            }
            
            // Update date
            if (selectedDate) {
                document.getElementById('summaryDate').textContent = selectedDate.toLocaleDateString();
            }
            
            // Update time
            if (selectedTime) {
                document.getElementById('summaryTime').textContent = selectedTime;
            }
            
            // Enable button if all required fields are filled
            const fullName = document.getElementById('fullName').value.trim();
            const email = document.getElementById('email').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            
            const isComplete = selectedServices.length > 0 && selectedDate && selectedTime && 
                             selectedPayment && 
                             document.getElementById('acceptTerms').checked &&
                             fullName && email && phone && emailRegex.test(email);
            
            // Payment buttons are now in the sidebar
        }
        
        function completeBooking() {
            console.log('=== BOOKING FLOW DEBUG START ===');
            console.log('Booking button pressed - starting validation');
            console.log('Device Info:', {
                userAgent: navigator.userAgent,
                isMobile: /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),
                screenSize: window.innerWidth + 'x' + window.innerHeight,
                touchSupport: 'ontouchstart' in window
            });
            
            // Check if terms are accepted
            const termsAccepted = document.getElementById('acceptTerms').checked;
            console.log('Terms accepted:', termsAccepted);
            if (!termsAccepted) {
                console.log('Terms not accepted');
                alert('Please accept the Terms & Conditions to continue.');
                return;
            }
            
            // Enhanced validation for required form fields
            const fullName = document.getElementById('fullName').value.trim();
            const email = document.getElementById('email').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const postcode = document.getElementById('postcode').value.trim();
            
            console.log('Form validation - Full Name:', fullName);
            console.log('Form validation - Email:', email);
            console.log('Form validation - Phone:', phone);
            console.log('Form validation - Postcode:', postcode);
            console.log('Form validation - Selected Services:', selectedServices);
            console.log('Form validation - Selected Date:', selectedDate);
            console.log('Form validation - Selected Time:', selectedTime);
            console.log('Form validation - Selected Payment:', selectedPayment);
            
            // Clear any existing errors first
            clearAllFieldErrors();
            
            // For logged-in users, only phone is required (name and email are auto-populated)
            // For guest users, all fields are required
            const isLoggedIn = localStorage.getItem('userLoggedIn') === 'true';
            let validationErrors = [];
            
            if (isLoggedIn) {
                // Only validate phone for logged-in users
                if (!phone) {
                    validationErrors.push({ field: 'phone', message: 'Please enter your phone number.' });
                }
            } else {
                // Validate all fields for guest users
                if (!fullName) {
                    validationErrors.push({ field: 'fullName', message: 'Please enter your full name.' });
                }
                
                if (!email) {
                    validationErrors.push({ field: 'email', message: 'Please enter your email address.' });
                } else {
                    // Enhanced email validation
                    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    if (!emailRegex.test(email)) {
                        validationErrors.push({ field: 'email', message: 'Please enter a valid email address.' });
                    }
                }
                
                if (!phone) {
                    validationErrors.push({ field: 'phone', message: 'Please enter your phone number.' });
                } else {
                    // Enhanced phone validation for UK numbers
                    const phoneRegex = /^(\+44|0)[1-9]\d{8,9}$/;
                    if (!phoneRegex.test(phone.replace(/\s/g, ''))) {
                        validationErrors.push({ field: 'phone', message: 'Please enter a valid UK phone number.' });
                    }
                }
                
                if (!postcode) {
                    validationErrors.push({ field: 'postcode', message: 'Please enter your postcode.' });
                } else {
                    // Enhanced UK postcode validation
                    const postcodeRegex = /^[A-Z]{1,2}\d[A-Z\d]?\s?\d[A-Z]{2}$/i;
                    if (!postcodeRegex.test(postcode)) {
                        validationErrors.push({ field: 'postcode', message: 'Please enter a valid UK postcode.' });
                    }
                }
            }
            
            // Show validation errors if any
            if (validationErrors.length > 0) {
                console.log('Validation failed with errors:', validationErrors);
                validationErrors.forEach(error => {
                    showInlineError(error.field, error.message);
                });
                return;
            }
            
            // Check if all required fields are filled
            const isComplete = selectedServices.length > 0 && selectedDate && selectedTime && selectedPayment;
            
            if (!isComplete) {
                alert('Please select a service, date, time, and payment method.');
                return;
            }
            
            console.log('Payment method selected:', selectedPayment);
            
            if (selectedPayment === 'payNow') {
                console.log('=== PAY NOW FLOW ===');
                console.log('Redirecting to payment processing...');
                
                // Show loading state
                console.log('Processing payment...');
                
                try {
                    // Use direct navigation instead of window.open to avoid mobile popup blockers
                    console.log('Attempting redirect to payment-processing.html');
                    
                    // Save customer details for future autofill
                    saveCustomerDetails();
                    
                    // Small delay to show loading state
                    setTimeout(() => {
                        window.location.href = 'payment-processing.html';
                    }, 500);
                    
                } catch (error) {
                    console.error('Payment redirect failed:', error);
                    showErrorMessage('Unable to redirect to payment. Please try again.');
                    
                    // Reset button
                    completeButton.textContent = originalText;
                    completeButton.disabled = false;
                }
            } else if (selectedPayment === 'payAtVenue') {
                console.log('=== PAY AT VENUE FLOW ===');
                console.log('Processing Pay at Venue booking...');
                
                // Show loading state
                console.log('Processing payment...');
                
                try {
                    // Generate booking ID and secure token for guest cancellation
                    const bookingId = generateBookingId();
                    const isGuest = !localStorage.getItem('userLoggedIn') === 'true';
                    
                    console.log('Generated booking ID:', bookingId);
                    console.log('Selected services:', selectedServices);
                    console.log('Selected date:', selectedDate);
                    console.log('Selected time:', selectedTime);
                    
                    // Save booking to both customer and business dashboards
                    saveBookingToDashboards(bookingId, {
                        customerName: fullName,
                        customerEmail: email,
                        customerPhone: phone,
                        customerPostcode: postcode,
                        businessName: 'Royal Hair Studio',
                        businessId: 'royal-hair-studio',
                        services: selectedServices,
                        date: selectedDate,
                        time: selectedTime,
                        paymentMethod: selectedPayment,
                        totalAmount: selectedServices.reduce((sum, s) => sum + s.price, 0),
                        status: 'Confirmed',
                        isGuest: isGuest
                    });
                    
                    // Redirect to confirmation page with booking details
                    const params = new URLSearchParams({
                        payment: 'Pay at Venue',
                        bookingId: bookingId,
                        guest: isGuest.toString(),
                        business: 'Royal Hair Studio',
                        date: selectedDate || 'Saturday, Dec 28, 2024',
                        time: selectedTime || '2:00 PM',
                        services: selectedServices.map(s => s.name).join(', '),
                        total: selectedServices.reduce((sum, s) => sum + s.price, 0).toString()
                    });
                    
                    const confirmationUrl = `booking-confirmation.html?${params.toString()}`;
                    console.log('Redirecting to:', confirmationUrl);
                    
                    // Save customer details for future autofill
                    saveCustomerDetails();
                    
                    // Track enquiry/booking submission
                    trackEnquiry('booking');
                    
                    // Small delay to show loading state
                    setTimeout(() => {
                        window.location.href = confirmationUrl;
                    }, 500);
                    
                } catch (error) {
                    console.error('Confirmation redirect failed:', error);
                    showErrorMessage('Unable to process booking. Please try again.');
                    
                    // Reset button
                    completeButton.textContent = originalText;
                    completeButton.disabled = false;
                }
            } else {
                console.log('No payment method selected');
                alert('Please select a payment method first.');
            }
        }
        
        function saveCustomerDetails() {
            // Save customer details to localStorage for future autofill
            const fullName = document.getElementById('fullName').value;
            const email = document.getElementById('email').value;
            const phone = document.getElementById('phone').value;
            const postcode = document.getElementById('postcode').value;
            
            if (fullName) localStorage.setItem('userName', fullName);
            if (email) localStorage.setItem('userEmail', email);
            if (phone) localStorage.setItem('userPhone', phone);
            if (postcode) localStorage.setItem('userPostcode', postcode);
            
            // Mark user as logged in (for demo purposes)
            localStorage.setItem('userLoggedIn', 'true');
        }
        
        function processPayment() {
            // Simulate payment processing
            const paymentMethods = ['Card', 'PayPal', 'Apple Pay', 'Google Pay'];
            const randomMethod = paymentMethods[Math.floor(Math.random() * paymentMethods.length)];
            
            // Simulate payment success/failure (90% success rate for demo)
            const paymentSuccess = Math.random() > 0.1;
            
            if (paymentSuccess) {
                showPaymentSuccessConfirmation(randomMethod);
            } else {
                showPaymentError();
            }
        }
        
        function showPaymentError() {
            // Create error message above payment form
            const paymentSection = document.querySelector('.booking-payment');
            let errorDiv = document.getElementById('payment-error');
            
            if (!errorDiv) {
                errorDiv = document.createElement('div');
                errorDiv.id = 'payment-error';
                errorDiv.style.cssText = `
                    background: #ff4444;
                    color: white;
                    padding: 1rem;
                    border-radius: 8px;
                    margin-bottom: 1rem;
                    text-align: center;
                    font-weight: 600;
                `;
                paymentSection.insertBefore(errorDiv, paymentSection.firstChild);
            }
            
            errorDiv.innerHTML = `
                <i class="fas fa-exclamation-triangle"></i>
                Payment could not be processed. Please try another method.
            `;
            
            // Remove error after 5 seconds
            setTimeout(() => {
                if (errorDiv) {
                    errorDiv.remove();
                }
            }, 5000);
        }
        
        function showPayAtVenueConfirmation() {
            const totalPrice = selectedServices.reduce((sum, s) => sum + s.price, 0);
            const totalDuration = selectedServices.reduce((sum, s) => sum + s.duration, 0);
            const serviceNames = selectedServices.map(s => s.name).join(', ');
            
            // Hide booking form and show confirmation
            document.querySelector('.booking-form').style.display = 'none';
            document.querySelector('.booking-sidebar').style.display = 'none';
            
            // Create confirmation content
            const confirmationHTML = `
                <div class="confirmation-page">
                    <div class="confirmation-header">
                        <div class="success-icon">
                            <i class="fas fa-check-circle"></i>
                    </div>
                        <h1>Booking Confirmed!</h1>
                        <p class="confirmation-subtitle">Please pay at the venue</p>
                </div>
                    
                    <div class="confirmation-details">
                        <div class="detail-section">
                            <h3>Booking Details</h3>
                            <div class="detail-item">
                                <span class="detail-label">Services:</span>
                                <span class="detail-value">${serviceNames}</span>
            </div>
                            <div class="detail-item">
                                <span class="detail-label">Duration:</span>
                                <span class="detail-value">${totalDuration} minutes</span>
        </div>
                            <div class="detail-item">
                                <span class="detail-label">Total:</span>
                                <span class="detail-value">£${totalPrice}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Date:</span>
                                <span class="detail-value">${selectedDate.toLocaleDateString()}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Time:</span>
                                <span class="detail-value">${selectedTime}</span>
                            </div>
                        </div>
                        
                        <div class="detail-section">
                            <h3>Business Details</h3>
                            <div class="business-info">
                                <div class="business-name">Royal Hair Studio</div>
                                <div class="business-address">123 Beauty Street, London SW1A 1AA</div>
                                <div class="business-phone">+44 20 7123 4567</div>
                            </div>
                        </div>
                        
                        <div class="payment-notice">
                            <div class="notice-icon">
                                <i class="fas fa-info-circle"></i>
                            </div>
                            <div class="notice-text">
                                <strong>Payment Instructions:</strong><br>
                                Please pay at the venue. Payment will be taken directly by Royal Hair Studio.
                            </div>
                        </div>
                    </div>
                    
                    <div class="confirmation-actions">
                        <button class="btn btn-primary" onclick="addToCalendar()">
                            <i class="fas fa-calendar-plus"></i> Add to Calendar
                        </button>
                        <button class="btn btn-secondary" onclick="goToHome()">
                            <i class="fas fa-home"></i> Back to Home
                        </button>
                    </div>
                </div>
            `;
            
            document.querySelector('.booking-form').innerHTML = confirmationHTML;
            document.querySelector('.booking-form').style.display = 'block';
            
            // Simulate sending confirmation email
            console.log('Sending confirmation email for Pay at Venue booking...');
        }
        
        function showPaymentSuccessConfirmation(paymentMethod) {
            const totalPrice = selectedServices.reduce((sum, s) => sum + s.price, 0);
            const totalDuration = selectedServices.reduce((sum, s) => sum + s.duration, 0);
            const serviceNames = selectedServices.map(s => s.name).join(', ');
            const transactionId = 'TXN-' + Math.random().toString(36).substr(2, 9).toUpperCase();
            
            // Hide booking form and show confirmation
            document.querySelector('.booking-form').style.display = 'none';
            document.querySelector('.booking-sidebar').style.display = 'none';
            
            // Create confirmation content
            const confirmationHTML = `
                <div class="confirmation-page">
                    <div class="confirmation-header">
                        <div class="success-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <h1>Payment Successful!</h1>
                        <p class="confirmation-subtitle">Receipt sent to your email</p>
                    </div>
                    
                    <div class="confirmation-details">
                        <div class="detail-section">
                            <h3>Booking Details</h3>
                            <div class="detail-item">
                                <span class="detail-label">Services:</span>
                                <span class="detail-value">${serviceNames}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Duration:</span>
                                <span class="detail-value">${totalDuration} minutes</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Total Paid:</span>
                                <span class="detail-value">£${totalPrice}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Date:</span>
                                <span class="detail-value">${selectedDate.toLocaleDateString()}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Time:</span>
                                <span class="detail-value">${selectedTime}</span>
                            </div>
                        </div>
                        
                        <div class="detail-section">
                            <h3>Payment Details</h3>
                            <div class="payment-info">
                                <div class="payment-method">Payment Method: ${paymentMethod}</div>
                                <div class="transaction-id">Transaction ID: ${transactionId}</div>
                                <div class="payment-status">Status: Confirmed (Paid Online)</div>
                            </div>
                        </div>
                        
                        <div class="detail-section">
                            <h3>Business Details</h3>
                            <div class="business-info">
                                <div class="business-name">Royal Hair Studio</div>
                                <div class="business-address">123 Beauty Street, London SW1A 1AA</div>
                                <div class="business-phone">+44 20 7123 4567</div>
                            </div>
                        </div>
                        
                        <div class="success-notice">
                            <div class="notice-icon">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="notice-text">
                                <strong>Payment successful!</strong><br>
                                Your booking is confirmed and payment has been processed.
                            </div>
                        </div>
                    </div>
                    
                    <div class="confirmation-actions">
                        <button class="btn btn-primary" onclick="addToCalendar()">
                            <i class="fas fa-calendar-plus"></i> Add to Calendar
                        </button>
                        <button class="btn btn-secondary" onclick="goToHome()">
                            <i class="fas fa-home"></i> Back to Home
                        </button>
                    </div>
                </div>
            `;
            
            document.querySelector('.booking-form').innerHTML = confirmationHTML;
            document.querySelector('.booking-form').style.display = 'block';
            
            // Simulate sending confirmation email with receipt
            console.log('Sending confirmation email with payment receipt...');
        }
        
        function addToCalendar() {
            // Generate calendar event data
            const eventData = {
                title: 'Hair Appointment at Royal Hair Studio',
                start: '20241215T103000',
                end: '20241215T110000',
                location: '123 Beauty Street, London SW1A 1AA',
                description: 'Hair appointment at Royal Hair Studio'
            };
            
            // Create Google Calendar URL
            const googleUrl = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(eventData.title)}&dates=${eventData.start}/${eventData.end}&location=${encodeURIComponent(eventData.location)}&details=${encodeURIComponent(eventData.description)}`;
            
            // Open in new tab
            window.open(googleUrl, '_blank');
        }
        
        function goToHome() {
            window.location.href = 'index.html';
        }
        
        function callBusiness() {
            alert('Calling Royal Hair Studio...\n\nPhone: +44 20 7123 4567\n\nThis would normally initiate a phone call on mobile devices.');
        }
        
        function generateBookingId() {
            const timestamp = Date.now().toString(36);
            const random = Math.random().toString(36).substr(2, 5);
            return `BP${timestamp}${random}`.toUpperCase();
        }
        
        function showErrorMessage(message) {
            // Create error message element
            const errorDiv = document.createElement('div');
            errorDiv.id = 'booking-error';
            errorDiv.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: #DC2626;
                color: white;
                padding: 1rem 2rem;
                border-radius: 8px;
                z-index: 1000;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
                font-weight: 500;
                max-width: 90%;
                text-align: center;
            `;
            errorDiv.textContent = message;
            
            // Remove existing error if any
            const existingError = document.getElementById('booking-error');
            if (existingError) {
                existingError.remove();
            }
            
            // Add to page
            document.body.appendChild(errorDiv);
            
            // Auto-remove after 5 seconds
            setTimeout(() => {
                if (errorDiv.parentNode) {
                    errorDiv.parentNode.removeChild(errorDiv);
                }
            }, 5000);
        }
        
        function showInlineError(fieldId, message) {
            // Remove existing error for this field
            const existingError = document.getElementById(`${fieldId}-error`);
            if (existingError) {
                existingError.remove();
            }
            
            // Create inline error message
            const errorDiv = document.createElement('div');
            errorDiv.id = `${fieldId}-error`;
            errorDiv.style.cssText = `
                color: #DC2626;
                font-size: 0.8rem;
                margin-top: 0.25rem;
                font-weight: 500;
            `;
            errorDiv.textContent = message;
            
            // Find the field and add error after it
            const field = document.getElementById(fieldId);
            if (field && field.parentNode) {
                field.parentNode.insertBefore(errorDiv, field.nextSibling);
                
                // Add red border to field
                field.style.borderColor = '#DC2626';
                
                // Remove error and border when user starts typing
                field.addEventListener('input', function() {
                    errorDiv.remove();
                    field.style.borderColor = '';
                });
            }
        }
        
        function clearAllFieldErrors() {
            // Remove all existing error messages
            document.querySelectorAll('[id$="-error"]').forEach(error => error.remove());
            
            // Reset all field borders
            const fields = ['fullName', 'email', 'phone', 'postcode'];
            fields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) {
                    field.style.borderColor = '';
                }
            });
        }
        
        // Add form input listeners
        document.addEventListener('DOMContentLoaded', function() {
            const formInputs = ['fullName', 'email', 'phone', 'postcode'];
            formInputs.forEach(inputId => {
                const input = document.getElementById(inputId);
                if (input) {
                    input.addEventListener('input', function() {
                        // Clear error when user starts typing
                        clearFieldError(inputId);
                        updateBookingSummary();
                    });
                    input.addEventListener('blur', updateCompleteBookingButton);
                }
            });
            
            // Clear services error when service is selected
            document.querySelectorAll('.add-service-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    clearServicesError();
                });
            });
            
            // Clear date error when date is selected
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('date-option')) {
                    clearDateError();
                }
            });
            
            // Clear time error when time is selected
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('time-slot')) {
                    clearTimeError();
                }
            });
            
            // Clear terms error when checkbox is checked
            const termsCheckbox = document.getElementById('acceptTerms');
            if (termsCheckbox) {
                termsCheckbox.addEventListener('change', function() {
                    clearTermsError();
                });
            }
            
            // Add event listeners to payment method selection
            const paymentMethods = document.querySelectorAll('input[name="paymentMethod"]');
            paymentMethods.forEach(method => {
                method.addEventListener('change', function() {
                    // Payment method changed - update display
                    updatePaymentModelDisplay();
                });
            });
            
        });
        
        // Load uploaded photos
        function loadUploadedPhotos() {
            const savedPhotos = localStorage.getItem('royalHairStudioPhotos');
            if (savedPhotos) {
                uploadedPhotos = JSON.parse(savedPhotos);
                updateGalleryWithPhotos();
            }
        }
        
        function updateGalleryWithPhotos() {
            const gallerySlides = document.getElementById('gallerySlides');
            const galleryDots = document.querySelector('.gallery-dots');
            
            if (uploadedPhotos.length === 0) {
                // Keep default placeholder slides if no photos uploaded
                // Re-add default slides if they were removed
                if (gallerySlides.children.length === 0 || !gallerySlides.children[0].style.backgroundImage) {
                    gallerySlides.innerHTML = `
                        <div class="gallery-slide"></div>
                        <div class="gallery-slide"></div>
                        <div class="gallery-slide"></div>
                    `;
                    galleryDots.innerHTML = `
                        <button class="gallery-dot active" onclick="currentSlide(1)"></button>
                        <button class="gallery-dot" onclick="currentSlide(2)"></button>
                        <button class="gallery-dot" onclick="currentSlide(3)"></button>
                    `;
                }
                slides = document.querySelectorAll('.gallery-slide');
                dots = document.querySelectorAll('.gallery-dot');
                currentSlideIndex = 0;
                showSlide(0);
                return;
            }
            
            // Clear existing slides and dots
            gallerySlides.innerHTML = '';
            galleryDots.innerHTML = '';
            
            // Create new slides from uploaded photos
            uploadedPhotos.forEach((photo, index) => {
                const slide = document.createElement('div');
                slide.className = 'gallery-slide';
                slide.style.backgroundImage = `url(${photo.url})`;
                slide.style.backgroundSize = 'cover';
                slide.style.backgroundPosition = 'center';
                gallerySlides.appendChild(slide);
                
                // Create corresponding dot
                const dot = document.createElement('button');
                dot.className = `gallery-dot ${index === 0 ? 'active' : ''}`;
                dot.onclick = () => currentSlide(index + 1);
                galleryDots.appendChild(dot);
            });
            
            // Update slides and dots references
            slides = document.querySelectorAll('.gallery-slide');
            dots = document.querySelectorAll('.gallery-dot');
            currentSlideIndex = 0;
            
            // Reset gallery to first slide
            showSlide(0);
        }
        
        // Initialize gallery
        showSlide(0);
        
        // Load uploaded photos when page loads
        document.addEventListener('DOMContentLoaded', function() {
            loadUploadedPhotos();
        });
        
        // Profile View Tracking
        function trackProfileView() {
            const businessId = 'royalHairStudio'; // Business identifier
            const currentDate = new Date().toISOString().split('T')[0]; // YYYY-MM-DD format
            const currentTime = new Date().toISOString(); // Full timestamp
            
            // Get existing analytics data
            let analyticsData = JSON.parse(localStorage.getItem('businessAnalytics') || '{}');
            
            // Initialize business analytics if not exists
            if (!analyticsData[businessId]) {
                analyticsData[businessId] = {
                    totalViews: 0,
                    dailyViews: {},
                    lastView: null,
                    viewHistory: []
                };
            }
            
            // Update view counts
            analyticsData[businessId].totalViews += 1;
            analyticsData[businessId].lastView = currentTime;
            
            // Update daily views
            if (!analyticsData[businessId].dailyViews[currentDate]) {
                analyticsData[businessId].dailyViews[currentDate] = 0;
            }
            analyticsData[businessId].dailyViews[currentDate] += 1;
            
            // Add to view history (keep last 100 views)
            analyticsData[businessId].viewHistory.push({
                timestamp: currentTime,
                date: currentDate,
                userAgent: navigator.userAgent,
                referrer: document.referrer || 'Direct'
            });
            
            // Keep only last 100 views to prevent localStorage from getting too large
            if (analyticsData[businessId].viewHistory.length > 100) {
                analyticsData[businessId].viewHistory = analyticsData[businessId].viewHistory.slice(-100);
            }
            
            // Save updated analytics
            localStorage.setItem('businessAnalytics', JSON.stringify(analyticsData));
            
            // Trigger analytics update event
            window.dispatchEvent(new CustomEvent('analyticsUpdated', {
                detail: { 
                    businessId: businessId,
                    totalViews: analyticsData[businessId].totalViews,
                    dailyViews: analyticsData[businessId].dailyViews[currentDate] || 0
                }
            }));
            
            console.log('Profile view tracked:', {
                businessId: businessId,
                totalViews: analyticsData[businessId].totalViews,
                todayViews: analyticsData[businessId].dailyViews[currentDate]
            });
        }
        
        // Track view when page loads (only for public views, not business dashboard)
        document.addEventListener('DOMContentLoaded', function() {
            // Only track if this is a public view (not from business dashboard)
            const isBusinessDashboard = window.location.search.includes('dashboard=true') || 
                                       document.referrer.includes('business-dashboard');
            
            if (!isBusinessDashboard) {
                // Small delay to ensure page is fully loaded
                setTimeout(trackProfileView, 1000);
            }
        });
        
        // Track contact clicks (call, message, etc.)
        function trackContactClick(action) {
            const businessId = 'royalHairStudio';
            const currentDate = new Date().toISOString().split('T')[0];
            const currentTime = new Date().toISOString();
            
            // Get existing analytics data
            let analyticsData = JSON.parse(localStorage.getItem('businessAnalytics') || '{}');
            
            // Initialize business analytics if not exists
            if (!analyticsData[businessId]) {
                analyticsData[businessId] = {
                    totalViews: 0,
                    dailyViews: {},
                    lastView: null,
                    viewHistory: [],
                    searchImpressions: 0,
                    dailySearchImpressions: {},
                    contactClicks: 0,
                    dailyContactClicks: {},
                    enquiries: 0,
                    dailyEnquiries: {}
                };
            }
            
            // Update contact clicks
            analyticsData[businessId].contactClicks += 1;
            
            // Update daily contact clicks
            if (!analyticsData[businessId].dailyContactClicks[currentDate]) {
                analyticsData[businessId].dailyContactClicks[currentDate] = 0;
            }
            analyticsData[businessId].dailyContactClicks[currentDate] += 1;
            
            // Save updated analytics
            localStorage.setItem('businessAnalytics', JSON.stringify(analyticsData));
            
            // Trigger analytics update event
            window.dispatchEvent(new CustomEvent('analyticsUpdated', {
                detail: { 
                    businessId: businessId,
                    type: 'contactClick',
                    action: action,
                    totalClicks: analyticsData[businessId].contactClicks,
                    todayClicks: analyticsData[businessId].dailyContactClicks[currentDate]
                }
            }));
            
            console.log(`Contact click tracked (${action}):`, {
                businessId: businessId,
                totalClicks: analyticsData[businessId].contactClicks,
                todayClicks: analyticsData[businessId].dailyContactClicks[currentDate]
            });
            
            // Show success message
            showContactClickSuccess(action);
        }
        
        // Show success message for contact clicks
        function showContactClickSuccess(action) {
            const actionText = action === 'call' ? 'Call' : 'Message';
            const message = document.createElement('div');
            message.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: rgba(30, 144, 255, 0.95);
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 8px;
                font-weight: 600;
                z-index: 10000;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
                animation: slideIn 0.3s ease;
            `;
            message.innerHTML = `<i class="fas fa-phone"></i> ${actionText} action tracked!`;
            document.body.appendChild(message);
            
            setTimeout(() => {
                message.remove();
            }, 3000);
        }
        
        // Track enquiries (bookings, messages, etc.)
        function trackEnquiry(type) {
            const businessId = 'royalHairStudio';
            const currentDate = new Date().toISOString().split('T')[0];
            const currentTime = new Date().toISOString();
            
            // Get existing analytics data
            let analyticsData = JSON.parse(localStorage.getItem('businessAnalytics') || '{}');
            
            // Initialize business analytics if not exists
            if (!analyticsData[businessId]) {
                analyticsData[businessId] = {
                    totalViews: 0,
                    dailyViews: {},
                    lastView: null,
                    viewHistory: [],
                    searchImpressions: 0,
                    dailySearchImpressions: {},
                    contactClicks: 0,
                    dailyContactClicks: {},
                    enquiries: 0,
                    dailyEnquiries: {}
                };
            }
            
            // Update enquiries
            analyticsData[businessId].enquiries += 1;
            
            // Update daily enquiries
            if (!analyticsData[businessId].dailyEnquiries[currentDate]) {
                analyticsData[businessId].dailyEnquiries[currentDate] = 0;
            }
            analyticsData[businessId].dailyEnquiries[currentDate] += 1;
            
            // Save updated analytics
            localStorage.setItem('businessAnalytics', JSON.stringify(analyticsData));
            
            // Trigger analytics update event
            window.dispatchEvent(new CustomEvent('analyticsUpdated', {
                detail: { 
                    businessId: businessId,
                    type: 'enquiry',
                    enquiryType: type,
                    totalEnquiries: analyticsData[businessId].enquiries,
                    todayEnquiries: analyticsData[businessId].dailyEnquiries[currentDate]
                }
            }));
            
            console.log(`Enquiry tracked (${type}):`, {
                businessId: businessId,
                totalEnquiries: analyticsData[businessId].enquiries,
                todayEnquiries: analyticsData[businessId].dailyEnquiries[currentDate]
            });
        }
        
        // Listen for storage changes to update gallery when photos are uploaded
        window.addEventListener('storage', function(e) {
            if (e.key === 'royalHairStudioPhotos') {
                loadUploadedPhotos();
            }
        });
        
        // Listen for custom photo update events
        window.addEventListener('photosUpdated', function(e) {
            loadUploadedPhotos();
        });
        
        // Also refresh when page becomes visible (user returns from upload page)
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden) {
                loadUploadedPhotos();
            }
        });
        
        window.addEventListener('focus', function() {
            loadUploadedPhotos();
        });
        
        // Test function to check validation
        function testButtonUpdate() {
            console.log('=== TESTING VALIDATION ===');
            console.log('Selected services:', selectedServices.length);
            console.log('Selected date:', selectedDate);
            console.log('Selected time:', selectedTime);
            console.log('Selected payment:', selectedPayment);
        }
        
        // Test function to check addService
        function testAddService() {
            console.log('=== TESTING ADD SERVICE ===');
            console.log('addService function exists:', typeof addService);
            if (typeof addService === 'function') {
                console.log('Calling addService...');
                addService('Test Service', 25, 30);
            } else {
                console.log('addService function not found!');
            }
        }
        
        // Mobile debugging function
        function debugMobileBooking() {
            console.log('=== MOBILE BOOKING DEBUG ===');
            console.log('User Agent:', navigator.userAgent);
            console.log('Is Mobile:', /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));
            console.log('Screen Size:', window.innerWidth + 'x' + window.innerHeight);
            console.log('Touch Support:', 'ontouchstart' in window);
            console.log('Payment buttons available:', document.querySelectorAll('.payment-option').length);
            console.log('Selected Services:', selectedServices);
            console.log('Selected Date:', selectedDate);
            console.log('Selected Time:', selectedTime);
            console.log('Selected Payment:', selectedPayment);
            console.log('Terms Accepted:', document.getElementById('acceptTerms').checked);
            console.log('=== END DEBUG ===');
        }
        
        // Add debug button for testing (remove in production)
        if (window.location.search.includes('debug=true')) {
            const debugButton = document.createElement('button');
            debugButton.textContent = 'Debug Mobile Booking';
            debugButton.style.cssText = `
                position: fixed;
                top: 10px;
                right: 10px;
                z-index: 1000;
                background: #FF3CAC;
                color: white;
                border: none;
                padding: 0.5rem;
                border-radius: 4px;
                font-size: 0.8rem;
            `;
            debugButton.onclick = debugMobileBooking;
            document.body.appendChild(debugButton);
            
            // Add test data auto-fill button
            const testDataButton = document.createElement('button');
            testDataButton.textContent = 'Fill Test Data';
            testDataButton.style.cssText = `
                position: fixed;
                top: 50px;
                right: 10px;
                z-index: 1000;
                background: #2B86C5;
                color: white;
                border: none;
                padding: 0.5rem;
                border-radius: 4px;
                font-size: 0.8rem;
            `;
            testDataButton.onclick = fillTestData;
            document.body.appendChild(testDataButton);
        }
        
        // Auto-fill test data for testing
        function fillTestData() {
            console.log('Filling test data...');
            
            // Fill form fields
            document.getElementById('fullName').value = 'Test User';
            document.getElementById('email').value = 'test@example.com';
            document.getElementById('phone').value = '07123456789';
            
            // Add booking note if field exists
            const bookingNotesField = document.getElementById('bookingNotes');
            if (bookingNotesField) {
                bookingNotesField.value = 'Test booking, ignore';
            }
            
            // Accept terms
            document.getElementById('acceptTerms').checked = true;
            
            // Trigger validation updates
            updateBookingSummary();
            
            console.log('Test data filled successfully');
            alert('Test data filled! Now select a service, date, time, and payment method.');
        }
        
        // Navigation Functions
        function toggleLoginModal(event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            const modal = document.getElementById('loginModal');
            if (modal) {
                modal.classList.toggle('hidden');
            }
        }
        
        // Cancellation Policy Modal Functions
        function openCancellationPolicyModal() {
            const modal = document.getElementById('cancellationPolicyModal');
            const modalContent = document.getElementById('policyModalContent');
            const modalTitle = document.getElementById('policyModalTitle');
            
            // Get business name (in real implementation, this would come from the business data)
            const businessName = 'Royal Hair Studio';
            
            // Get cancellation policy (in real implementation, this would come from the business data)
            const policyType = 'moderate'; // This would be retrieved from business data
            
            // Policy templates (same as in business registration)
            const cancellationTemplates = {
                flexible: `${businessName} – Cancellation Policy:
You may cancel your booking up to 24 hours before your appointment for a full refund.
Cancellations made within 24 hours and no-shows will be charged 100% of the service price.
Refunds are returned to your original payment method within 5–10 business days.

This policy is set by ${businessName}. BlkPages processes payments via Stripe on behalf of the venue but is not responsible for enforcing refunds.`,
                
                moderate: `${businessName} – Cancellation Policy:
You may cancel your booking up to 48 hours before your appointment for a full refund.
Cancellations made within 48 hours will be charged 50% of the service price.
No-shows will be charged 100% of the service price.
Refunds are returned to your original payment method within 5–10 business days.

This policy is set by ${businessName}. BlkPages processes payments via Stripe on behalf of the venue but is not responsible for enforcing refunds.`,
                
                strict: `${businessName} – Cancellation Policy:
This booking is non-refundable once confirmed.
No-shows will be charged 100% of the service price.
Refunds are returned to your original payment method within 5–10 business days.

This policy is set by ${businessName}. BlkPages processes payments via Stripe on behalf of the venue but is not responsible for enforcing refunds.`,
                
                custom: `${businessName} – Cancellation Policy:
Cancellations: You may cancel your appointment up to [X hours/days] before the scheduled time for a full refund.
Late Cancellations: Cancellations made within [X hours/days] will be charged [X%] of the service price.
No-Shows: If you do not attend your appointment without notice, you will be charged [100%] of the service price.
Refunds: Refunds (where applicable) will be processed back to your original payment method within [X working days].

This policy is set by ${businessName}. BlkPages processes payments via Stripe on behalf of the venue but is not responsible for enforcing refunds.`
            };
            
            // Set modal content
            modalTitle.textContent = `${businessName} – Cancellation Policy`;
            modalContent.textContent = cancellationTemplates[policyType] || cancellationTemplates.moderate;
            
            // Show modal
            modal.classList.remove('hidden');
        }
        
        function closeCancellationPolicyModal() {
            const modal = document.getElementById('cancellationPolicyModal');
            modal.classList.add('hidden');
        }
        
        function toggleCustomerMenu() {
            const dropdown = document.getElementById('customerDropdown');
            const mobileDropdown = document.getElementById('mobileCustomerDropdown');
            
            if (dropdown) {
                dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
            }
            if (mobileDropdown) {
                mobileDropdown.style.display = mobileDropdown.style.display === 'none' ? 'block' : 'none';
            }
        }
        
        function toggleMobileMenu() {
            const menu = document.getElementById('mobileMenu');
            if (menu) {
                menu.classList.toggle('hidden');
            }
        }
        
        function handleLogin(event) {
            event.preventDefault();
            // Simulate login
            const email = event.target.querySelector('input[type="email"]').value;
            const password = event.target.querySelector('input[type="password"]').value;
            
            // Simple validation
            if (email === 'customer@example.com' && password === 'password123') {
                // Show customer menu, hide login
                document.getElementById('authLinks').style.display = 'none';
                document.getElementById('mobileAuthLinks').style.display = 'none';
                document.getElementById('customerMenu').style.display = 'block';
                document.getElementById('mobileCustomerMenu').style.display = 'block';
                
                // Close modal
                toggleLoginModal();
                
                // Show success message
                alert('Login successful!');
            } else {
                alert('Invalid credentials. Use customer@example.com / password123');
            }
        }
        
        function signOut() {
            // Hide customer menu, show login
            document.getElementById('authLinks').style.display = 'flex';
            document.getElementById('mobileAuthLinks').style.display = 'flex';
            document.getElementById('customerMenu').style.display = 'none';
            document.getElementById('mobileCustomerMenu').style.display = 'none';
            
            // Close any open dropdowns
            document.getElementById('customerDropdown').style.display = 'none';
            document.getElementById('mobileCustomerDropdown').style.display = 'none';
            
            alert('Signed out successfully!');
        }
        
        // Close dropdowns when clicking outside
        document.addEventListener('click', function(event) {
            const customerMenu = document.getElementById('customerMenu');
            const mobileCustomerMenu = document.getElementById('mobileCustomerMenu');
            
            if (customerMenu && !customerMenu.contains(event.target)) {
                document.getElementById('customerDropdown').style.display = 'none';
            }
            if (mobileCustomerMenu && !mobileCustomerMenu.contains(event.target)) {
                document.getElementById('mobileCustomerDropdown').style.display = 'none';
            }
        });

        // Redirect to login page with return URL
        function redirectToLogin() {
            // Store current page URL for redirect after login
            localStorage.setItem('returnUrl', window.location.href);
            // Navigate to login page
            window.location.href = 'customer-login.html';
        }

        // Redirect to register page with return URL
        function redirectToRegister() {
            // Store current page URL for redirect after registration
            localStorage.setItem('returnUrl', window.location.href);
            // Navigate to register page
            window.location.href = 'customer-register.html';
        }
        
        // Basket management functions
        const BASKET_KEY = 'blkpages_basket';
        const GUEST_BASKET_KEY = 'blkpages_guest_basket';
        
        function updateBasketCount() {
            const basketCount = document.getElementById('basketCount');
            const mobileBasketCount = document.getElementById('mobileBasketCount');
            const count = selectedServices ? selectedServices.length : 0;
            
            if (basketCount) {
                basketCount.textContent = count;
            }
            if (mobileBasketCount) {
                mobileBasketCount.textContent = count;
            }
        }
        
        function saveBasket() {
            const basketData = {
                selectedServices: selectedServices,
                timestamp: Date.now()
            };
            
            const isLoggedIn = localStorage.getItem('userLoggedIn') === 'true';
            if (isLoggedIn) {
                localStorage.setItem(BASKET_KEY, JSON.stringify(basketData));
            } else {
                sessionStorage.setItem(GUEST_BASKET_KEY, JSON.stringify(basketData));
            }
        }
        
        function loadBasket() {
            const isLoggedIn = localStorage.getItem('userLoggedIn') === 'true';
            let basketData = null;
            
            if (isLoggedIn) {
                const savedBasket = localStorage.getItem(BASKET_KEY);
                if (savedBasket) basketData = JSON.parse(savedBasket);
            } else {
                const guestBasket = sessionStorage.getItem(GUEST_BASKET_KEY);
                if (guestBasket) basketData = JSON.parse(guestBasket);
            }
            
            if (basketData) {
                selectedServices = basketData.selectedServices || [];
                updateBasketCount();
            }
        }
        
        // Load basket on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadBasket();
        });
        
        // Save booking to both customer and business dashboards
        function saveBookingToDashboards(bookingId, bookingData) {
            console.log('Saving booking to dashboards:', bookingId, bookingData);
            
            // Create booking object with shared booking_id
            const booking = {
                bookingId: bookingId,
                customerName: bookingData.customerName,
                customerEmail: bookingData.customerEmail,
                customerPhone: bookingData.customerPhone,
                customerPostcode: bookingData.customerPostcode,
                businessName: bookingData.businessName,
                businessId: bookingData.businessId,
                services: bookingData.services,
                date: bookingData.date,
                time: bookingData.time,
                paymentMethod: bookingData.paymentMethod,
                totalAmount: bookingData.totalAmount,
                status: bookingData.status,
                isGuest: bookingData.isGuest,
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            
            // Save to customer dashboard (MyBookings[])
            const customerId = bookingData.isGuest ? 'guest_' + Date.now() : localStorage.getItem('customerId') || 'customer_1';
            const customerBookings = JSON.parse(localStorage.getItem(`customerBookings_${customerId}`) || '[]');
            customerBookings.push(booking);
            localStorage.setItem(`customerBookings_${customerId}`, JSON.stringify(customerBookings));
            
            // Save to business dashboard (Bookings[])
            const businessBookings = JSON.parse(localStorage.getItem(`businessBookings_${bookingData.businessId}`) || '[]');
            businessBookings.push(booking);
            localStorage.setItem(`businessBookings_${bookingData.businessId}`, JSON.stringify(businessBookings));
            
            console.log('Booking saved to both dashboards successfully');
        }
        
        // Update booking status when customer cancels (real-time sync)
        function updateBookingStatus(bookingId, newStatus) {
            console.log('Updating booking status:', bookingId, newStatus);
            
            // Update in customer dashboard
            const customerId = localStorage.getItem('customerId') || 'customer_1';
            const customerBookings = JSON.parse(localStorage.getItem(`customerBookings_${customerId}`) || '[]');
            const customerBookingIndex = customerBookings.findIndex(b => b.bookingId === bookingId);
            if (customerBookingIndex !== -1) {
                customerBookings[customerBookingIndex].status = newStatus;
                customerBookings[customerBookingIndex].updatedAt = new Date().toISOString();
                localStorage.setItem(`customerBookings_${customerId}`, JSON.stringify(customerBookings));
            }
            
            // Update in business dashboard
            const businessBookings = JSON.parse(localStorage.getItem(`businessBookings_royal-hair-studio`) || '[]');
            const businessBookingIndex = businessBookings.findIndex(b => b.bookingId === bookingId);
            if (businessBookingIndex !== -1) {
                businessBookings[businessBookingIndex].status = newStatus;
                businessBookings[businessBookingIndex].updatedAt = new Date().toISOString();
                localStorage.setItem(`businessBookings_royal-hair-studio`, JSON.stringify(businessBookings));
            }
            
            console.log('Booking status updated in both dashboards:', newStatus);
        }
        
        // Listen for booking cancellations (for real-time updates)
        window.addEventListener('storage', function(e) {
            if (e.key && e.key.startsWith('bookingCancelled_')) {
                const bookingId = e.key.replace('bookingCancelled_', '');
                updateBookingStatus(bookingId, 'Cancelled');
            }
        });
        
        // Function to cancel booking (called from customer dashboard)
        window.cancelBooking = function(bookingId) {
            if (confirm('Are you sure you want to cancel this booking?')) {
                // Update booking status to cancelled
                updateBookingStatus(bookingId, 'Cancelled');
                
                // Trigger storage event for real-time sync
                localStorage.setItem(`bookingCancelled_${bookingId}`, Date.now().toString());
                
                alert('Booking cancelled successfully.');
                
                // Refresh the page or update UI
                if (typeof updateBookingsDisplay === 'function') {
                    updateBookingsDisplay();
                }
            }
        };
    </script>

    <!-- Footer -->
    <footer class="bg-charcoal border-t border-white/10 py-8 mt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
                <div class="flex items-center space-x-6">
                    <a href="blog.html" class="text-text-secondary hover:text-neon-pink transition-colors duration-300">Blog</a>
                    <a href="terms.html" class="text-text-secondary hover:text-neon-pink transition-colors duration-300">Terms & Conditions</a>
                    <a href="privacy.html" class="text-text-secondary hover:text-neon-pink transition-colors duration-300">Privacy Policy</a>
                </div>
                <div class="text-text-secondary text-sm">
                    © 2024 BlkPages. All rights reserved.
                </div>
            </div>
        </div>
    </footer>
</body>
</html>