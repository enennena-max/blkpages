<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Environment Configuration Test - BlkPages</title>
    <script src="https://cdn.tailwindcss.com?v=2"></script>
    <script>
        // Suppress Tailwind CDN warnings in development
        if (typeof window !== 'undefined') {
            window.tailwind = { config: { theme: { extend: {} } } };
        }
    </script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #1a1a1a; color: #fff; }
        .test-section { background: #2a2a2a; padding: 20px; margin: 10px 0; border-radius: 8px; }
        .success { color: #10B981; }
        .error { color: #EF4444; }
        .warning { color: #F59E0B; }
        .info { color: #3B82F6; }
        .log { background: #1a1a1a; padding: 10px; border-radius: 4px; font-family: monospace; font-size: 12px; margin: 5px 0; }
    </style>
</head>
<body>
    <h1>üîß Environment Configuration Test</h1>
    
    <div class="test-section">
        <h2>Environment Variables Test</h2>
        <div id="envTest"></div>
    </div>
    
    <div class="test-section">
        <h2>Console Logs</h2>
        <div id="consoleLogs"></div>
    </div>
    
    <div class="test-section">
        <h2>Test Actions</h2>
        <button onclick="testEnvironment()" class="bg-blue-500 text-white px-4 py-2 rounded">Test Environment</button>
        <button onclick="clearLogs()" class="bg-gray-500 text-white px-4 py-2 rounded ml-2">Clear Logs</button>
    </div>

    <!-- Load development config first -->
    <script src="backend/development-config.js"></script>
    <script src="backend/production-config.js"></script>
    
    <script>
        let originalConsoleLog = console.log;
        let originalConsoleError = console.error;
        let originalConsoleWarn = console.warn;
        let logs = [];

        // Capture console output
        console.log = function(...args) {
            logs.push({ type: 'log', message: args.join(' '), timestamp: new Date().toISOString() });
            originalConsoleLog.apply(console, args);
            updateLogs();
        };

        console.error = function(...args) {
            logs.push({ type: 'error', message: args.join(' '), timestamp: new Date().toISOString() });
            originalConsoleError.apply(console, args);
            updateLogs();
        };

        console.warn = function(...args) {
            logs.push({ type: 'warning', message: args.join(' '), timestamp: new Date().toISOString() });
            originalConsoleWarn.apply(console, args);
            updateLogs();
        };

        function updateLogs() {
            const logsDiv = document.getElementById('consoleLogs');
            logsDiv.innerHTML = logs.slice(-10).map(log => 
                `<div class="log ${log.type}">[${log.timestamp}] ${log.message}</div>`
            ).join('');
        }

        function testEnvironment() {
            console.log('üß™ Testing environment configuration...');
            
            // Test environment variables
            const envTest = document.getElementById('envTest');
            const requiredVars = ['DB_HOST', 'DB_PASSWORD', 'STRIPE_SECRET_KEY', 'SMTP_PASSWORD'];
            const results = [];
            
            requiredVars.forEach(varName => {
                const value = process.env[varName];
                if (value) {
                    results.push(`<div class="success">‚úÖ ${varName}: ${value}</div>`);
                } else {
                    results.push(`<div class="error">‚ùå ${varName}: Missing</div>`);
                }
            });
            
            envTest.innerHTML = results.join('');
            
            // Test development mode detection
            const isDev = window.location.hostname === 'localhost' || 
                         window.location.hostname === '127.0.0.1' ||
                         window.location.hostname.includes('localhost');
            
            console.log(`Development mode detected: ${isDev}`);
            console.log(`Hostname: ${window.location.hostname}`);
            
            // Test configuration objects
            if (typeof developmentConfig !== 'undefined') {
                console.log('Development config loaded:', developmentConfig.getConfig());
            }
            
            if (typeof productionConfig !== 'undefined') {
                console.log('Production config loaded');
            }
        }

        function clearLogs() {
            logs = [];
            updateLogs();
        }

        // Auto-test on load
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üöÄ Environment test page loaded');
            setTimeout(testEnvironment, 1000);
        });
    </script>
</body>
</html>
